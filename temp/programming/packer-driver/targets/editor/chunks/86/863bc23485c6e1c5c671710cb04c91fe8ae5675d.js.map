{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/skill/Skill10.ts"],"names":["Component","_decorator","cocosUtil","audioManager","mapModel","physicsGroup","ccclass","property","Skill10","skill","timeCount","isShoting","robotBullet","init","extraObj","endCb","bulletUtil","isValid","node","bullet","recycleSelf","lv","row","bulletSystem","addBullet","bulletId","PLAYER_BULLET","forceDestroy","startShoting","duration","getDuration","startShot","scheduleOnce","playEffect","audio","updateLogic","dt","getAtkCd"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,U,OAAAA,U;;AACXC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U,GAE9B;;yBAEaO,O,WADZF,OAAO,CAAC,SAAD,C,gBAAR,MACaE,OADb,SAC6BR,SAD7B,CACuC;AAAA;AAAA;AAAA,eAEnCS,KAFmC;AAAA,eAInCC,SAJmC,GAIf,CAJe;AAAA,eAMnCC,SANmC;AAAA,eAQnCC,WARmC;AAAA;;AAUnCC,QAAAA,IAAI,CAACJ,KAAD,EAAe;AACf,eAAKA,KAAL,GAAaA,KAAb;AACA,eAAKE,SAAL,GAAiB,KAAjB;AACA,eAAKC,WAAL,GAAmB,IAAnB;AAEA,cAAIE,QAAQ,GAAG;AACXC,YAAAA,KAAK,EAAGC,UAAD,IAAqB;AACxB,kBAAI,CAAC;AAAA;AAAA,0CAAUC,OAAV,CAAkB,KAAKC,IAAvB,CAAL,EAAmC;AAC/BF,gBAAAA,UAAU,CAACG,MAAX,CAAkBC,WAAlB;AACA;AACH;;AACD,mBAAKR,WAAL,GAAmBI,UAAnB;AACH,aAPU;AAQXK,YAAAA,EAAE,EAAE,KAAKZ,KAAL,CAAWa,GAAX,CAAeD;AARR,WAAf;AAUA;AAAA;AAAA,oCAASE,YAAT,CAAsBC,SAAtB,CAAgC,KAAKf,KAAL,CAAWa,GAAX,CAAeG,QAA/C,EAAyD;AAAA;AAAA,4CAAaC,aAAtE,EAAqF,IAArF,EAA2F,IAA3F,EAAiGZ,QAAjG;AACH;;AAEDa,QAAAA,YAAY,GAAG;AACX,cAAI;AAAA;AAAA,sCAAUV,OAAV,CAAkB,KAAKL,WAAvB,CAAJ,EAAyC;AACrC,iBAAKA,WAAL,CAAiBO,MAAjB,CAAwBC,WAAxB;AACH;AACJ,SAhCkC,CAkCnC;;;AACAQ,QAAAA,YAAY,GAAG;AACX,cAAIC,QAAQ,GAAG,KAAKpB,KAAL,CAAWqB,WAAX,EAAf;AACA,eAAKnB,SAAL,GAAiB,IAAjB;AACA,eAAKC,WAAL,CAAiBmB,SAAjB,CAA2BF,QAA3B;AACA,eAAKG,YAAL,CAAkB,MAAM;AACpB,iBAAKrB,SAAL,GAAiB,KAAjB;AACA,iBAAKD,SAAL,GAAiB,CAAjB;AACH,WAHD,EAGGmB,QAHH;AAIA;AAAA;AAAA,4CAAaI,UAAb,CAAwB,KAAKxB,KAAL,CAAWa,GAAX,CAAeY,KAAvC;AACH;;AAEDC,QAAAA,WAAW,CAACC,EAAD,EAAa;AACpB,cAAI,CAAC,KAAKxB,WAAV,EAAuB;AACnB;AACH;;AAED,eAAKF,SAAL,IAAkB0B,EAAlB;;AAEA,cAAI,KAAK1B,SAAL,GAAiB,KAAKD,KAAL,CAAW4B,QAAX,EAArB,EAA4C;AACxC;AACH;;AAED,cAAI,KAAK1B,SAAT,EAAoB;AAChB;AACH;;AAED,eAAKiB,YAAL;AAEH;;AA/DkC,O","sourcesContent":["import { Component, _decorator } from 'cc';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nimport { audioManager } from '../../../manager/audioManager';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { physicsGroup } from '../../../other/physicsGroup';\r\nimport { Skill } from './Skill';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 轰炸机\r\n@ccclass('Skill10')\r\nexport class Skill10 extends Component {\r\n\r\n    skill: Skill;\r\n\r\n    timeCount: number = 0;\r\n    // 是否轰炸中\r\n    isShoting: boolean;\r\n\r\n    robotBullet: any;\r\n\r\n    init(skill: Skill) {\r\n        this.skill = skill;\r\n        this.isShoting = false;\r\n        this.robotBullet = null;\r\n\r\n        let extraObj = {\r\n            endCb: (bulletUtil: any) => {\r\n                if (!cocosUtil.isValid(this.node)) {\r\n                    bulletUtil.bullet.recycleSelf();\r\n                    return;\r\n                }\r\n                this.robotBullet = bulletUtil;\r\n            },\r\n            lv: this.skill.row.lv\r\n        };\r\n        mapModel.bulletSystem.addBullet(this.skill.row.bulletId, physicsGroup.PLAYER_BULLET, null, null, extraObj);\r\n    }\r\n\r\n    forceDestroy() {\r\n        if (cocosUtil.isValid(this.robotBullet)) {\r\n            this.robotBullet.bullet.recycleSelf();\r\n        }\r\n    }\r\n\r\n    // 开始轰炸\r\n    startShoting() {\r\n        let duration = this.skill.getDuration();\r\n        this.isShoting = true;\r\n        this.robotBullet.startShot(duration);\r\n        this.scheduleOnce(() => {\r\n            this.isShoting = false;\r\n            this.timeCount = 0;\r\n        }, duration);\r\n        audioManager.playEffect(this.skill.row.audio);\r\n    }\r\n\r\n    updateLogic(dt: number) {\r\n        if (!this.robotBullet) {\r\n            return;\r\n        }\r\n\r\n        this.timeCount += dt;\r\n\r\n        if (this.timeCount < this.skill.getAtkCd()) {\r\n            return;\r\n        }\r\n\r\n        if (this.isShoting) {\r\n            return;\r\n        }\r\n\r\n        this.startShoting();\r\n\r\n    }\r\n\r\n}\r\n\r\n"]}