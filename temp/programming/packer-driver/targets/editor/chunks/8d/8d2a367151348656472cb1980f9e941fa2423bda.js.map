{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/base/ScrollViewUtil.ts"],"names":["Component","find","game","instantiate","isValid","Layout","ScrollView","sys","tween","UITransform","v3","_decorator","myLog","RenderChildBatch","ccclass","property","ScrollViewUtil","scrollView","vertical","gapX","gapY","paddingLeft","paddingRight","paddingTop","paddingBottom","contentNode","contentTransform","viewNode","viewWidth","viewHeight","viewTransform","itemUI","itemUITransform","itemUIWidth","itemUIHeight","itemUIFreeArr","startPosX","startPosY","viewNum","changeNum","maxLines","frameUpdateArr","frameTime","Math","floor","getFrameRate","itemArr","refreshItemFunc","itemTween","setDataFlag","startIndex","stopIndex","renderChildBatch","onLoad","node","getComponent","content","children","e","name","width","height","contentLayout","spacingX","spacingY","enabled","contentWidth","contentHeight","forEach","active","push","anchorX","anchorY","ceil","on","onScrolling","addRenderChildBatch","isNative","addComponent","length","start","posY","getPosition","y","posX","x","abs","stop","renderItemArr","item","hideIndex","i","recycleItem","k","needUpdate","startFrameUpdate","createNode","shift","parent","addRootItemNode","startTime","Date","getTime","setPosition","data","index","scale","showTween","undefined","setScale","tn","to","call","scheduleOnce","bind","indexOf","clearAllItems","initItem","refreshItemIndex","setData","dataArr","resetPos","unscheduleAllCallbacks","refreshItemArr","layoutItemArr","line","line2","resizeContentNode","lastItem","stopAutoScroll","maxOffset","getMaxScrollOffset","offset","getScrollOffset","scrollToOffset","refreshList","removeByIndex","console","log","splice","refreshIndex","insertData","arr","pIndex","pushData","isScrollEnd","scrollToEnd","time","scrollToBottom","scrollToRight","scrollToIndex","dy","dx","onDestroy","off"],"mappings":"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","sourcesContent":["import { Component, find, game, instantiate, isValid, Layout, Node, ScrollView, sys, tween, UITransform, v3, _decorator } from 'cc';\r\nimport { myLog } from '../../../common/myLog';\r\nimport { RenderChildBatch } from './RenderChildBatch';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('ScrollViewUtil')\r\nexport class ScrollViewUtil extends Component {\r\n\r\n    scrollView: ScrollView;\r\n    vertical: boolean = true;\r\n    gapX: number = 0;\r\n    gapY: number = 0;\r\n    paddingLeft: number = 0;\r\n    paddingRight: number = 0;\r\n    paddingTop: number = 0;\r\n    paddingBottom: number = 0;\r\n    contentNode: Node;\r\n    contentTransform: UITransform;\r\n\r\n    viewNode: Node;\r\n    viewWidth: number;\r\n    viewHeight: number;\r\n    viewTransform: UITransform;\r\n\r\n    itemUI: Node;\r\n    itemUITransform: UITransform;\r\n    itemUIWidth: number = 0;\r\n    itemUIHeight: number = 0;\r\n    // 缓存还未被使用的itemUI\r\n    itemUIFreeArr: any = [];\r\n    // 首个itemUI的坐标\r\n    startPosX: number = 0;\r\n    startPosY: number = 0;\r\n\r\n    // 一屏最多可以显示几行或者几列itemUI\r\n    viewNum: number = 0;\r\n    // 一行或者一列要显示几个\r\n    changeNum: number = 1;\r\n    // 最大行数或列数\r\n    maxLines: number = 1;\r\n\r\n    // 记录每帧需要刷新的数据\r\n    frameUpdateArr: any = [];\r\n    // 每帧最多能处理的时间间隔\r\n    frameTime: number = Math.floor(1000 / (game.getFrameRate() + 10));\r\n\r\n    itemArr: any = [];\r\n    refreshItemFunc: Function;\r\n\r\n    itemTween: boolean = false;\r\n    setDataFlag: boolean = false;\r\n\r\n    // 只会刷新行数或者列数索引区间内的节点\r\n    // 开始索引\r\n    startIndex: number = 0;\r\n    // 结束索引\r\n    stopIndex: number = 0;\r\n\r\n    private renderChildBatch: RenderChildBatch = null;\r\n\r\n    onLoad() {\r\n        this.scrollView = this.node.getComponent(ScrollView);\r\n        this.contentNode = this.scrollView.content;\r\n\r\n        this.itemUI = this.contentNode.children[0];\r\n        if (!this.itemUI) {\r\n            myLog.e(\"=============ScrollViewUtil itemUI is null:\" + this.node.name);\r\n        }\r\n        this.itemUITransform = this.itemUI.getComponent(UITransform);\r\n        this.itemUIWidth = this.itemUITransform.width;\r\n        this.itemUIHeight = this.itemUITransform.height;\r\n\r\n        // 获取排列间距参数\r\n        this.vertical = this.scrollView.vertical;\r\n        let contentLayout = this.contentNode.getComponent(Layout);\r\n        this.gapX = contentLayout.spacingX;\r\n        this.gapY = contentLayout.spacingY;\r\n        this.paddingLeft = contentLayout.paddingLeft;\r\n        this.paddingRight = contentLayout.paddingRight;\r\n        this.paddingTop = contentLayout.paddingTop;\r\n        this.paddingBottom = contentLayout.paddingBottom;\r\n        contentLayout.enabled = false;\r\n        this.contentTransform = this.contentNode.getComponent(UITransform);\r\n\r\n        let contentWidth = this.contentTransform.width;\r\n        let contentHeight = this.contentTransform.height;\r\n\r\n        this.viewNode = find(\"view\", this.node);\r\n        this.viewTransform = this.viewNode.getComponent(UITransform);\r\n        this.viewWidth = this.viewTransform.width;\r\n        this.viewHeight = this.viewTransform.height;\r\n\r\n        this.itemUIFreeArr = [];\r\n        this.contentNode.children.forEach((node: Node) => {\r\n            node.active = false;\r\n            this.itemUIFreeArr.push(node);\r\n        });\r\n\r\n        if (this.vertical) {\r\n            this.viewTransform.anchorX = 0.5;\r\n            this.viewTransform.anchorY = 1;\r\n            this.contentTransform.anchorX = 0.5;\r\n            this.contentTransform.anchorY = 1;\r\n            this.viewNum = Math.ceil(this.viewHeight / (this.itemUIHeight + this.gapY)) + 1;\r\n            this.changeNum = Math.floor((contentWidth + this.gapX - this.paddingLeft - this.paddingRight) / (this.itemUIWidth + this.gapX));\r\n        } else {\r\n            this.viewTransform.anchorX = 0;\r\n            this.viewTransform.anchorY = 0.5;\r\n            this.contentTransform.anchorX = 0;\r\n            this.contentTransform.anchorY = 0.5;\r\n            this.viewNum = Math.ceil(this.viewWidth / (this.itemUIWidth + this.gapX)) + 1;\r\n            this.changeNum = Math.floor((contentHeight + this.gapY - this.paddingTop - this.paddingBottom) / (this.itemUIHeight + this.gapY));\r\n        }\r\n        if (this.changeNum < 1) {\r\n            this.changeNum = 1;\r\n        }\r\n\r\n        // 首个itemUI的坐标\r\n        this.startPosX = this.itemUIWidth * this.itemUITransform.anchorX - this.contentTransform.width * this.contentTransform.anchorX + this.paddingLeft;\r\n        this.startPosY = contentHeight * (1 - this.contentTransform.anchorY) - this.itemUIHeight * (1 - this.itemUITransform.anchorY) - this.paddingTop;\r\n\r\n        // scrollView监听事件\r\n        this.node.on('scrolling', this.onScrolling, this);\r\n\r\n        // 记录每帧需要刷新的数据\r\n        this.frameUpdateArr = [];\r\n\r\n        this.addRenderChildBatch();\r\n    }\r\n\r\n    public addRenderChildBatch() {\r\n        if (sys.isNative) {\r\n            return;\r\n        }\r\n        if (this.renderChildBatch) {\r\n            return;\r\n        }\r\n        this.renderChildBatch = this.contentNode.addComponent(RenderChildBatch);\r\n    }\r\n\r\n    // 滑动中回调\r\n    onScrolling() {\r\n        if (this.itemArr.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        let start = 0;\r\n        // 垂直滚动\r\n        if (this.vertical) {\r\n            let posY = this.contentNode.getPosition().y;\r\n            if (posY > this.contentTransform.height - this.viewHeight) {\r\n                posY = this.contentTransform.height - this.viewHeight;\r\n            }\r\n            if (posY < 0) {\r\n                posY = 0;\r\n            }\r\n            // 开始行\r\n            start = Math.floor((posY + this.gapY - this.paddingTop) / (this.itemUIHeight + this.gapY));\r\n        } else {\r\n            // 水平滚动\r\n            let posX = this.contentNode.getPosition().x;\r\n            if (posX < this.viewWidth - this.contentTransform.width) {\r\n                posX = this.viewWidth - this.contentTransform.width;\r\n            }\r\n            if (posX > 0) {\r\n                posX = 0;\r\n            }\r\n            posX = Math.abs(posX);\r\n            // 开始列\r\n            start = Math.floor((posX + this.gapX - this.paddingLeft) / (this.itemUIWidth + this.gapX));\r\n        }\r\n\r\n        if (start < 0) {\r\n            start = 0;\r\n        }\r\n        if (start > this.maxLines - 1) {\r\n            start = this.maxLines - 1;\r\n        }\r\n\r\n        // 结束行\r\n        let stop = start + this.viewNum;\r\n        if (stop > this.maxLines - 1) {\r\n            stop = this.maxLines - 1;\r\n        }\r\n\r\n        // 跟上屏显示范围不一样，才会进行刷新\r\n\r\n        if (start != this.startIndex || stop != this.stopIndex) {\r\n            this.startIndex = start;\r\n            this.stopIndex = stop;\r\n            this.renderItemArr();\r\n        }\r\n    }\r\n\r\n    // 渲染屏幕范围内的itemArr\r\n    renderItemArr() {\r\n        let item = null;\r\n        // 先回收屏幕范围外的item\r\n        let hideIndex = this.startIndex * this.changeNum;\r\n        for (let i = 0; i < hideIndex; i++) {\r\n            item = this.itemArr[i];\r\n            this.recycleItem(item);\r\n        }\r\n\r\n        hideIndex = (this.stopIndex + 1) * this.changeNum;\r\n        for (let i = hideIndex; i < this.itemArr.length; i++) {\r\n            item = this.itemArr[i];\r\n            this.recycleItem(item);\r\n        }\r\n\r\n        // 再显示屏幕范围内的\r\n        for (let i = this.startIndex; i <= this.stopIndex; i++) {\r\n            let startIndex = i * this.changeNum;\r\n            let stopIndex = startIndex + this.changeNum;\r\n            for (let k = startIndex; k < stopIndex; k++) {\r\n                if (!this.itemArr[k]) {\r\n                    continue;\r\n                }\r\n                item = this.itemArr[k];\r\n                if (item.node) {\r\n                    // 已经刷新过了，就不再刷新，节省CPU开销\r\n                    continue;\r\n                }\r\n                // 更换到每帧去刷新\r\n                item.needUpdate = true;\r\n                this.frameUpdateArr.push(item);\r\n            }\r\n        }\r\n        this.startFrameUpdate();\r\n    }\r\n\r\n    // 生成node\r\n    createNode() {\r\n        let node = null;\r\n        if (this.itemUIFreeArr.length > 0) {\r\n            node = this.itemUIFreeArr.shift();\r\n        } else {\r\n            node = instantiate(this.itemUI);\r\n        }\r\n        node.parent = this.contentNode;\r\n\r\n        if (this.renderChildBatch) {\r\n            this.renderChildBatch.addRootItemNode(node);\r\n        }\r\n\r\n        return node;\r\n    }\r\n\r\n    startFrameUpdate() {\r\n        let startTime = new Date().getTime();\r\n        while (true) {\r\n            if (!this.frameUpdateArr || this.frameUpdateArr.length <= 0) {\r\n                this.setDataFlag = false;\r\n                break;\r\n            }\r\n\r\n            let item = this.frameUpdateArr.shift();\r\n            if (!item.needUpdate) {\r\n                continue;\r\n            }\r\n\r\n            if (!item.node) {\r\n                item.node = this.createNode();\r\n            }\r\n            if (!item.node.active) {\r\n                item.node.active = true;\r\n            }\r\n            item.node.setPosition(item.x, item.y);\r\n\r\n            item.node.item = item.data;\r\n            item.node.index = item.index;\r\n            item.node.scale = v3(1, 1, 1);\r\n            if (item.node.showTween) {\r\n                item.node.showTween.stop();\r\n                item.node.showTween = undefined;\r\n            }\r\n            this.refreshItemFunc(item.node, item.data, item.index);\r\n\r\n            if (this.itemTween && this.setDataFlag) {\r\n                item.node.setScale(0, 0, 1);\r\n                let tn = tween(item.node).to(0.2, { scale: v3(1.2, 1.2, 1) }).to(0.1, { scale: v3(1, 1, 1) }).call(() => {\r\n                    item.node.showTween = undefined;\r\n                }).start();\r\n                item.node.showTween = tn;\r\n                this.scheduleOnce(() => {\r\n                    this.startFrameUpdate();\r\n                }, 0.05);\r\n                break;\r\n            } else {\r\n                if (new Date().getTime() - startTime >= this.frameTime) {\r\n                    // 本帧跑满了，下一帧继续\r\n                    this.scheduleOnce(this.startFrameUpdate.bind(this));\r\n                    break;\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    // 回收item.node\r\n    recycleItem(item: any) {\r\n        if (item.node && isValid(item.node)) {\r\n            if (this.itemUIFreeArr.indexOf(item.node) == -1) {\r\n                this.itemUIFreeArr.push(item.node);\r\n            }\r\n            item.node.active = false;\r\n            item.node.showTween = undefined;\r\n            item.node = null;\r\n            item.needUpdate = undefined;\r\n        }\r\n    }\r\n\r\n    // 清除所有items\r\n    clearAllItems() {\r\n        for (let item of this.itemArr) {\r\n            this.recycleItem(item);\r\n        }\r\n    }\r\n\r\n    // 初始化item\r\n    initItem(data: any, index: number) {\r\n        let item = {\r\n            node: null,\r\n            data: data,\r\n            index: index,\r\n            x: 0,\r\n            y: 0\r\n        };\r\n\r\n        return item;\r\n    }\r\n\r\n    refreshItemIndex(item: any, index: number) {\r\n        item.index = index;\r\n        if (item.node) {\r\n            item.node.index = index;\r\n        }\r\n    }\r\n\r\n    setData(dataArr: any, refreshItemFunc: Function, resetPos: boolean = true, itemTween: boolean = false) {\r\n        if (!this.scrollView) {\r\n            return;\r\n        }\r\n        this.itemTween = itemTween;\r\n        this.setDataFlag = true;\r\n\r\n        this.frameUpdateArr = [];\r\n        this.unscheduleAllCallbacks();\r\n\r\n        this.clearAllItems();\r\n        this.itemArr = [];\r\n\r\n        if (!dataArr) {\r\n            dataArr = [];\r\n        }\r\n\r\n        this.refreshItemFunc = refreshItemFunc;\r\n        for (let i = 0; i < dataArr.length; i++) {\r\n            let data = dataArr[i];\r\n            let item = this.initItem(data, i);\r\n            this.itemArr.push(item);\r\n        }\r\n\r\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\r\n        if (this.maxLines < 1) {\r\n            this.maxLines = 1;\r\n        }\r\n\r\n        this.refreshItemArr(0, resetPos);\r\n    }\r\n\r\n    // 布局itemArr，计算出每个item摆放的坐标信息\r\n    layoutItemArr(start: number) {\r\n        if (this.itemArr.length <= 0) {\r\n            return;\r\n        }\r\n\r\n        for (let index = start; index < this.itemArr.length; index++) {\r\n            let line = Math.floor(index / this.changeNum);\r\n            let line2 = index % this.changeNum;\r\n            let item = this.itemArr[index];\r\n            if (this.vertical) {\r\n                item.x = this.startPosX + line2 * (this.itemUIWidth + this.gapX);\r\n                item.y = this.startPosY - line * (this.itemUIHeight + this.gapY);\r\n            } else {\r\n                item.x = this.startPosX + line * (this.itemUIWidth + this.gapX);\r\n                item.y = this.startPosY - line2 * (this.itemUIHeight + this.gapY);\r\n            }\r\n        }\r\n    }\r\n\r\n    // 调整content节点大小\r\n    resizeContentNode() {\r\n        if (!this.contentNode || !this.itemUI) {\r\n            return;\r\n        }\r\n        if (this.itemArr.length <= 0) {\r\n            this.contentTransform.width = 0;\r\n            this.contentTransform.height = 0;\r\n            return;\r\n        }\r\n        let lastItem = this.itemArr[this.itemArr.length - 1];\r\n        if (this.vertical) {\r\n            let height = -lastItem.y + this.itemUIHeight * this.itemUITransform.anchorY;\r\n            this.contentTransform.height = height + this.paddingBottom;\r\n        } else {\r\n            let width = lastItem.x + this.itemUIWidth * (1 - this.itemUITransform.anchorX);\r\n            this.contentTransform.width = width + this.paddingRight;\r\n        }\r\n    }\r\n\r\n    // 计算每个item的坐标位置和contentNode大小\r\n    refreshItemArr(start: number, resetPos: boolean = true) {\r\n        if (!this.scrollView) {\r\n            return;\r\n        }\r\n\r\n        this.layoutItemArr(start);\r\n        this.resizeContentNode();\r\n\r\n        this.startIndex = -1;\r\n        this.stopIndex = -1;\r\n\r\n        this.scrollView.stopAutoScroll();\r\n        let maxOffset = this.scrollView.getMaxScrollOffset();\r\n        let offset = this.scrollView.getScrollOffset();\r\n        if (this.vertical) {\r\n            let posY = 0;\r\n            if (!resetPos) {\r\n                posY = this.contentNode.getPosition().y;\r\n                if (posY > maxOffset.y) {\r\n                    posY = maxOffset.y;\r\n                }\r\n                if (posY < 0) {\r\n                    posY = 0;\r\n                }\r\n            }\r\n            offset.y = posY;\r\n            this.scrollView.scrollToOffset(offset, 0);\r\n        } else {\r\n            let posX = 0;\r\n            if (!resetPos) {\r\n                posX = Math.abs(this.contentNode.getPosition().x);\r\n                if (posX > Math.abs(maxOffset.x)) {\r\n                    posX = Math.abs(maxOffset.x);\r\n                }\r\n                if (posX < 0) {\r\n                    posX = 0;\r\n                }\r\n            }\r\n            offset.x = posX;\r\n            this.scrollView.scrollToOffset(offset, 0);\r\n        }\r\n\r\n        this.onScrolling();\r\n    }\r\n\r\n    // 刷新整个列表\r\n    refreshList() {\r\n        if (!this.refreshItemFunc) {\r\n            return;\r\n        }\r\n        this.itemArr.forEach((item: any) => {\r\n            if (!item.node) {\r\n                return;\r\n            }\r\n            this.refreshItemFunc(item.node, item.data, item.index);\r\n        });\r\n    }\r\n\r\n    // 移除某个索引item，会重新排列索引\r\n    removeByIndex(index: number, resetPos: boolean = false) {\r\n        if (index < 0 || index >= this.itemArr.length) {\r\n            console.log(\"无效的index\", index);\r\n            return;\r\n        }\r\n        let item = this.itemArr[index];\r\n        if (!item || !this.refreshItemFunc) {\r\n            return;\r\n        }\r\n\r\n        this.itemArr.splice(index, 1);\r\n        this.recycleItem(item);\r\n\r\n        // 重新排列索引\r\n        for (let i = index; i < this.itemArr.length; i++) {\r\n            let item = this.itemArr[i];\r\n            this.refreshItemIndex(item, i);\r\n        }\r\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\r\n        if (this.maxLines < 1) {\r\n            this.maxLines = 1;\r\n        }\r\n        this.refreshItemArr(index, resetPos);\r\n    }\r\n\r\n    // 刷新指定索引的itemUI\r\n    refreshIndex(index: number, data?: any) {\r\n        if (index == undefined || index < 0 || index >= this.itemArr.length) {\r\n            console.log(\"无效的index\", index);\r\n            return;\r\n        }\r\n        let item = this.itemArr[index];\r\n        if (!item) {\r\n            return;\r\n        }\r\n        if (data != undefined) {\r\n            item.data = data;\r\n        }\r\n        if (item.node) {\r\n            item.node.item = item.data;\r\n            if (this.refreshItemFunc) {\r\n                this.refreshItemFunc(item.node, item.data, index);\r\n            }\r\n        }\r\n    }\r\n\r\n    // 插入数据\r\n    insertData(index: number, arr: any, resetPos: boolean = false) {\r\n        if (!arr || arr.length == 0) {\r\n            console.log(\"没有要添加的数据\");\r\n            return;\r\n        }\r\n        if (index < 0 || index > this.itemArr.length) {\r\n            console.log(\"无效的index\", index);\r\n            return;\r\n        }\r\n        if (!this.refreshItemFunc) {\r\n            console.log(\"首次请调用setData方法\");\r\n            return;\r\n        }\r\n\r\n        for (let i = 0; i < arr.length; i++) {\r\n            let pIndex = index + i;\r\n            let item = this.initItem(arr[i], pIndex);\r\n            this.itemArr.splice(pIndex, 0, item);\r\n        }\r\n        for (let i = index + arr.length; i < this.itemArr.length; i++) {\r\n            let item = this.itemArr[i];\r\n            this.refreshItemIndex(item, i);\r\n        }\r\n\r\n        this.maxLines = Math.ceil(this.itemArr.length / this.changeNum);\r\n        if (this.maxLines < 1) {\r\n            this.maxLines = 1;\r\n        }\r\n\r\n        this.refreshItemArr(index, resetPos);\r\n\r\n    }\r\n\r\n    // 追加数据\r\n    pushData(arr: any, resetPos: boolean = false) {\r\n        this.insertData(this.itemArr.length, arr, resetPos);\r\n    }\r\n\r\n    // 是否滑动到尽头了\r\n    isScrollEnd() {\r\n        let maxOffset = this.scrollView.getMaxScrollOffset();\r\n        let offset = this.scrollView.getScrollOffset();\r\n        if (Math.abs(maxOffset.x) - Math.abs(offset.x) <= 10 && Math.abs(maxOffset.y) - Math.abs(offset.y) <= 10) {\r\n            return true;\r\n        }\r\n\r\n        return false;\r\n    }\r\n\r\n    // 滑动到尽头\r\n    scrollToEnd(time?: number) {\r\n        this.scrollView.stopAutoScroll();\r\n        if (time == undefined || time < 0) {\r\n            time = 0.5;\r\n        }\r\n        if (this.vertical) {\r\n            this.scrollView.scrollToBottom(time);\r\n        } else {\r\n            this.scrollView.scrollToRight(time);\r\n        }\r\n    }\r\n\r\n    // 滑动到指定索引位置，该位置将定位到最底下(垂直滚动)或者最右边(水平滚动)\r\n    scrollToIndex(index: number, time?: number) {\r\n        if (time == undefined || time < 0) {\r\n            time = 0;\r\n        }\r\n        if (index < 0) {\r\n            return;\r\n        }\r\n        let item = this.itemArr[index];\r\n        if (!item) {\r\n            return;\r\n        }\r\n\r\n        this.scrollView.stopAutoScroll();\r\n        let maxOffset = this.scrollView.getMaxScrollOffset();\r\n        let offset = this.scrollView.getScrollOffset();\r\n        if (this.vertical) {\r\n            let dy = Math.abs(item.y) + this.itemUIHeight - this.viewHeight;\r\n            if (dy < 0) {\r\n                dy = 0;\r\n            }\r\n            if (dy > maxOffset.y) {\r\n                dy = maxOffset.y;\r\n            }\r\n            offset.y = dy;\r\n            this.scrollView.scrollToOffset(offset, time);\r\n        } else {\r\n            let dx = Math.abs(item.x) + this.itemUIWidth - this.viewWidth;\r\n            if (dx < 0) {\r\n                dx = 0;\r\n            }\r\n            if (dx > Math.abs(maxOffset.x)) {\r\n                dx = Math.abs(maxOffset.x);\r\n            }\r\n            offset.x = dx;\r\n            this.scrollView.scrollToOffset(offset, time);\r\n        }\r\n        this.onScrolling();\r\n    }\r\n\r\n    onDestroy() {\r\n        this.itemUIFreeArr = [];\r\n        this.itemArr = [];\r\n        this.frameUpdateArr = [];\r\n        this.refreshItemFunc = null;\r\n        this.node.off(\"scrolling\", this.onScrolling, this);\r\n        this.unscheduleAllCallbacks();\r\n    }\r\n}\r\n\r\n"]}