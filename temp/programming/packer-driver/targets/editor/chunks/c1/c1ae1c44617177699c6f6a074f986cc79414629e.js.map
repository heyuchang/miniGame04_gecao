{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/BlessResultLayer.ts"],"names":["_decorator","Node","Prefab","instantiate","v3","tween","Label","myLog","constants","audioManager","designManager","PropItemPrefab","BaseUILayer","ccclass","property","BlessResultLayer","type","tooltip","onLoad","i","fitNodeWidget","btnlayer","onEnable","blessId","layerData","getPropId","item","propItem","position","name","propBlessLayer","addChild","getComponent","setScale","setView","Type_HideNum","Type_UnTouch","startAnimal","propData","getRowById","tableName","prop","propData2","propNameLab","string","atk","setSpriteFrame2","attrIcon","bundles","wwqVec","attrNumLab","color","colors","blue","parseColor","attrlabel","attrNumLab1","hp","green","attrNodebg","active","delay","to","hide","start","getChildByName","self","call","show","set","scale","node","title","onDisable","onDestroy","closeBless","playEffect","closeLayer"],"mappings":"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","sourcesContent":["import { _decorator, Node, Prefab, instantiate, v3, Button, tween, UIOpacity, UITransform, Label, RichText, Quat } from 'cc';\r\nimport { myLog } from '../../../common/myLog';\r\nimport { constants } from '../../data/constants';\r\nimport { audioManager } from '../../manager/audioManager';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { PropItemPrefab } from '../item/PropItemPrefab';\r\n\r\nimport { BaseUILayer } from './BaseUILayer';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BlessResultLayer')\r\nexport class BlessResultLayer extends BaseUILayer {\r\n\r\n    @property({ type: Node, tooltip: \"道具选择容器\" }) propBlessLayer: Node[] = [];\r\n    @property({ type: Node, tooltip: \"道具结果容器\" }) BlessResultLayer: Node = null;\r\n\r\n    @property({ type: Prefab, tooltip: \"道具节点\" }) propItem: Prefab = null;\r\n\r\n    @property({ type: Node }) btnlayer: Node = null;\r\n    @property({ type: Label }) propNameLab: Label = null;\r\n    @property({ type: Node }) attrIcon: Node = null;\r\n    @property({ type: Label }) attrlabel: Label = null;\r\n    @property({ type: Label }) attrNumLab1: Label = null;\r\n    @property({ type: Label }) attrNumLab: Label = null;\r\n\r\n    @property({ type: Node }) attrNodebg: Node = null;\r\n\r\n    @property({ type: Node }) title: Node = null;\r\n\r\n\r\n    onLoad() {\r\n        myLog.i(\"BlessResultLayer onLoad\")\r\n        this.fitNodeWidget(this.btnlayer, 0)\r\n    }\r\n\r\n    \r\n\r\n    onEnable() {\r\n        myLog.i(\"BlessResultLayer onEnable\")\r\n        super.onEnable();\r\n        let blessId = this.layerData.blessId\r\n        let getPropId = this.layerData.getPropId\r\n        for (let i = 0; i < 3; i++) {\r\n            let item = instantiate(this.propItem)\r\n            item.position = i == 2 ? v3(0, 0, 0) : v3(0, 10, 0)\r\n            item.name = \"prop\"\r\n            this.propBlessLayer[i].addChild(item)\r\n            item.getComponent(PropItemPrefab).setScale(120)\r\n            item.getComponent(PropItemPrefab).setView(blessId, 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch)\r\n        }\r\n        this.startAnimal()\r\n\r\n        let propData = designManager.getRowById(constants.tableName.prop, blessId)\r\n        let propData2 = designManager.getRowById(constants.tableName.prop, getPropId)\r\n\r\n        this.propNameLab.string = propData.name\r\n\r\n        if (propData.atk > 0) {\r\n            this.setSpriteFrame2(this.attrIcon, \"heroLayer/ui_gj\", null, constants.bundles.wwqVec)\r\n            this.attrNumLab.string = \"+\" + propData2.atk\r\n            this.attrNumLab.color = constants.colors.blue.parseColor()\r\n            this.attrlabel.string = \"攻击\"\r\n            this.attrNumLab1.string = \"\" + propData.atk\r\n        } else if (propData.hp > 0) {\r\n            this.attrNumLab.string = \"+\" + propData2.hp\r\n            this.setSpriteFrame2(this.attrIcon, \"heroLayer/ui_sm\", null, constants.bundles.wwqVec)\r\n            this.attrlabel.string = \"生命\"\r\n            this.attrNumLab.color = constants.colors.green.parseColor()\r\n            this.attrNumLab1.string = \"\" + propData.hp\r\n        }\r\n\r\n        this.attrNodebg.active = false\r\n    }\r\n\r\n    startAnimal() {\r\n        // let quat: Quat = new Quat();\r\n        // let quat2: Quat = new Quat();\r\n        // Quat.fromEuler(quat, 0, 30, 0);\r\n        // Quat.fromEuler(quat2, 0, -30, 0);\r\n        tween(this.propBlessLayer[0]).delay(1).to(0.1, { position: v3(15, 268, 0) }).hide().start()\r\n        tween(this.propBlessLayer[1]).delay(1).to(0.1, { position: v3(15, 268, 0) }).hide().start()\r\n        let getPropId = this.layerData.getPropId\r\n        let item = this.propBlessLayer[2].getChildByName(\"prop\")\r\n        let self = this\r\n        tween(this.propBlessLayer[2]).delay(1).hide().delay(0.8).call(function () {\r\n            item.getComponent(PropItemPrefab).setView(getPropId, 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch)\r\n            self.attrNodebg.active = true\r\n            self.btnlayer.active = true\r\n        }).show().set({ scale: v3(0, 0, 0) }).to(0.2, { scale: v3(1, 1, 1) }).start()\r\n        tween(this.attrNodebg).delay(1.8).to(0.1, { scale: v3(1.2, 1.2, 1.2) }).to(0.1, { scale: v3(1, 1, 1) }).start()\r\n\r\n        tween(this.attrIcon).hide().delay(1.9).show().start()\r\n        tween(this.propNameLab.node).hide().delay(1.9).show().start()\r\n        tween(this.attrNumLab.node).hide().delay(2.1).show().start()\r\n        tween(this.attrNumLab1.node).hide().delay(2.1).show().start()\r\n        tween(this.title).hide().delay(1.7).show().start()\r\n\r\n        // tween(this.propBlessLayer[0]).to(0.2, { rotation:quat}).to(0.2, { rotation:quat2}).to(0.2, { rotation:quat}).to(0.2, { rotation:quat2}).to(0.3,{position:v3(15,268, 0)}).start()\r\n        // tween(this.propBlessLayer[1]).to(0.2, { rotation:quat}).to(0.2, { rotation:quat2}).to(0.2, { rotation:quat}).to(0.2, { rotation:quat2}).to(0.3,{position:v3(15,268, 0)}).start()\r\n    }\r\n\r\n    onDisable() {\r\n        super.onDisable();\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    start() {\r\n        this.btnlayer.active = false\r\n    }\r\n\r\n    closeBless() {\r\n        audioManager.playEffect(\"btnClick\")\r\n        this.closeLayer()\r\n    }\r\n\r\n\r\n}\r\n\r\n"]}