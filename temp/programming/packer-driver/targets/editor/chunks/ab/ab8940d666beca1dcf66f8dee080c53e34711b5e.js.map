{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/BlessLayer.ts"],"names":["instantiate","Label","Node","Prefab","RichText","tween","UIOpacity","UITransform","v3","_decorator","tyqSDK","cocosUtil","constants","msgac","audioManager","designManager","eventManager","playerModel","UserData","PropItemPrefab","BaseUILayer","ccclass","property","BlessLayer","type","tooltip","_curBlessId","_curBlessNum","NeedBlessNum","_curAutoIndex","_curIndex","onLoad","fitScrollView","propView","fitNodeWidget","btnlayer","onEnable","on","wearDrop","initList","btnBless","active","onDisable","off","onDestroy","start","selectListNode","initSelectData","blessPropNode","tishiText","string","arr","getInstance","getPropSort","dataArr","forEach","element","id","curprop","getRowById","tableName","prop","quality","num","i","push","iswear","wearIndex","scrollViewSetData","scrollView","initItem","itemUI","item","index","data","getComponent","setView","Type_HideNum","Type_UnTouch","Type_Grey","getChildByName","setScale","selectProp","event","itemData","target","toast","propid","pos","parent","convertToWorldSpaceAR","position","addSelectProp","startp","propBlessLayer","propItem","name","addChild","EventType","TOUCH_END","unSelectProp","p","convertToNodeSpaceAR","to","curProp","needCoinLabel","config","setSpriteFrame2","needIcon","blessId","showResultProp","selectBtnNode","BlessResultLayer","removeAllChildren","showLight","children","length","showPropInfo","propData","propData2","atk","attrIcon","bundles","wwqVec","attrNumLab","formatNumString","color","colors","blue","parseColor","attrlabel","hp","green","propNameLab","propColor","propColor2","isShow","resultLight","stop","opacity","union","repeatForever","blessAction","playEffect","coinNum","checkAndUseBaoshi","cheackAndUseCoin","blessProp","clearBlessLayer","eventSendCustomEvent","openLayer","layers","getPropId","addDayTaskNum","RewardItemLayer","propId","adCoin","adDiamond","allBlessProp","result","autoBlessAction","Math","min","closeBless","closeLayer","onSelectBtnClick","onSelectItemClick","parseInt","selectcurbg"],"mappings":"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","sourcesContent":["import { instantiate, Label, Node, Prefab, RichText, tween, UIOpacity, UITransform, v3, _decorator } from 'cc';\r\nimport { tyqSDK } from '../../../tyqSDK/tyqSDK';\r\nimport { cocosUtil } from '../../../utils/cocosUtil';\r\nimport { constants } from '../../data/constants';\r\nimport { msgac } from '../../data/msgac';\r\nimport { audioManager } from '../../manager/audioManager';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { eventManager } from '../../manager/eventManager';\r\nimport { playerModel } from '../../model/playerModel';\r\nimport { UserData } from '../../model/UserData';\r\nimport { PropItemPrefab } from '../item/PropItemPrefab';\r\nimport { BaseUILayer } from './BaseUILayer';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('BlessLayer')\r\nexport class BlessLayer extends BaseUILayer {\r\n\r\n    @property({ type: Node, tooltip: \"道具选择容器\" }) propBlessLayer: Node[] = [];\r\n    @property({ type: Node, tooltip: \"道具结果容器\" }) BlessResultLayer: Node = null;\r\n\r\n    @property({ type: Prefab, tooltip: \"道具节点\" }) propItem: Prefab = null;\r\n\r\n    @property({ type: Node, tooltip: \"道具列表View\" }) propView: Node = null;\r\n    @property({ type: Node, tooltip: \"道具列表View\" }) scrollView: Node = null;\r\n    @property({ type: Node }) resultLight: Node = null;\r\n    @property({ type: Node, tooltip: \"合成按钮\" }) btnBless: Node = null;\r\n    @property({ type: Node }) btnlayer: Node = null;\r\n    @property({ type: Node }) blessPropNode: Node = null;\r\n\r\n    @property({ type: Node }) attrIcon: Node = null;\r\n    @property({ type: Label }) attrlabel: Label = null;\r\n    @property({ type: Label }) propNameLab: Label = null;\r\n    @property({ type: Label }) attrNumLab: Label = null;\r\n    @property({ type: RichText }) tishiText: RichText = null;\r\n\r\n    @property({ type: Node }) selectListNode: Node = null;\r\n    @property({ type: Node }) selectBtnNode: Node = null;\r\n\r\n    @property({ type: Label }) needCoinLabel: Label = null;\r\n\r\n\r\n    @property({ type: Node }) needIcon: Node = null;\r\n\r\n\r\n    _curBlessId = 0\r\n    _curBlessNum = 0\r\n\r\n    NeedBlessNum = 3\r\n\r\n    onLoad() {\r\n        this.fitScrollView(this.propView, 320, 600)\r\n        this.fitNodeWidget(this.btnlayer, 30)\r\n    }\r\n\r\n    onEnable() {\r\n        super.onEnable();\r\n        eventManager.on(msgac.wearDrop, this.initList, this);\r\n        this.btnBless.active = false\r\n    }\r\n\r\n    onDisable() {\r\n        super.onDisable();\r\n        eventManager.off(msgac.wearDrop, this.initList, this);\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    start() {\r\n        this.selectListNode.active = false\r\n        this._curIndex = 0\r\n        this.initSelectData()\r\n        this.blessPropNode.active = false\r\n        this.tishiText.string = \"\"\r\n    }\r\n\r\n    initList() {\r\n        let arr = UserData.getInstance().getPropSort()\r\n        let dataArr = []\r\n        if (this._curIndex == 0) {\r\n            arr.forEach(element => {\r\n                // let num = (this._curBlessId == element.id) ? element.num - this._curBlessNum : element.num\r\n                if (this._curBlessId == element.id || this._curBlessId <= 0) {\r\n                    let curprop = designManager.getRowById(constants.tableName.prop, element.id)\r\n                    if (curprop.quality < 5) {\r\n                        let num = element.num\r\n                        for (let i = 0; i < num; i++) {\r\n                            dataArr.push([element.id, element.iswear == 1 && i == 0, i < this._curBlessNum])\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        } else {\r\n            arr.forEach(element => {\r\n                // let num = (this._curBlessId == element.id) ? element.num - this._curBlessNum : element.num\r\n                if (this._curBlessId == element.id || this._curBlessId <= 0) {\r\n                    let curprop = designManager.getRowById(constants.tableName.prop, element.id)\r\n                    if (curprop.wearIndex == this._curIndex && curprop.quality < 5) {\r\n                        let num = element.num\r\n                        for (let i = 0; i < num; i++) {\r\n                            dataArr.push([element.id, element.iswear == 1 && i == 0, i < this._curBlessNum])\r\n                        }\r\n                    }\r\n                }\r\n            });\r\n        }\r\n\r\n        this.scrollViewSetData(this.scrollView, dataArr, this.initItem, [this._curBlessId])\r\n    }\r\n\r\n    initItem(itemUI: Node, item: any, index: number, data) {\r\n        if (item[0] == data[0] || data[0] == 0) {\r\n            itemUI.getComponent(PropItemPrefab).setView(item[0], 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch)\r\n        } else {\r\n            itemUI.getComponent(PropItemPrefab).setView(item[0], 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch | PropItemPrefab.Type_Grey)\r\n        }\r\n        itemUI.getChildByName(\"wear\").active = item[1]\r\n        itemUI.getChildByName(\"gou\").active = item[2]\r\n        if (item[2]) {\r\n            itemUI.getChildByName(\"grayMask\").active = true\r\n        }\r\n        itemUI.getComponent(PropItemPrefab).setScale(125)\r\n    }\r\n\r\n    selectProp(event) {\r\n\r\n        let itemData = event.target.item\r\n        if (itemData[2]) {\r\n            return\r\n        }\r\n        if (this._curBlessNum >= this.NeedBlessNum) {\r\n            this.toast(\"合成材料已经足够\")\r\n            return\r\n        }\r\n        let propid = itemData[0]\r\n        let pos = event.target.parent.getComponent(UITransform).convertToWorldSpaceAR(event.target.position)\r\n        if (propid != this._curBlessId && this._curBlessId != 0) {\r\n            return\r\n        }\r\n\r\n        this.addSelectProp(propid, 1, pos)\r\n    }\r\n\r\n    addSelectProp(propid, num = 1, startp = null) {\r\n        this._curBlessId = propid\r\n        for (let index = 0; index < num; index++) {\r\n            let item = this.propBlessLayer[this._curBlessNum].getChildByName(\"prop\")\r\n            if (item == null) {\r\n                item = instantiate(this.propItem)\r\n                item.position = v3(0, 0, 0)\r\n                item.name = \"prop\"\r\n                this.propBlessLayer[this._curBlessNum].addChild(item)\r\n                item.getComponent(PropItemPrefab).setScale(120)\r\n            }\r\n            item.on(Node.EventType.TOUCH_END, this.unSelectProp, this);\r\n            item.active = true\r\n            item.getComponent(PropItemPrefab).setView(propid, 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch)\r\n\r\n            if (startp) {\r\n                let p = this.propBlessLayer[this._curBlessNum].getComponent(UITransform).convertToNodeSpaceAR(startp)\r\n                item.position = p\r\n                tween(item).to(0.2, { position: v3(0, 0, 0) }).start()\r\n            }\r\n\r\n            this._curBlessNum += 1\r\n        }\r\n\r\n        if (this._curBlessNum < this.NeedBlessNum) {\r\n            for (let index = this._curBlessNum; index < this.NeedBlessNum; index++) {\r\n                let item = this.propBlessLayer[index].getChildByName(\"prop\")\r\n                if (item == null) {\r\n                    item = instantiate(this.propItem)\r\n                    item.position = v3(0, 0, 0)\r\n                    item.name = \"prop\"\r\n                    this.propBlessLayer[index].addChild(item)\r\n                    item.getComponent(PropItemPrefab).setScale(120)\r\n                    //   item.on(Node.EventType.TOUCH_END, this.unSelectProp, this);\r\n                }\r\n                item.active = true\r\n                item.getComponent(PropItemPrefab).setView(propid, 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch | PropItemPrefab.Type_Grey)\r\n            }\r\n            this.btnBless.active = false\r\n        } else {\r\n            this.btnBless.active = true\r\n        }\r\n\r\n        let curProp = designManager.getRowById(constants.tableName.prop, this._curBlessId)\r\n        // if(curProp.quality ==1){\r\n        this.needCoinLabel.string = \"x\" + designManager.config[\"compose\" + curProp.quality]\r\n        if (curProp.quality == 4) {\r\n            this.setSpriteFrame2(this.needIcon, \"prop/prop_diamond2\")\r\n        } else {\r\n            this.setSpriteFrame2(this.needIcon, \"prop/prop_coin1\")\r\n        }\r\n        //  }\r\n        if (curProp && curProp.blessId && curProp.blessId > 0) {\r\n            this.showResultProp([curProp.blessId])\r\n        }\r\n        this.selectBtnNode.active = this._curBlessNum <= 0\r\n        this.initList()\r\n    }\r\n\r\n    showResultProp(...propid) {\r\n\r\n        this.BlessResultLayer.removeAllChildren()\r\n        if (propid) {\r\n            propid.forEach(element => {\r\n                let item = instantiate(this.propItem)\r\n                item.getComponent(PropItemPrefab).setView(element, 1, PropItemPrefab.Type_HideNum)\r\n                item.getComponent(PropItemPrefab).setScale(130)\r\n                item.position = v3(0, 0, 0)\r\n                // item.getComponent(Button).clickEvents = []\r\n                this.BlessResultLayer.addChild(item)\r\n            });\r\n            this.showLight(this.BlessResultLayer.children.length > 0)\r\n            this.blessPropNode.active = this.BlessResultLayer.children.length > 0\r\n            this.showPropInfo()\r\n            if (this.BlessResultLayer.children.length <= 0) {\r\n                this.tishiText.string = \"\"\r\n            }\r\n        } else {\r\n            this.showLight(false)\r\n            this.blessPropNode.active = false\r\n            this.tishiText.string = \"\"\r\n        }\r\n    }\r\n\r\n    showPropInfo() {\r\n        if (this._curBlessId <= 0) {\r\n            return\r\n        }\r\n        let propData = designManager.getRowById(constants.tableName.prop, this._curBlessId)\r\n        if (propData == null) {\r\n            return\r\n        }\r\n        if (propData && propData.blessId && propData.blessId > 0) {\r\n            var propData2 = designManager.getRowById(constants.tableName.prop, propData.blessId)\r\n        }\r\n\r\n        if (propData.atk > 0) {\r\n            this.setSpriteFrame2(this.attrIcon, \"heroLayer/ui_gj\", null, constants.bundles.wwqVec)\r\n            this.attrNumLab.string = \"\" + cocosUtil.formatNumString(propData2.atk)\r\n            this.attrNumLab.color = constants.colors.blue.parseColor()\r\n            this.attrlabel.string = \"攻击 \" + \"\" + cocosUtil.formatNumString(propData.atk)\r\n        } else if (propData.hp > 0) {\r\n            this.attrNumLab.string = \"\" + cocosUtil.formatNumString(propData2.hp)\r\n            this.setSpriteFrame2(this.attrIcon, \"heroLayer/ui_sm\", null, constants.bundles.wwqVec)\r\n            this.attrlabel.string = \"生命 \" + \"\" + cocosUtil.formatNumString(propData.hp)\r\n            this.attrNumLab.color = constants.colors.green.parseColor()\r\n        }\r\n        this.propNameLab.string = \"\" + propData2.name\r\n        if (this.NeedBlessNum - this._curBlessNum <= 0) {\r\n            this.tishiText.string = \"\"\r\n        } else {\r\n            let propColor = [\"灰色\", \"绿色\", \"蓝色\", \"紫色\", \"黄色\"]\r\n            let propColor2 = [\"#818ca0\", \"#38ff38\", \"#328adc\", \"#ff48d7\", \"#ffb848\"]\r\n            this.tishiText.string = \"<color=#ffffff>需要材料：\" + (this.NeedBlessNum - this._curBlessNum) + \"x</color><color=\" + propColor2[propData.quality - 1] + \">\" + propColor[propData.quality - 1] + \"</color><color=#ffffff>\" + propData.name + \"</color>\"\r\n        }\r\n    }\r\n\r\n    showLight(isShow) {\r\n        this.resultLight.active = false\r\n        if (isShow) {\r\n            this.resultLight.active = true\r\n            tween(this.resultLight.getComponent(UIOpacity)).stop()\r\n            tween(this.resultLight.getComponent(UIOpacity)).to(0.7, { opacity: 0 }).to(0.4, { opacity: 255 }).union().repeatForever().start()\r\n        }\r\n    }\r\n\r\n    unSelectProp() {\r\n        this._curBlessNum--\r\n        let item = this.propBlessLayer[this._curBlessNum].getChildByName(\"prop\")\r\n\r\n        if (this._curBlessNum <= 0) {\r\n            this._curBlessId = 0\r\n            for (let index = 0; index < this.NeedBlessNum; index++) {\r\n                let item = this.propBlessLayer[index].getChildByName(\"prop\")\r\n                if (item) {\r\n                    item.active = false\r\n                    item.off(Node.EventType.TOUCH_END, this.unSelectProp, this);\r\n                }\r\n            }\r\n            this.showResultProp()\r\n            //  return\r\n        } else if (item) {\r\n            //  item.active = false\r\n            //  item.off(Node.EventType.TOUCH_END, this.unSelectProp, this);\r\n            if (this._curBlessId > 0) {\r\n                item.active = true\r\n                item.getComponent(PropItemPrefab).setView(this._curBlessId, 1, PropItemPrefab.Type_HideNum | PropItemPrefab.Type_UnTouch | PropItemPrefab.Type_Grey)\r\n            }\r\n        }\r\n        this.btnBless.active = false\r\n        this.selectBtnNode.active = this._curBlessNum <= 0\r\n        this.initList()\r\n    }\r\n\r\n    blessAction() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        if (this._curBlessNum < this.NeedBlessNum) {\r\n            this.toast(\"需要3个合成材料\")\r\n            return\r\n        }\r\n        let curProp = designManager.getRowById(constants.tableName.prop, this._curBlessId)\r\n        if (curProp) {\r\n            let coinNum = designManager.config[\"compose\" + curProp.quality] || 100\r\n            if (((curProp.quality == 4 && UserData.getInstance().checkAndUseBaoshi(coinNum, true)) || (curProp.quality != 4 && UserData.getInstance().cheackAndUseCoin(coinNum, true)))) {\r\n                if (curProp && curProp.blessId && curProp.blessId > 0) {\r\n                    UserData.getInstance().blessProp(this._curBlessId, curProp.blessId, 0 - this._curBlessNum)\r\n                    this.showResultProp([curProp.blessId])\r\n                    this.clearBlessLayer()\r\n                    this.showResultProp()\r\n                    this.initList()\r\n                    tyqSDK.eventSendCustomEvent(\"合成装备成功\")\r\n                    this.openLayer(constants.layers.BlessResultLayer, { blessId: curProp.id, getPropId: curProp.blessId });\r\n                    playerModel.addDayTaskNum(9);\r\n                }\r\n            } else {\r\n                if (curProp.quality != 4) {\r\n                    tyqSDK.eventSendCustomEvent(\"合成装备金币不足\")\r\n                    this.toast(\"金币不足\")\r\n                    this.openLayer(constants.layers.RewardItemLayer, { propId: 101, num: designManager.config.adCoin })\r\n                } else {\r\n                    tyqSDK.eventSendCustomEvent(\"合成装备钻石不足\")\r\n                    this.toast(\"钻石不足\")\r\n                    this.openLayer(constants.layers.RewardItemLayer, { propId: 801, num: designManager.config.adDiamond })\r\n                }\r\n            }\r\n        }\r\n    }\r\n\r\n    clearBlessLayer() {\r\n        this._curBlessId = 0\r\n        this._curBlessNum = 0\r\n        this.tishiText.string = \"\"\r\n        this.propBlessLayer[0].removeAllChildren()\r\n        this.propBlessLayer[1].removeAllChildren()\r\n        this.propBlessLayer[2].removeAllChildren()\r\n    }\r\n\r\n    allBlessProp() {\r\n        let arr = UserData.getInstance().propData\r\n        let result = []\r\n        for (let index = 0; index < arr.length; index++) {\r\n            if (arr[index].num >= this.NeedBlessNum) {\r\n                let curProp = designManager.getRowById(constants.tableName.prop, arr[index].id)\r\n                if (curProp && curProp.blessId && curProp.blessId > 0) {\r\n                    result.push(curProp.blessId)\r\n                    UserData.getInstance().blessProp(arr[index].id, curProp.blessId, 0 - this.NeedBlessNum)\r\n                }\r\n            }\r\n        }\r\n\r\n        this.showResultProp(result)\r\n        this.clearBlessLayer()\r\n        this.initList()\r\n    }\r\n\r\n    _curAutoIndex = 0\r\n    autoBlessAction() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        let arr = UserData.getInstance().propData\r\n        if (this._curBlessId > 0) {\r\n            if (this._curBlessNum < this.NeedBlessNum) {\r\n                for (let i = this._curAutoIndex + 1; i < arr.length + this._curAutoIndex + 1; i++) {\r\n                    let index = i % arr.length\r\n                    if (arr[index].id == this._curBlessId && arr[index].num - this._curBlessNum > 0) {\r\n                        let curprop = designManager.getRowById(constants.tableName.prop, arr[index].id)\r\n                        if (curprop.quality < 5) {\r\n                            this._curAutoIndex = index\r\n                            this.addSelectProp(arr[index].id, Math.min(arr[index].num - this._curBlessNum, this.NeedBlessNum - this._curBlessNum))\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n\r\n            } else {\r\n                for (let i = this._curAutoIndex + 1; i < arr.length + this._curAutoIndex + 1; i++) {\r\n                    let index = i % arr.length\r\n                    if (arr[index].num >= this.NeedBlessNum) {\r\n                        let curprop = designManager.getRowById(constants.tableName.prop, arr[index].id)\r\n                        if (curprop.quality < 5) {\r\n                            this.clearBlessLayer()\r\n                            this._curAutoIndex = index\r\n                            this.addSelectProp(arr[index].id, this.NeedBlessNum)\r\n                            return\r\n                        }\r\n                    }\r\n                }\r\n            }\r\n        } else {\r\n            for (let i = this._curAutoIndex + 1; i < arr.length + this._curAutoIndex + 1; i++) {\r\n                let index = i % arr.length\r\n                if (arr[index].num >= this.NeedBlessNum) {\r\n                    let curprop = designManager.getRowById(constants.tableName.prop, arr[index].id)\r\n                    if (curprop.quality < 5) {\r\n                        this.clearBlessLayer()\r\n                        this._curAutoIndex = index\r\n                        this.addSelectProp(arr[index].id, this.NeedBlessNum)\r\n                        return\r\n                    }\r\n                }\r\n            }\r\n        }\r\n        this.toast(\"没有可以合成的装备\")\r\n    }\r\n\r\n    closeBless() {\r\n        audioManager.playEffect(\"btnClick\")\r\n        this.closeLayer()\r\n    }\r\n\r\n    onSelectBtnClick() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        this.selectListNode.active = !this.selectListNode.active\r\n        this.setSpriteFrame2(this.selectBtnNode.getChildByName(\"jianxia\"), this.selectListNode.active ? \"heroLayer/jianshang\" : \"heroLayer/jianxia\", null, constants.bundles.wwqVec)\r\n    }\r\n\r\n    _curIndex = 0\r\n    onSelectItemClick(event, data) {\r\n        audioManager.playEffect(\"btnClick\")\r\n        this._curIndex = parseInt(data)\r\n        this.onSelectBtnClick()\r\n        this.initSelectData()\r\n    }\r\n\r\n    initSelectData() {\r\n        let selectcurbg = this.selectBtnNode.getChildByName(\"selectcurbg\")\r\n        if (this._curIndex == 0) {\r\n            selectcurbg.getChildByName(\"propicon\").active = false\r\n            selectcurbg.getChildByName(\"Label\").active = true\r\n        } else {\r\n            selectcurbg.getChildByName(\"propicon\").active = true\r\n            selectcurbg.getChildByName(\"Label\").active = false\r\n            this.setSpriteFrame2(selectcurbg.getChildByName(\"propicon\"), \"heroLayer/propicon\" + this._curIndex, null, constants.bundles.wwqVec)\r\n        }\r\n        this.initList()\r\n    }\r\n\r\n}\r\n\r\n"]}