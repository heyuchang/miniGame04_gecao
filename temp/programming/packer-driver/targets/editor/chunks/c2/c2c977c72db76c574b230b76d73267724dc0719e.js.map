{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/utils/cocosUtil.ts"],"names":["Button","Color","Input","input","instantiate","isValid","Node","Quat","sys","tween","Tween","UIOpacity","UIRenderer","UITransform","v3","Vec3","view","utilTools","String","prototype","parseColor","color","Object","defineProperty","configurable","enumerable","get","op","cocosUtil","addComponentOnce","opacity","set","p","getAroundPos","node","minRadius","maxRadius","isWorld","radius","getFloatValue","radian","Math","random","PI","pos","rotateZ","ZERO","getPosition","add","convertToWorldSpaceWithPos","getRectPos","minWidth","minHeight","maxWidth","maxHeight","arr","r1","x","y","width","height","weight","push","r2","r3","r4","r","getRowByWeight","vec2XAngle","rad","atan2","angle","radianToAngle","vec3CopyVal","outVec3","srcVec3","z","schedule","com","cb","interval","repeatNum","delayTime","isAtOnce","item","name","getComponent","addComponent","getSectorDirectionArr","direction","num","clone","normalize","multiplyScalar","da","floor","angleToRadian","topArr","downArr","i","dir1","dr","dir2","concat","getCircleDirectionArr","p2","startRadian","isInScreenVisible","parent","orignPos","getVisibleOrigin","convertToWorldSpace","getVisibleSize","tf","anchorX","anchorY","tweenScaleOut","time","endCb","to","scale","call","start","tweenHitScale","stopAllByTarget","getScale","tweenScaleShake","quat1","fromEuler","quat2","quat3","rotation","tweenBubbling","setScale","union","repeatForever","waitTimeAsync","Promise","resolve","setTimeout","scheduleOnce","getScreenMidWorldPos","size","nodeChangeParent","convertToNodeSpace","setPosition","tweenUIShow","tweenBounceAction","scaleX","scaleY","easing","delay","tweenShakeNode","position","tweenFallDown","setNodePositionY","tweenTopFadeOut","uiOpacity","by","onUpdate","target","ratio","tweenScaleEffect","tweenFlyToPos","reject","quat","getQuatByAngleZ","t1","t2","setRotation","parallel","tweenTopRightPao","callbck","dx1","dx2","dy1","dy2","ds","tweenScaleIn","tweenScaleIn2","tweenBlink","tweenRotate","tweenUpDown","dy","pos1","pos2","tweenFadeIn","tweenFadeOut","tweenBreath","tweenShake","isRepeat","undefined","tweenRet","isAndroid","platform","Platform","ANDROID","isDesktopBrowser","DESKTOP_BROWSER","isIos","IOS","isWechatGame","WECHAT_GAME","addKeyDownListener","sender","on","EventType","KEY_DOWN","init","designSize","getDesignResolutionSize","frameSize","getFrameSize","safeAreaRect","getSafeAreaRect","safeAreaMarginTop","intiScreenAdapterWidthScale","initScreenBgAdapterWidthScale","fh","fw","adapterWidth","retScale","screenAdapterScale","getScreenAdapterScale","screenBgAdapterScale","getScreenBgAdapterScale","isCenter","transform","convertToWorldSpaceAR","convertToNodeSpaceAR","setRenderableColor","isRecursion","renderable","temp","ch","children","getRenderableColor","getColorByHEX","hex","setButtonEnabled","enabled","btn","formatNum","toFixed","formatNumString","setNodePositionX","drawCurvePath","end","curveness","percent","cp","tweenArr","curx","cury","t","quadraticBezier","abs","sequence","p0","p1","k"],"mappings":"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","sourcesContent":["import { Button, Color, Component, Input, input, instantiate, isValid, Node, Quat, sys, tween, Tween, UIOpacity, UIRenderer, UITransform, v3, Vec2, Vec3, view } from \"cc\";\r\nimport { utilTools } from \"./utilTools\";\r\n\r\n// 拓展String.parseColor方法\r\nString.prototype.parseColor = function () {\r\n    let color = new Color(this);\r\n\r\n    return color;\r\n}\r\n\r\nObject.defineProperty(Node.prototype, \"opacity\", {\r\n    // 表示能否通过delete删除属性从而重新定义属性，能否修改属性的特性，或者能否把属性修改为访问器属性，默认值为false。\r\n    configurable: true,\r\n    // 表示能否通过for in循环访问属性，默认值为false\r\n    enumerable: true,\r\n    // 3.writable：表示能否修改属性的值。默认值为false。\r\n    // 4.value：包含这个属性的数据值。默认值为undefined。\r\n    get() {\r\n        let op = cocosUtil.addComponentOnce(this, UIOpacity);\r\n        return op.opacity;\r\n    },\r\n    set(p: number) {\r\n        let op = cocosUtil.addComponentOnce(this, UIOpacity);\r\n        op.opacity = p;\r\n    }\r\n});\r\n\r\n\r\nexport const cocosUtil = {\r\n\r\n    /**\r\n     * 以node为中心的圆环区域内的随机点\r\n     * @param minRadius 最小半径\r\n     * @param maxRadius 最大半径\r\n     * @param isWorld 是否转为世界坐标，默认：是node坐标系下\r\n     */\r\n    getAroundPos(node: Node, minRadius: number, maxRadius: number, isWorld: boolean = false) {\r\n        let radius = utilTools.getFloatValue(minRadius, maxRadius, true);\r\n        let radian = Math.random() * Math.PI * 2;\r\n        let pos = v3(radius, 0, 0);\r\n        Vec3.rotateZ(pos, pos, Vec3.ZERO, radian);\r\n\r\n        pos = node.getPosition().add(pos);\r\n        if (isWorld) {\r\n            pos = cocosUtil.convertToWorldSpaceWithPos(node, pos);\r\n        }\r\n\r\n        return pos;\r\n    },\r\n\r\n    /**\r\n     * 以node为中心的矩形环区域内的随机点\r\n     * @param node 参考节点\r\n     * @param minWidth 最小宽度\r\n     * @param minHeight 最小高度\r\n     * @param maxWidth 最大宽度\r\n     * @param maxHeight 最大高度\r\n     * @param isWorld 是否转为世界坐标，默认：是node坐标系下\r\n     */\r\n    getRectPos(node: Node, minWidth: number, minHeight: number, maxWidth?: number, maxHeight?: number, isWorld: boolean = false) {\r\n        if (!maxWidth) {\r\n            maxWidth = minWidth + 10;\r\n        }\r\n        if (!maxHeight) {\r\n            maxHeight = minHeight + 10;\r\n        }\r\n        // 分割成4个矩形\r\n        let arr = [];\r\n        // 上\r\n        let r1: any = {};\r\n        r1.x = -maxWidth * 0.5;\r\n        r1.y = minHeight * 0.5;\r\n        r1.width = maxWidth;\r\n        r1.height = (maxHeight - minHeight) * 0.5;\r\n        r1.weight = r1.width * r1.height;\r\n        arr.push(r1);\r\n\r\n        // 下\r\n        let r2: any = {};\r\n        r2.x = r1.x;\r\n        r2.y = -maxHeight * 0.5;\r\n        r2.width = r1.width;\r\n        r2.height = r1.height;\r\n        r2.weight = r1.weight;\r\n        arr.push(r2);\r\n\r\n        // 左\r\n        let r3: any = {};\r\n        r3.x = -maxWidth * 0.5;\r\n        r3.y = -minHeight * 0.5;\r\n        r3.width = (maxWidth - minWidth) * 0.5;\r\n        r3.height = minHeight;\r\n        r3.weight = r3.width * r3.height;\r\n        arr.push(r3);\r\n\r\n        // 右\r\n        let r4: any = {};\r\n        r4.x = minWidth * 0.5;\r\n        r4.y = r3.y;\r\n        r4.width = r3.width;\r\n        r4.height = r3.height;\r\n        r4.weight = r3.weight;\r\n        arr.push(r4);\r\n\r\n        let r = utilTools.getRowByWeight(arr);\r\n        let x = r.x + Math.random() * r.width;\r\n        let y = r.y + Math.random() * r.height;\r\n\r\n        let pos = v3(x, y);\r\n        pos = node.getPosition().add(pos);\r\n        if (isWorld) {\r\n            pos = cocosUtil.convertToWorldSpaceWithPos(node, pos);\r\n        }\r\n\r\n        return pos;\r\n    },\r\n\r\n    /**\r\n     * 得到与x轴正方向的夹角，取值范围：0~360度\r\n     * @param pos \r\n     */\r\n    vec2XAngle(pos: Vec2 | Vec3): number {\r\n        let rad = Math.atan2(pos.y, pos.x);\r\n        if (rad < 0) {\r\n            rad += Math.PI * 2;\r\n        }\r\n        let angle = utilTools.radianToAngle(rad);\r\n\r\n        return angle;\r\n    },\r\n\r\n    vec3CopyVal(outVec3: Vec3, srcVec3: Vec3) {\r\n        outVec3.x = srcVec3.x;\r\n        outVec3.y = srcVec3.y;\r\n        outVec3.z = srcVec3.z;\r\n\r\n        return outVec3;\r\n    },\r\n\r\n    schedule(com: Component, cb: Function, interval: number, repeatNum: number, delayTime: number = 0, isAtOnce: boolean = false) {\r\n        com.schedule(cb, interval, repeatNum, delayTime);\r\n        if (isAtOnce) {\r\n            cb();\r\n        }\r\n    },\r\n\r\n    addComponentOnce(item: Node | Component, name: any): any {\r\n        let com = item.getComponent(name);\r\n        if (!com) {\r\n            com = item.addComponent(name);\r\n        }\r\n        return com;\r\n    },\r\n\r\n    /**\r\n     * 以direction为中间方向，angle为间隔角度，获取num数量的，长度为radius的向量\r\n     * @param direction 基准方向\r\n     * @param angle 角度值\r\n     * @param num 个数，包括基准向量\r\n     * @param radius 向量长度\r\n     */\r\n    getSectorDirectionArr(direction: Vec3, angle: number, num: number, radius: number = 1) {\r\n        direction = direction.clone().normalize().multiplyScalar(radius);\r\n        if (num <= 1) {\r\n            return [direction];\r\n        }\r\n\r\n        let da = Math.floor(num / 2);\r\n        let radian = utilTools.angleToRadian(angle);\r\n        let topArr = [];\r\n        let downArr = [];\r\n        for (let i = da; i >= 1; i--) {\r\n            let dir1 = new Vec3(0, 0, 0);\r\n            let dr = radian * i;\r\n            Vec3.rotateZ(dir1, direction, Vec3.ZERO, dr);\r\n            topArr.push(dir1);\r\n\r\n            let dir2 = new Vec3(0, 0, 0);\r\n            dr = -radian * (da + 1 - i);\r\n            Vec3.rotateZ(dir2, direction, Vec3.ZERO, dr);\r\n            downArr.push(dir2);\r\n        }\r\n\r\n        topArr.push(direction);\r\n        let arr = topArr.concat(downArr);\r\n\r\n        return arr;\r\n    },\r\n\r\n    /**\r\n     * 获取num个围成方向为圆圈的，长度为radius的向量\r\n     * @param pos 圆心点\r\n     * @param num 个数\r\n     * @param radius 向量长度\r\n     */\r\n    getCircleDirectionArr(num: number, radius: number = 1) {\r\n        let r = Math.PI * 2 / num;\r\n        let p2 = v3(radius, 0, 0);\r\n        let arr = [];\r\n        // 随机起始角度\r\n        let startRadian = Math.random() * Math.PI * 2;\r\n        for (let i = 0; i < num; i++) {\r\n            let radian = startRadian + r * i;\r\n            let direction = v3(0, 0, 0)\r\n            direction = Vec3.rotateZ(direction, p2.clone(), Vec3.ZERO, radian);\r\n            arr.push(direction);\r\n        }\r\n\r\n        return arr;\r\n    },\r\n\r\n    isInScreenVisible(node: Node): boolean {\r\n        if (!node || !node.parent) {\r\n            return false;\r\n        }\r\n        let orignPos = view.getVisibleOrigin();\r\n        let pos = cocosUtil.convertToWorldSpace(node);\r\n        let height = view.getVisibleSize().height;\r\n        let width = view.getVisibleSize().width;\r\n        let tf = node.getComponent(UITransform);\r\n        // 考虑锚点\r\n        if (pos.x + (1 - tf.anchorX) * tf.width > orignPos.x\r\n            && pos.x - tf.anchorX * tf.width < width + orignPos.x\r\n            && pos.y + (1 - tf.anchorY) * tf.height > orignPos.y\r\n            && pos.y - tf.anchorY * tf.height < height + orignPos.y) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    tweenScaleOut(node: Node, time: number, endCb: Function) {\r\n        tween(node).to(time, { scale: v3(0, 0, 0) }).call(() => {\r\n            endCb();\r\n        }).start();\r\n    },\r\n\r\n    // 受击缩放特效\r\n    tweenHitScale(node: Node, time: number = 0.1, endCb?: Function) {\r\n        Tween.stopAllByTarget(node);\r\n        let scale = node.getScale();\r\n        tween(node)\r\n            .to(time, { scale: v3(scale.x * 0.95, scale.y * 1.1, 1) })\r\n            .to(time * 2, { scale: v3(scale.x, scale.y * 0.9, 1) })\r\n            .to(time * 2, { scale: v3(scale.x * 0.95, scale.y * 1.1, 1) })\r\n            .to(time, { scale: v3(scale.x, scale.y, 1) })\r\n            .call(() => {\r\n                if (endCb) {\r\n                    endCb();\r\n                }\r\n            })\r\n            .start();\r\n    },\r\n\r\n    tweenScaleShake(node: Node, endCb?: Function) {\r\n        let angle = 10;\r\n        let quat1 = new Quat();\r\n        Quat.fromEuler(quat1, 0, 0, angle);\r\n        let quat2 = new Quat();\r\n        Quat.fromEuler(quat2, 0, 0, -angle);\r\n        let quat3 = new Quat();\r\n        Quat.fromEuler(quat3, 0, 0, 0);\r\n\r\n        tween(node)\r\n            .to(0.3, { scale: v3(1.3, 1.3, 1) })\r\n            .to(0.2, { rotation: quat1 })\r\n            .to(0.4, { rotation: quat2 })\r\n            .to(0.2, { rotation: quat3 })\r\n            .to(0.2, { scale: v3(1, 1, 1) })\r\n            .call(() => {\r\n                if (endCb) {\r\n                    endCb();\r\n                }\r\n            }).start();\r\n    },\r\n\r\n    instantiate(node: any) {\r\n        return instantiate(node);\r\n    },\r\n\r\n    // 快速呼吸效果\r\n    tweenBubbling(node: Node) {\r\n        Tween.stopAllByTarget(node);\r\n        node.setScale(v3(0.4, 0.4, 1));\r\n        tween(node).to(0.5, {\r\n            scale: v3(1, 1, 1)\r\n        }).to(0.5, {\r\n            scale: v3(0.4, 0.4, 1)\r\n        }).union().repeatForever().start();\r\n    },\r\n\r\n    /**\r\n     * 异步等待一段时间后，才会往下执行，不会造成阻塞\r\n     * @param com 组件基类\r\n     * @param time 等待时间，单位：秒\r\n     */\r\n    waitTimeAsync(com: Component | number, time?: number) {\r\n        return new Promise((resolve) => {\r\n            if (typeof (com) == \"number\") {\r\n                setTimeout(() => {\r\n                    resolve();\r\n                }, com * 1000);\r\n            } else {\r\n                com.scheduleOnce(() => {\r\n                    resolve();\r\n                }, time);\r\n            }\r\n        });\r\n    },\r\n\r\n    getScreenMidWorldPos() {\r\n        let size = view.getVisibleSize();\r\n        let pos = v3(size.width * 0.5, size.height * 0.5, 0);\r\n\r\n        return pos;\r\n    },\r\n\r\n    nodeChangeParent(node: Node, parent: Node) {\r\n        if (!this.isValid(node) || !this.isValid(parent)) {\r\n            return;\r\n        }\r\n        let pos = cocosUtil.convertToWorldSpace(node);\r\n        node.parent = parent;\r\n        pos = cocosUtil.convertToNodeSpace(node, pos);\r\n        node.setPosition(pos);\r\n    },\r\n\r\n    tweenUIShow(node: Node) {\r\n        Tween.stopAllByTarget(node);\r\n        let scale = node.getScale();\r\n        node.setScale(v3(0.5, 0.5, 1));\r\n        tween(node).to(0.1, {\r\n            scale: scale\r\n        }).start();\r\n    },\r\n\r\n    // 软弹簧效果\r\n    tweenBounceAction(node: Node) {\r\n        Tween.stopAllByTarget(node);\r\n        let scaleX = node.getScale().x;\r\n        let scaleY = node.getScale().y;\r\n        tween(node)\r\n            .to(0.15, { scale: v3(scaleX * 0.4, scaleY * 1.2, 1) }, { easing: 'bounceInOut' })\r\n            .to(0.15, { scale: v3(scaleX * 1.4, scaleY * 0.8, 1) }, { easing: 'bounceInOut' })\r\n            .to(0.2, { scale: v3(scaleX, scaleY, 1) }, { easing: 'smooth' })\r\n            .delay(0.7)\r\n            .union()\r\n            .repeatForever()\r\n            .start();\r\n    },\r\n\r\n    // 节点抖动\r\n    tweenShakeNode(node: Node) {\r\n        let time = 0.1;\r\n        tween(node)\r\n            .to(time, { position: v3(5, -5) })\r\n            .to(time, { position: v3(-5, 5) })\r\n            .to(time, { position: v3(5, 5) })\r\n            .to(time, { position: v3(-5, -5) })\r\n            .to(time, { position: v3(0, 0) })\r\n            .start();\r\n    },\r\n\r\n    // 往下掉落的效果\r\n    tweenFallDown(node: Node, endCb?: Function) {\r\n        node.setScale(0.5, 0.5, 1);\r\n        let pos = node.getPosition();\r\n        cocosUtil.setNodePositionY(node, pos.y + 100);\r\n        tween(node).to(0.3, {\r\n            position: pos\r\n        }).to(0.2, {\r\n            scale: v3(1, 1, 1)\r\n        }).call(() => {\r\n            if (endCb) {\r\n                endCb();\r\n            }\r\n        }).start();\r\n    },\r\n\r\n    // 显现后，往上移动并慢慢隐去\r\n    tweenTopFadeOut(node: Node, endCb?: Function) {\r\n        let uiOpacity = node.getComponent(UIOpacity);\r\n        if (!uiOpacity) {\r\n            uiOpacity = node.addComponent(UIOpacity);\r\n        }\r\n        uiOpacity.opacity = 255;\r\n        node.setScale(1, 1, 1);\r\n        tween(node)\r\n            .to(0.05, {\r\n                scale: v3(1.2, 1.2, 1)\r\n            })\r\n            .to(0.1, {\r\n                scale: v3(1, 1, 1)\r\n            })\r\n            .by(0.5, {\r\n                position: v3(0, 40)\r\n            })\r\n            .by(1, {\r\n                position: v3(0, 0)\r\n            }, {\r\n                onUpdate(target: Node, ratio: number) {\r\n                    uiOpacity.opacity = (1 - ratio) * 255;\r\n                }\r\n            }).union().call(() => {\r\n                if (endCb) {\r\n                    endCb();\r\n                }\r\n            }).start();\r\n    },\r\n\r\n    // 放大再缩小的一个效果\r\n    tweenScaleEffect(node: Node, time?: number, endCb?: Function) {\r\n        if (!time) {\r\n            time = 0.2;\r\n        }\r\n        node.setScale(1, 1, 1);\r\n        tween(node).to(time, {\r\n            scale: v3(1.5, 1.5, 1)\r\n        }).to(time, {\r\n            scale: v3(1, 1, 1)\r\n        }).call(() => {\r\n            if (endCb) {\r\n                endCb();\r\n            }\r\n        }).start();\r\n    },\r\n\r\n    // 边旋转，边飞向目标位置\r\n    async tweenFlyToPos(node: Node, pos: Vec3, endCb?: Function) {\r\n        Tween.stopAllByTarget(node);\r\n\r\n        return new Promise((resolve, reject) => {\r\n            let time = 0.5;\r\n\r\n            let angle = 360;\r\n            let quat = cocosUtil.getQuatByAngleZ(angle);\r\n\r\n            let t1 = tween(node).to(time, {\r\n                position: pos\r\n            });\r\n\r\n            let t2 = tween(node).by(time, {\r\n                rotation: quat\r\n            }, {\r\n                easing: \"quadOut\",\r\n                onUpdate(target: Node, ratio: number) {\r\n                    node.setRotation(cocosUtil.getQuatByAngleZ(angle * ratio));\r\n                }\r\n            });\r\n\r\n            tween(node).parallel(t1, t2).call(() => {\r\n                node.setRotation(cocosUtil.getQuatByAngleZ(0));\r\n                resolve();\r\n                if (endCb) {\r\n                    endCb();\r\n                }\r\n            }).start();\r\n        });\r\n    },\r\n\r\n    // 往右上方做类似抛物线运动\r\n    tweenTopRightPao(node: Node, callbck?: Function) {\r\n        let dx1 = 40;\r\n        let dx2 = 40;\r\n        let dy1 = 100;\r\n        let dy2 = -80;\r\n        dx1 += Math.random() * 20;\r\n        node.setScale(v3(1, 1, 1));\r\n        tween(node)\r\n            .by(0.3, {\r\n                position: v3(dx1, dy1)\r\n            }, {\r\n                easing: \"quadOut\", onUpdate: (target: Node, ratio: number) => {\r\n                    let ds = 0.5 * ratio;\r\n                    node.setScale(v3(1 + ds, 1 + ds, 1));\r\n                }\r\n            })\r\n            .by(0.3, {\r\n                position: v3(dx2, dy2)\r\n            }, {\r\n                easing: \"quadIn\", onUpdate: (target: Node, ratio: number) => {\r\n                    let ds = 0.5 * ratio;\r\n                    node.setScale(v3(1.5 - ds, 1.5 - ds, 1));\r\n                }\r\n            })\r\n            .union()\r\n            .call(() => {\r\n                if (callbck) {\r\n                    callbck();\r\n                }\r\n            }).start();\r\n    },\r\n\r\n    // 从小到放大\r\n    tweenScaleIn(node: Node, time?: number, endCb?: Function) {\r\n        if (!time) {\r\n            time = 0.2;\r\n        }\r\n        node.setScale(0, 0, 1);\r\n        tween(node).to(time, {\r\n            scale: v3(1, 1, 1)\r\n        }).call(() => {\r\n            if (endCb) {\r\n                endCb();\r\n            }\r\n        }).start();\r\n    },\r\n\r\n    // 从小到放大，再恢复到原始大小\r\n    tweenScaleIn2(node: Node, time?: number, endCb?: Function) {\r\n        if (!time) {\r\n            time = 0.2;\r\n        }\r\n        node.setScale(0, 0, 1);\r\n        tween(node).to(time, {\r\n            scale: v3(1.3, 1.3, 1)\r\n        }).to(time / 2, {\r\n            scale: v3(1, 1, 1)\r\n        }).union().call(() => {\r\n            if (endCb) {\r\n                endCb();\r\n            }\r\n        }).start();\r\n    },\r\n\r\n    // 闪烁动画\r\n    tweenBlink(node: Node, time?: number, cb?: Function) {\r\n        if (!time) {\r\n            time = 0.5;\r\n        }\r\n        let uiOpacity = this.addComponentOnce(node, UIOpacity);\r\n        uiOpacity.opacity = 255;\r\n        tween(uiOpacity).to(time, {\r\n            opacity: 80\r\n        }).to(time, {\r\n            opacity: 255\r\n        }).call(() => {\r\n            if (cb) {\r\n                cb();\r\n            }\r\n        }).union().repeatForever().start();\r\n    },\r\n\r\n    // 循环旋转动画\r\n    tweenRotate(node: Node, time?: number) {\r\n        if (!time) {\r\n            time = 2;\r\n        }\r\n        let angle = 360;\r\n        let quat = cocosUtil.getQuatByAngleZ(angle);\r\n        tween(node).by(time, { rotation: quat }, {\r\n            easing: \"linear\",\r\n            onUpdate: (target: Node, ratio: number) => {\r\n                let da = angle * ratio;\r\n                target.setRotation(cocosUtil.getQuatByAngleZ(da));\r\n            }\r\n        }).repeatForever().start();\r\n    },\r\n\r\n    // 上下漂浮\r\n    tweenUpDown(node: Node, dy?: number, time?: number) {\r\n        if (!dy) {\r\n            dy = 6;\r\n        }\r\n        if (!time) {\r\n            time = 1.5;\r\n        }\r\n        let pos1 = node.getPosition();\r\n        pos1.y += dy;\r\n        let pos2 = node.getPosition();\r\n        tween(node).to(time, {\r\n            position: pos1\r\n        }).to(time, {\r\n            position: pos2\r\n        }).union().repeatForever().start();\r\n    },\r\n\r\n    // 淡入动画\r\n    async tweenFadeIn(node: Node, time?: number, cb?: Function) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!time) {\r\n                time = 1;\r\n            }\r\n            let uiOpacity = this.addComponentOnce(node, UIOpacity);\r\n            uiOpacity.opacity = 0;\r\n            tween(uiOpacity).to(time, {\r\n                opacity: 255\r\n            }).call(() => {\r\n                resolve();\r\n                if (cb) {\r\n                    cb();\r\n                }\r\n            }).start();\r\n        });\r\n    },\r\n\r\n    // 淡出动画\r\n    async tweenFadeOut(node: Node, time?: number, cb?: Function) {\r\n        return new Promise((resolve, reject) => {\r\n            if (!time) {\r\n                time = 1.5;\r\n            }\r\n            let uiOpacity = this.addComponentOnce(node, UIOpacity);\r\n            uiOpacity.opacity = 255;\r\n            tween(uiOpacity).to(time, {\r\n                opacity: 0\r\n            }).call(() => {\r\n                resolve();\r\n                if (cb) {\r\n                    cb();\r\n                }\r\n            }).start();\r\n        });\r\n    },\r\n\r\n    /**\r\n     * 放大缩小呼吸效果\r\n     * @param node 节点\r\n     * @param time 缩放时长，单位：秒\r\n     * @param scale 缩放大小\r\n     */\r\n    tweenBreath(node: Node, time?: number, scale?: number) {\r\n        if (!time) {\r\n            time = 0.4;\r\n        }\r\n        if (!scale) {\r\n            scale = 1.2;\r\n        }\r\n\r\n        tween(node)\r\n            .to(\r\n                time, {\r\n                scale: v3(scale, scale, 1)\r\n            })\r\n            .to(\r\n                time, {\r\n                scale: v3(1, 1, 1)\r\n            }\r\n            ).union().repeatForever().start();\r\n    },\r\n\r\n    /**\r\n     * 间接性晃动效果\r\n     * @param node 节点\r\n     * @param time 时长，单位：秒\r\n     * @param rotation 旋转角度，单位：度数\r\n     * @param delayTime 中间暂停时长，单位：秒\r\n     * @param isRepeat 是否循环播放，默认：是\r\n     */\r\n    tweenShake(node: Node, time?: number, rotation?: number, delayTime?: number, isRepeat?: boolean) {\r\n        Tween.stopAllByTarget(node);\r\n\r\n        if (!time) {\r\n            time = 0.2;\r\n        }\r\n        if (!rotation) {\r\n            rotation = 6;\r\n        }\r\n        if (delayTime == undefined) {\r\n            delayTime = time * 5;\r\n        }\r\n\r\n        let quat1: Quat = new Quat();\r\n        Quat.fromEuler(quat1, 0, 0, rotation);\r\n\r\n        let quat2: Quat = new Quat();\r\n        Quat.fromEuler(quat2, 0, 0, -rotation);\r\n\r\n        let quat3: Quat = new Quat();\r\n        Quat.fromEuler(quat3, 0, 0, 0);\r\n\r\n        let tweenRet = tween(node).to(time, {\r\n            rotation: quat1\r\n        }).to(time * 2, {\r\n            rotation: quat2\r\n        }).to(time, {\r\n            rotation: quat3\r\n        });\r\n\r\n        if (isRepeat == undefined) {\r\n            tweenRet.delay(delayTime).union().repeatForever().start();\r\n        } else {\r\n            tweenRet.start();\r\n        }\r\n\r\n    },\r\n\r\n    /**\r\n     * 判断节点或者组件是否可用\r\n     * @param node 节点对象 \r\n     */\r\n    isValid(node: Node | Component) {\r\n        if (!node || !isValid(node)) {\r\n            return false;\r\n        }\r\n        return true;\r\n    },\r\n\r\n    isAndroid() {\r\n        return sys.platform === sys.Platform.ANDROID;\r\n    },\r\n\r\n    isDesktopBrowser() {\r\n        return sys.platform === sys.Platform.DESKTOP_BROWSER;\r\n    },\r\n\r\n    isIos() {\r\n        return sys.platform === sys.Platform.IOS;\r\n    },\r\n\r\n    isWechatGame() {\r\n        return sys.platform === sys.Platform.WECHAT_GAME;\r\n    },\r\n\r\n    addKeyDownListener(cb, sender) {\r\n        input.on(Input.EventType.KEY_DOWN, cb, sender);\r\n    },\r\n\r\n    init() {\r\n        // 设计分辨率\r\n        this.designSize = view.getDesignResolutionSize();\r\n        // 实际屏幕分辨率\r\n        this.frameSize = view.getFrameSize();\r\n        // 实际屏幕安全区域，{x: 0, y: 0, width: 766.6256157635468, height: 1660}\r\n        // 是以左下角为原点，以设计分辨率为单位的，并且是遵循高度为适配原则后的尺寸\r\n        this.safeAreaRect = sys.getSafeAreaRect();\r\n\r\n        // 计算出顶部刘海屏高度\r\n        this.safeAreaMarginTop = this.designSize.height - this.safeAreaRect.height;\r\n        if (this.safeAreaMarginTop < 0) {\r\n            this.safeAreaMarginTop = 0;\r\n        }\r\n\r\n        this.intiScreenAdapterWidthScale();\r\n        this.initScreenBgAdapterWidthScale();\r\n    },\r\n\r\n\r\n    // UI适配，以高度为适配原则，按照满宽度显示计算，如果宽度不够显示，要乘以这个缩放比例\r\n    intiScreenAdapterWidthScale() {\r\n        let fh = this.frameSize.height;\r\n        let fw = this.frameSize.width;\r\n\r\n        let scale = fh / this.designSize.height;\r\n        let adapterWidth = this.designSize.width * scale;\r\n        let retScale = 1;\r\n        if (adapterWidth > fw) {\r\n            // 屏幕不够显示，有些交互UI会丢失，要进行缩小\r\n            retScale = fw / adapterWidth;\r\n        }\r\n\r\n        // if (this.safeAreaMarginTop > 0) {\r\n        //     // cocos内部以高度为适配策略，但是如果有刘海屏，要额外再缩放一点\r\n        //     let subScale = this.safeAreaMarginTop / this.designSize.height;\r\n        //     retScale -= subScale;\r\n        // }\r\n\r\n        this.screenAdapterScale = retScale;\r\n    },\r\n    getScreenAdapterScale() {\r\n        if (!this.screenAdapterScale) {\r\n            this.screenAdapterScale = 1;\r\n        }\r\n        return this.screenAdapterScale;\r\n    },\r\n\r\n    // 背景图适配，跟上面的UI适配，刚好相反，超出的屏幕不管，屏幕没显示满，要放大\r\n    initScreenBgAdapterWidthScale() {\r\n        let fh = this.frameSize.height;\r\n        let fw = this.frameSize.width;\r\n        let scale = fh / this.designSize.height;\r\n        let adapterWidth = this.designSize.width * scale;\r\n        let retScale = 1;\r\n        if (adapterWidth < fw) {\r\n            // 屏幕没显示满，会有黑边，要进行放大\r\n            retScale = fw / adapterWidth;\r\n        }\r\n\r\n        // if (this.safeAreaMarginTop > 0) {\r\n        //     // 额外增加放大值，使得背景图铺满包括刘海在内的整个屏幕\r\n        //     let addScale = this.safeAreaMarginTop / this.designSize.height;\r\n        //     retScale += addScale;\r\n        // }\r\n\r\n        this.screenBgAdapterScale = retScale;\r\n    },\r\n    getScreenBgAdapterScale() {\r\n        if (!this.screenBgAdapterScale) {\r\n            this.screenBgAdapterScale = 1;\r\n        }\r\n        return this.screenBgAdapterScale;\r\n    },\r\n\r\n    /**\r\n     * 将node坐标转换为世界坐标\r\n     * @param node \r\n     * @param isCenter 是否强制是node的中心点坐标\r\n     */\r\n    convertToWorldSpace(node: Node, isCenter?: boolean): Vec3 {\r\n        let transform = node.parent.getComponent(UITransform);\r\n\r\n        let pos = node.getPosition();\r\n        if (isCenter) {\r\n            let tf = node.getComponent(UITransform);\r\n            pos.x = pos.x + (0.5 - tf.anchorX) * tf.width;\r\n            pos.y = pos.y + (0.5 - tf.anchorY) * tf.height;\r\n        }\r\n\r\n        return transform.convertToWorldSpaceAR(pos);\r\n    },\r\n\r\n    convertToWorldSpaceWithPos(node: Node, pos: Vec3): Vec3 {\r\n        let transform = node.parent.getComponent(UITransform);\r\n        pos = transform.convertToWorldSpaceAR(pos);\r\n\r\n        return pos;\r\n    },\r\n\r\n    /**\r\n     * 获得以node父节点锚点位置为原点的坐标系下的坐标\r\n     * @param node 注意，是同坐标系下的节点\r\n     * @param pos 世界坐标\r\n     */\r\n    convertToNodeSpace(node: Node, pos: Vec3): Vec3 {\r\n        let transform = node.parent.getComponent(UITransform);\r\n\r\n        return transform.convertToNodeSpaceAR(pos);\r\n    },\r\n\r\n    /**\r\n     * 设置渲染节点的颜色叠加\r\n     * @param node 节点\r\n     * @param color 颜色\r\n     * @param isRecursion 是否递归子节点也设置 \r\n     */\r\n    setRenderableColor(node: Node, color: string | Color, isRecursion?: boolean) {\r\n        let renderable = node.getComponent(UIRenderer);\r\n        if (renderable && renderable.color) {\r\n            let temp: Color = null;\r\n            if (typeof (color) == \"string\") {\r\n                temp = color.parseColor();\r\n            } else {\r\n                temp = color;\r\n            }\r\n            renderable.color = temp;\r\n        }\r\n\r\n        if (isRecursion) {\r\n            for (let ch of node.children) {\r\n                this.setRenderableColor(ch, color, isRecursion);\r\n            }\r\n        }\r\n    },\r\n\r\n    getRenderableColor(node: Node): Color {\r\n        let renderable = node.getComponent(UIRenderer);\r\n        if (renderable && renderable.color) {\r\n            return renderable.color.clone();\r\n        }\r\n        return null;\r\n    },\r\n\r\n    /**\r\n     * 根据十六进制颜色值，获得color对象\r\n     * @param hex \"#333333\"\r\n     */\r\n    getColorByHEX(hex: string): Color {\r\n        let color = new Color(hex);\r\n        // Color.fromHEX(color, hex);\r\n        return color;\r\n    },\r\n\r\n    /**\r\n     * 设置按钮可用状态\r\n     * @param node 按钮对象\r\n     * @param enabled 是否可点击\r\n     */\r\n    setButtonEnabled(node: Node, enabled: boolean) {\r\n        let btn = node.getComponent(Button);\r\n        if (btn) {\r\n            btn.enabled = enabled;\r\n        }\r\n    },\r\n\r\n    getQuatByAngleZ(angle: number) {\r\n        let quat = new Quat();\r\n        Quat.fromEuler(quat, 0, 0, angle);\r\n\r\n        return quat;\r\n    },\r\n\r\n    formatNum(num: number) {\r\n        if (num < 10000) {\r\n            return num;\r\n        }\r\n        if (num < 1000000) {\r\n            num = Math.floor(num / 1000 * 100);\r\n            return (num / 100).toFixed(2) + \"K\";\r\n        }\r\n\r\n        num = Math.floor(num / 1000000 * 100);\r\n        return (num / 100).toFixed(2) + \"M\";\r\n    },\r\n\r\n    formatNumString(num: number) {\r\n        if (num < 1000) {\r\n            return num;\r\n        }\r\n        if (num < 10000) {\r\n            num = Math.floor(num / 1000 * 10);\r\n            return (num / 10).toFixed(1) + \"K\";\r\n        }\r\n\r\n        if (num < 10000000) {\r\n            num = Math.floor(num / 10000 * 10);\r\n            return (num / 10).toFixed(1) + \"w\";\r\n        }\r\n\r\n        num = Math.floor(num / 1000000 * 100);\r\n        return (num / 100).toFixed(2) + \"M\";\r\n    },\r\n\r\n\r\n    setNodePositionX(node: Node, x: number) {\r\n        let pos = node.getPosition();\r\n        pos.x = x;\r\n        node.setPosition(pos);\r\n    },\r\n\r\n    setNodePositionY(node: Node, y: number) {\r\n        let pos = node.getPosition();\r\n        pos.y = y;\r\n        node.setPosition(pos);\r\n    },\r\n\r\n    /**\r\n     * 绘制一条曲线路径\r\n     * @param  {Object} node canvas渲染上下文\r\n     * @param  {Array<number>} start 起点\r\n     * @param  {Array<number>} end 终点\r\n     * @param  {number} curveness 曲度(0-1)\r\n     * @param  {number} percent 绘制百分比(0-100)\r\n     */\r\n    drawCurvePath(node, start, end, curveness, percent, delay = 0) {\r\n\r\n        var cp = [\r\n            (start[0] + end[0]) / 2 - (start[1] - end[1]) * curveness,\r\n            (start[1] + end[1]) / 2 - (end[0] - start[0]) * curveness\r\n        ];\r\n\r\n        // node.position = v3(start[0], start[1], 0);\r\n        let tweenArr = []\r\n        tweenArr.push(tween(node).delay(delay))\r\n        let curx = start[0]\r\n        let cury = start[1]\r\n        for (var t = 0; t <= percent / 100; t += 0.01) {\r\n\r\n            var x = this.quadraticBezier(start[0], cp[0], end[0], t);\r\n            var y = this.quadraticBezier(start[1], cp[1], end[1], t);\r\n            let time = (Math.abs(x - curx) + Math.abs(y - cury)) / 1500\r\n            tweenArr.push(tween(node).to(time, { position: v3(x, y, 0) }))\r\n\r\n            curx = x\r\n            cury = y\r\n        }\r\n        let time = (Math.abs(end[0] - curx) + Math.abs(end[1] - cury)) / 1500\r\n\r\n        tweenArr.push(tween(node).to(time, { position: v3(end[0], end[1], 0) }))\r\n\r\n        tween(node).sequence(...tweenArr).start();\r\n    },\r\n\r\n    quadraticBezier(p0, p1, p2, t) {\r\n        var k = 1 - t;\r\n        return k * k * p0 + 2 * (1 - t) * t * p1 + t * t * p2;    // 这个方程就是二次贝赛尔曲线方程\r\n    }\r\n}\r\n\r\n"]}