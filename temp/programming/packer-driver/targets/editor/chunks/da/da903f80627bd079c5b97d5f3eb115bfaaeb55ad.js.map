{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/skill/Skill3.ts"],"names":["Component","_decorator","cocosUtil","audioManager","mapModel","physicsGroup","ccclass","property","Skill3","skill","num","timeCount","init","subNum","updateLogic","dt","row","getAtkCd","targetNode","mapSystem","getMinDisTargetNode","direction","getPosition","subtract","player","node","bulletSystem","addBullet","bulletId","PLAYER_BULLET","convertToWorldSpace","playEffect","audio"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,U,OAAAA,U;;AACXC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U,GAE9B;;wBAEaO,M,WADZF,OAAO,CAAC,QAAD,C,gBAAR,MACaE,MADb,SAC4BR,SAD5B,CACsC;AAAA;AAAA;AAAA,eAElCS,KAFkC;AAAA,eAIlCC,GAJkC,GAIpB,CAJoB;AAAA,eAKlCC,SALkC,GAKd,CALc;AAAA;;AAOlCC,QAAAA,IAAI,CAACH,KAAD,EAAe;AACf,eAAKA,KAAL,GAAaA,KAAb;AAEH;;AAEDI,QAAAA,MAAM,GAAG;AACL,eAAKH,GAAL;AACH;;AAEDI,QAAAA,WAAW,CAACC,EAAD,EAAa;AACpB,eAAKJ,SAAL,IAAkBI,EAAlB;;AACA,cAAI,KAAKL,GAAL,IAAY,KAAKD,KAAL,CAAWO,GAAX,CAAeN,GAA/B,EAAoC;AAChC;AACA;AACH;;AACD,cAAI,KAAKC,SAAL,GAAiB,KAAKF,KAAL,CAAWQ,QAAX,EAArB,EAA4C;AACxC;AACH;;AACD,cAAIC,UAAU,GAAG;AAAA;AAAA,oCAASC,SAAT,CAAmBC,mBAAnB,EAAjB;;AACA,cAAI,CAACF,UAAL,EAAiB;AACb;AACH;;AAED,eAAKP,SAAL,GAAiB,CAAjB;AACA,eAAKD,GAAL;AAEA,cAAIW,SAAS,GAAGH,UAAU,CAACI,WAAX,GAAyBC,QAAzB,CAAkC;AAAA;AAAA,oCAASC,MAAT,CAAgBC,IAAhB,CAAqBH,WAArB,EAAlC,CAAhB;AACA;AAAA;AAAA,oCAASI,YAAT,CAAsBC,SAAtB,CAAgC,KAAKlB,KAAL,CAAWO,GAAX,CAAeY,QAA/C,EAAyD;AAAA;AAAA,4CAAaC,aAAtE,EACI;AAAA;AAAA,sCAAUC,mBAAV,CAA8B;AAAA;AAAA,oCAASN,MAAT,CAAgBC,IAA9C,CADJ,EACyDJ,SADzD,EACoE,IADpE;AAEA;AAAA;AAAA,4CAAaU,UAAb,CAAwB,KAAKtB,KAAL,CAAWO,GAAX,CAAegB,KAAvC;AACH;;AArCiC,O","sourcesContent":["import { Component, _decorator } from 'cc';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nimport { audioManager } from '../../../manager/audioManager';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { physicsGroup } from '../../../other/physicsGroup';\r\nimport { Skill } from './Skill';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 飞镖\r\n@ccclass('Skill3')\r\nexport class Skill3 extends Component {\r\n\r\n    skill: Skill;\r\n\r\n    num: number = 0;\r\n    timeCount: number = 0;\r\n\r\n    init(skill: Skill) {\r\n        this.skill = skill;\r\n\r\n    }\r\n\r\n    subNum() {\r\n        this.num--;\r\n    }\r\n\r\n    updateLogic(dt: number) {\r\n        this.timeCount += dt;\r\n        if (this.num >= this.skill.row.num) {\r\n            // 数量已达上限\r\n            return;\r\n        }\r\n        if (this.timeCount < this.skill.getAtkCd()) {\r\n            return;\r\n        }\r\n        let targetNode = mapModel.mapSystem.getMinDisTargetNode();\r\n        if (!targetNode) {\r\n            return;\r\n        }\r\n\r\n        this.timeCount = 0;\r\n        this.num++;\r\n\r\n        let direction = targetNode.getPosition().subtract(mapModel.player.node.getPosition());\r\n        mapModel.bulletSystem.addBullet(this.skill.row.bulletId, physicsGroup.PLAYER_BULLET,\r\n            cocosUtil.convertToWorldSpace(mapModel.player.node), direction, this);\r\n        audioManager.playEffect(this.skill.row.audio);\r\n    }\r\n\r\n}\r\n\r\n"]}