{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/skill/Skill.ts"],"names":["Component","_decorator","cocosUtil","constants","designManager","mapModel","ccclass","property","Skill","info","id","row","skillUtil","onLoad","init","unscheduleAllCallbacks","getRowById","tableName","skill","addComponentOnce","type","e","getDuration","duration","skillSystem","getSkill2DurationAddPercent","getAtkCd","cd","getSkill2AtkCdSubPercent","updateLogic","dt","onDestroy"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,U,OAAAA,U;;AACXC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,a,iBAAAA,a;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U;;uBAGjBO,K,WADZF,OAAO,CAAC,OAAD,C,gBAAR,MACaE,KADb,SAC2BR,SAD3B,CACqC;AAAA;AAAA;AAAA,eAEjCS,IAFiC;AAAA,eAGjCC,EAHiC;AAAA,eAIjCC,GAJiC;AAAA,eAMjCC,SANiC;AAAA;;AAQjCC,QAAAA,MAAM,GAAG,CAER;;AAES,cAAJC,IAAI,CAACL,IAAD,EAAY;AAClB,eAAKA,IAAL,GAAYA,IAAZ;AACA,cAAIC,EAAE,GAAGD,IAAI,CAACC,EAAd;AAEA,eAAKA,EAAL,GAAUA,EAAV;AACA,eAAKK,sBAAL;AAEA,cAAIJ,GAAG,GAAG;AAAA;AAAA,8CAAcK,UAAd,CAAyB;AAAA;AAAA,sCAAUC,SAAV,CAAoBC,KAA7C,EAAoDR,EAApD,CAAV;AACA,eAAKC,GAAL,GAAWA,GAAX;;AAEA,cAAI;AACA,gBAAIC,SAAS,GAAG;AAAA;AAAA,wCAAUO,gBAAV,CAA2B,IAA3B,EAAiC,UAAUR,GAAG,CAACS,IAA/C,CAAhB;AACAR,YAAAA,SAAS,CAACG,sBAAV;AACA,iBAAKH,SAAL,GAAiBA,SAAjB,CAHA,CAIA;;AACAA,YAAAA,SAAS,CAACE,IAAV,CAAe,IAAf;AACH,WAND,CAME,OAAOO,CAAP,EAAU,CAEX;AAEJ;;AAEDC,QAAAA,WAAW,GAAG;AACV,cAAIC,QAAQ,GAAG,KAAKZ,GAAL,CAASY,QAAxB;AACAA,UAAAA,QAAQ,GAAGA,QAAQ,IAAI,IAAI;AAAA;AAAA,oCAASC,WAAT,CAAqBC,2BAArB,EAAR,CAAnB;AAEA,iBAAOF,QAAP;AACH;;AAEDG,QAAAA,QAAQ,GAAG;AACP,cAAIC,EAAE,GAAG,KAAKhB,GAAL,CAASgB,EAAlB;AACAA,UAAAA,EAAE,GAAGA,EAAE,IAAI,IAAI;AAAA;AAAA,oCAASH,WAAT,CAAqBI,wBAArB,EAAR,CAAP;AACA,iBAAOD,EAAP;AACH;;AAEDE,QAAAA,WAAW,CAACC,EAAD,EAAa;AACpB,cAAI,KAAKlB,SAAL,IAAkB,KAAKA,SAAL,CAAeiB,WAArC,EAAkD;AAC9C,iBAAKjB,SAAL,CAAeiB,WAAf,CAA2BC,EAA3B;AACH;AACJ;;AAEDC,QAAAA,SAAS,GAAG;AACR,eAAKhB,sBAAL;;AACA,cAAI,KAAKH,SAAT,EAAoB;AAChB,iBAAKA,SAAL,CAAeG,sBAAf;AACH;AACJ;;AA1DgC,O","sourcesContent":["import { Component, _decorator } from 'cc';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nimport { constants } from '../../../data/constants';\r\nimport { designManager } from '../../../manager/designManager';\r\nimport { mapModel } from '../../../model/mapModel';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('Skill')\r\nexport class Skill extends Component {\r\n\r\n    info: any;\r\n    id: any;\r\n    row: any;\r\n\r\n    skillUtil: any;\r\n\r\n    onLoad() {\r\n\r\n    }\r\n\r\n    async init(info: any) {\r\n        this.info = info;\r\n        let id = info.id;\r\n\r\n        this.id = id;\r\n        this.unscheduleAllCallbacks();\r\n\r\n        let row = designManager.getRowById(constants.tableName.skill, id);\r\n        this.row = row;\r\n\r\n        try {\r\n            let skillUtil = cocosUtil.addComponentOnce(this, \"Skill\" + row.type);\r\n            skillUtil.unscheduleAllCallbacks();\r\n            this.skillUtil = skillUtil;\r\n            // @ts-ignore\r\n            skillUtil.init(this);\r\n        } catch (e) {\r\n\r\n        }\r\n\r\n    }\r\n\r\n    getDuration() {\r\n        let duration = this.row.duration;\r\n        duration = duration * (1 + mapModel.skillSystem.getSkill2DurationAddPercent());\r\n\r\n        return duration;\r\n    }\r\n\r\n    getAtkCd() {\r\n        let cd = this.row.cd;\r\n        cd = cd * (1 - mapModel.skillSystem.getSkill2AtkCdSubPercent());\r\n        return cd;\r\n    }\r\n\r\n    updateLogic(dt: number) {\r\n        if (this.skillUtil && this.skillUtil.updateLogic) {\r\n            this.skillUtil.updateLogic(dt);\r\n        }\r\n    }\r\n\r\n    onDestroy() {\r\n        this.unscheduleAllCallbacks();\r\n        if (this.skillUtil) {\r\n            this.skillUtil.unscheduleAllCallbacks();\r\n        }\r\n    }\r\n}\r\n\r\n"]}