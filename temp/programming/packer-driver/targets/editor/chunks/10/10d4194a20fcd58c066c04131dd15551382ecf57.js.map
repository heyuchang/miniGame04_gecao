{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/network/http.ts"],"names":["Http","xhr","getInstance","_instance","httpPost","url","params","callback","failCb","XMLHttpRequest","onreadystatechange","readyState","status","respone","responseText","rsp","JSON","parse","open","timeout","send","stringify","onerror","err","console","log"],"mappings":";;;iBACqBA,I;;;;;;;;;;;;;yBAAAA,I,GAAN,MAAMA,IAAN,CAAW;AAAA;AAAA,eAClBC,GADkB,GACI,IADJ;AAAA;;AAOA,eAAXC,WAAW,GAAS;AACjC,cAAI,CAAC,KAAKC,SAAV,EAAqB;AACpB,iBAAKA,SAAL,GAAiB,IAAIH,IAAJ,EAAjB;AACA;;AACD,iBAAO,KAAKG,SAAZ;AACA;AAED;AACD;AACA;AACA;AACA;AACA;;;AACCC,QAAAA,QAAQ,CAACC,GAAD,EAAcC,MAAd,EAA2BC,QAA3B,EAA+CC,MAA/C,EAAkE;AACzE;AACA,cAAIP,GAAG,GAAG,IAAIQ,cAAJ,EAAV;;AACAR,UAAAA,GAAG,CAACS,kBAAJ,GAAyB,YAAY;AACpC;AACA,gBAAIT,GAAG,CAACU,UAAJ,KAAmB,CAAnB,IAAyBV,GAAG,CAACW,MAAJ,IAAc,GAAd,IAAqBX,GAAG,CAACW,MAAJ,GAAa,GAA/D,EAAqE;AACpE,kBAAIC,OAAO,GAAGZ,GAAG,CAACa,YAAlB;AACA,kBAAIC,GAAG,GAAGC,IAAI,CAACC,KAAL,CAAWJ,OAAX,CAAV,CAFoE,CAGpE;;AACAN,cAAAA,QAAQ,CAACQ,GAAD,CAAR;AACA,aALD,MAKO;AACNR,cAAAA,QAAQ,CAAC,CAAC,CAAF,CAAR;AACA;AACD,WAVD;;AAWAN,UAAAA,GAAG,CAACiB,IAAJ,CAAS,MAAT,EAAiBb,GAAjB,EAAsB,IAAtB,EAdyE,CAezE;AACA;AACA;AACA;AACA;AACA;AACA;AAEA;AACA;;AACAJ,UAAAA,GAAG,CAACkB,OAAJ,GAAc,IAAd,CAzByE,CAyBtD;;AACnBlB,UAAAA,GAAG,CAACmB,IAAJ,CAASJ,IAAI,CAACK,SAAL,CAAef,MAAf,CAAT;;AAEAL,UAAAA,GAAG,CAACqB,OAAJ,GAAeC,GAAD,IAAS;AACtBC,YAAAA,OAAO,CAACC,GAAR,CAAYF,GAAZ;;AACA,gBAAIf,MAAJ,EAAY;AACXA,cAAAA,MAAM,CAACe,GAAD,CAAN;AACA;AACD,WALD;AAOA;;AAvDwB,O;;AAALvB,MAAAA,I,CAKLG,S","sourcesContent":["\r\nexport default class Http {\r\n\tpublic xhr: XMLHttpRequest = null!;\r\n\t/**\r\n\t * 单例\r\n\t */\r\n\tprivate static _instance: Http;\r\n\r\n\tpublic static getInstance(): Http {\r\n\t\tif (!this._instance) {\r\n\t\t\tthis._instance = new Http();\r\n\t\t}\r\n\t\treturn this._instance;\r\n\t}\r\n\r\n\t/**\r\n\t * post请求\r\n\t * @param {string} url\r\n\t * @param {object} params\r\n\t * @param {function} callback\r\n\t */\r\n\thttpPost(url: string, params: any, callback: Function, failCb?: Function) {\r\n\t\t// cc.myGame.gameUi.onShowLockScreen();\r\n\t\tlet xhr = new XMLHttpRequest();\r\n\t\txhr.onreadystatechange = function () {\r\n\t\t\t// cc.log('xhr.readyState=' + xhr.readyState + '  xhr.status=' + xhr.status);\r\n\t\t\tif (xhr.readyState === 4 && (xhr.status >= 200 && xhr.status < 300)) {\r\n\t\t\t\tlet respone = xhr.responseText;\r\n\t\t\t\tlet rsp = JSON.parse(respone);\r\n\t\t\t\t// cc.myGame.gameUi.onHideLockScreen();\r\n\t\t\t\tcallback(rsp);\r\n\t\t\t} else {\r\n\t\t\t\tcallback(-1);\r\n\t\t\t}\r\n\t\t};\r\n\t\txhr.open('POST', url, true);\r\n\t\t// if (cc.sys.isNative) {\r\n\t\t// xhr.setRequestHeader('Access-Control-Allow-Origin', '*');\r\n\t\t// xhr.setRequestHeader('Access-Control-Allow-Methods', 'GET, POST');\r\n\t\t// xhr.setRequestHeader('Access-Control-Allow-Headers', 'x-requested-with,content-type');\r\n\t\t// xhr.setRequestHeader(\"Content-Type\", \"application/json\");\r\n\t\t// xhr.setRequestHeader('Authorization', 'Bearer ' + cc.myGame.gameManager.getToken());\r\n\t\t// }\r\n\r\n\t\t// note: In Internet Explorer, the timeout property may be set only after calling the open()\r\n\t\t// method and before calling the send() method.\r\n\t\txhr.timeout = 8000;// 8 seconds for timeout\r\n\t\txhr.send(JSON.stringify(params));\r\n\r\n\t\txhr.onerror = (err) => {\r\n\t\t\tconsole.log(err);\r\n\t\t\tif (failCb) {\r\n\t\t\t\tfailCb(err);\r\n\t\t\t}\r\n\t\t};\r\n\r\n\t}\r\n\r\n}\r\n"]}