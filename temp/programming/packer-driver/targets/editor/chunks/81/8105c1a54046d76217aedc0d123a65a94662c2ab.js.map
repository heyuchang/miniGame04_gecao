{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/bullet/Bullet1021.ts"],"names":["Component","tween","v3","Vec3","_decorator","mapModel","cocosUtil","ccclass","property","bullet1021","bullet","contactNotHide","outVec3","direction","speed","Math","PI","init","extraObj","scale","getScale","node","setScale","by","angle","repeatForever","start","show","endCb","skillSystem","getSkill2RangeAddScale","hide","isAtOnce","recycleSelf","tweenScaleOut","active","to","update","dt","radian","rotateZ","ZERO","playerPos","player","position","clone","add"],"mappings":"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","sourcesContent":["import { Component, tween, v3, Vec3, _decorator } from 'cc';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { Bullet } from './Bullet';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 技能-转盘\r\n@ccclass('bullet1021')\r\nexport class bullet1021 extends Component {\r\n\r\n    bullet: Bullet;\r\n    contactNotHide: boolean = true;\r\n\r\n    outVec3: Vec3 = v3(0, 0, 0);\r\n\r\n    direction: Vec3;\r\n\r\n    // 转速\r\n    speed: number = -Math.PI * 1.5;\r\n\r\n    init(bullet: Bullet) {\r\n        this.bullet = bullet;\r\n\r\n        let direction = this.bullet.extraObj.direction;\r\n        this.direction = direction;\r\n\r\n        let scale = this.getScale();\r\n        this.node.setScale(v3(scale, scale, 1));\r\n        tween(this.node).by(0.6, { angle: -360 }).repeatForever().start();\r\n\r\n        this.show();\r\n\r\n        this.bullet.extraObj.endCb(this.bullet);\r\n    }\r\n\r\n    getScale() {\r\n        let scale = 1 + mapModel.skillSystem.getSkill2RangeAddScale();\r\n        return scale;\r\n    }\r\n\r\n    hide(isAtOnce: boolean = false) {\r\n        if (isAtOnce) {\r\n            this.bullet.recycleSelf();\r\n            return;\r\n        }\r\n        cocosUtil.tweenScaleOut(this.node, 0.5, () => {\r\n            this.bullet.recycleSelf();\r\n        });\r\n    }\r\n\r\n    show() {\r\n        let scale = this.getScale();\r\n        this.node.setScale(v3(0, 0, 0));\r\n        this.node.active = true;\r\n        tween(this.node).to(0.5, { scale: v3(scale, scale, 1) }).start();\r\n    }\r\n\r\n    update(dt: number) {\r\n        // 围绕玩家进行旋转\r\n        let radian = this.speed * dt;\r\n        Vec3.rotateZ(this.direction, this.direction, Vec3.ZERO, radian);\r\n        let playerPos = mapModel.player.node.position.clone();\r\n        playerPos.add(this.direction);\r\n        this.node.position = playerPos;\r\n    }\r\n}\r\n\r\n"]}