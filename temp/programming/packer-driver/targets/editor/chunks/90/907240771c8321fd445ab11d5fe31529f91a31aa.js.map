{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/bullet/Bullet8.ts"],"names":["BoxCollider2D","Component","find","UITransform","Vec2","_decorator","utilTools","mapModel","ccclass","property","bullet8","bullet","contactNotHide","moveStop","bodyNode","heightWidthRatio","maxFollowDis","init","node","updateAngleAndDis","scheduleOnce","recycleSelf","direction","getFacePlayerDirection","angle","radianToAngle","Math","atan2","y","x","dis","distance","getPosition","player","getComponent","width","height","offset","update","dt"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,a,OAAAA,a;AAAeC,MAAAA,S,OAAAA,S;AAAWC,MAAAA,I,OAAAA,I;AAAYC,MAAAA,W,OAAAA,W;AAAaC,MAAAA,I,OAAAA,I;AAAMC,MAAAA,U,OAAAA,U;;AACzDC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBJ,U,GAE9B;;yBAEaK,O,WADZF,OAAO,CAAC,SAAD,C,gBAAR,MACaE,OADb,SAC6BT,SAD7B,CACuC;AAAA;AAAA;AAAA,eAEnCU,MAFmC;AAAA,eAGnCC,cAHmC,GAGT,IAHS;AAAA,eAInCC,QAJmC,GAIf,KAJe;AAAA,eAMnCC,QANmC;AAAA,eAOnCC,gBAPmC,GAOR,MAAM,GAPE;AAAA,eAUnCC,YAVmC,GAUZ,GAVY;AAAA;;AAYnCC,QAAAA,IAAI,CAACN,MAAD,EAAiB;AACjB,eAAKA,MAAL,GAAcA,MAAd;AACA,eAAKE,QAAL,GAAgB,IAAhB;AAEA,eAAKC,QAAL,GAAgBZ,IAAI,CAAC,MAAD,EAAS,KAAKS,MAAL,CAAYO,IAArB,CAApB;AAEA,eAAKC,iBAAL;AAEA,eAAKC,YAAL,CAAkB,MAAM;AACpB,iBAAKT,MAAL,CAAYU,WAAZ;AACH,WAFD,EAEG,GAFH;AAIH;;AAEDF,QAAAA,iBAAiB,GAAG;AAChB;AACA,cAAIG,SAAS,GAAG,KAAKX,MAAL,CAAYY,sBAAZ,EAAhB;AACA,cAAIC,KAAK,GAAG;AAAA;AAAA,sCAAUC,aAAV,CAAwBC,IAAI,CAACC,KAAL,CAAWL,SAAS,CAACM,CAArB,EAAwBN,SAAS,CAACO,CAAlC,CAAxB,CAAZ;AACA,eAAKlB,MAAL,CAAYO,IAAZ,CAAiBM,KAAjB,GAAyBA,KAAzB,CAJgB,CAMhB;;AACA,cAAIM,GAAG,GAAG1B,IAAI,CAAC2B,QAAL,CAAc,KAAKpB,MAAL,CAAYO,IAAZ,CAAiBc,WAAjB,EAAd,EAA8C;AAAA;AAAA,oCAASC,MAAT,CAAgBf,IAAhB,CAAqBc,WAArB,EAA9C,IAAoF,EAA9F;;AACA,cAAIF,GAAG,GAAG,KAAKd,YAAf,EAA6B;AACzBc,YAAAA,GAAG,GAAG,KAAKd,YAAX;AACH;;AACD,eAAKF,QAAL,CAAcoB,YAAd,CAA2B/B,WAA3B,EAAwCgC,KAAxC,GAAgDL,GAAhD;AACA,eAAKhB,QAAL,CAAcoB,YAAd,CAA2B/B,WAA3B,EAAwCiC,MAAxC,GAAiD,KAAKrB,gBAAL,GAAwBe,GAAzE;AACA,eAAKnB,MAAL,CAAYuB,YAAZ,CAAyBlC,aAAzB,EAAwCqC,MAAxC,CAA+CR,CAA/C,GAAmDC,GAAG,GAAG,EAAzD;AACH;;AAEDQ,QAAAA,MAAM,CAACC,EAAD,EAAa;AACf,eAAKpB,iBAAL;AACH;;AA5CkC,O","sourcesContent":["import { BoxCollider2D, Component, find, Node, UITransform, Vec2, _decorator } from 'cc';\r\nimport { utilTools } from '../../../../utils/utilTools';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { Bullet } from './Bullet';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 蝎子-闪电\r\n@ccclass('bullet8')\r\nexport class bullet8 extends Component {\r\n\r\n    bullet: Bullet;\r\n    contactNotHide: boolean = true;\r\n    moveStop: boolean = false;\r\n\r\n    bodyNode: Node;\r\n    heightWidthRatio: number = 207 / 440;\r\n\r\n    // 最大跟踪长度\r\n    maxFollowDis: number = 600;\r\n\r\n    init(bullet: Bullet) {\r\n        this.bullet = bullet;\r\n        this.moveStop = true;\r\n\r\n        this.bodyNode = find(\"body\", this.bullet.node);\r\n\r\n        this.updateAngleAndDis();\r\n\r\n        this.scheduleOnce(() => {\r\n            this.bullet.recycleSelf();\r\n        }, 2.3);\r\n\r\n    }\r\n\r\n    updateAngleAndDis() {\r\n        // 角度\r\n        let direction = this.bullet.getFacePlayerDirection();\r\n        let angle = utilTools.radianToAngle(Math.atan2(direction.y, direction.x));\r\n        this.bullet.node.angle = angle;\r\n\r\n        // 长度\r\n        let dis = Vec2.distance(this.bullet.node.getPosition(), mapModel.player.node.getPosition()) + 40;\r\n        if (dis > this.maxFollowDis) {\r\n            dis = this.maxFollowDis;\r\n        }\r\n        this.bodyNode.getComponent(UITransform).width = dis;\r\n        this.bodyNode.getComponent(UITransform).height = this.heightWidthRatio * dis;\r\n        this.bullet.getComponent(BoxCollider2D).offset.x = dis - 50;\r\n    }\r\n\r\n    update(dt: number) {\r\n        this.updateAngleAndDis();\r\n    }\r\n\r\n}\r\n\r\n"]}