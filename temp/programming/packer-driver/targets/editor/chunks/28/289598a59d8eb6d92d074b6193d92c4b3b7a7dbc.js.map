{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/platform/wechat/WXCustomAd.ts"],"names":["WXCustomAd","tyqSDK","EType","cb","setadunit","rectid","hid","vid","oneid","_customc_rect_adunit","_customc_h_adunit","_customc_v_adunit","_customc_one_adunit","createCustomAd","flag","type","pos","adSize","extraId","failcb","window","wx","sysInfo","getSystemInfoSync","version","SDKVersion","ad","id","self","rand","length","Array","log","_ads","_waits","isShow","show","compareVersion","p","getPos","adUnitId","adIntervals","style","top","left","width","fixed","onLoad","index","indexOf","filter","x","hide","then","catch","onError","res","errCode","errMsg","parseInt","onClose","min","max","Math","floor","random","hideCustomAd","push","destroyCustomAd","destroy","v1","v2","split","len","i","num1","num2","w","h","height","sc_w","windowWidth","cc","winSize","sc_h","windowHeight","l","t","undefined","right","bottom","centerX","centerY","hideAllAd","key"],"mappings":"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","sourcesContent":["import { tyqSDK } from \"../../tyqSDK\";\r\n\r\nexport interface IPos {\r\n    left?: number;\r\n    right?: number;\r\n    top?: number;\r\n    bottom?: number;\r\n    centerX?: number;\r\n    centerY?: number;\r\n}\r\n\r\nexport enum EType {\r\n    // * @param type 1矩阵；2横向；3竖向；4单格子\r\n    rect = 1,\r\n    horizontal,\r\n    vertical,\r\n    grid,\r\n}\r\nexport class WXCustomAd {\r\n\r\n    /**原生模板广告矩阵样式id\t */\r\n    public static _customc_rect_adunit = [];\r\n\r\n    /**原生模板广告横向样式id\t */\r\n    public static _customc_h_adunit = [];\r\n\r\n    /**原生模板广告竖向样式id\t */\r\n    public static _customc_v_adunit = [];\r\n\r\n    /**原生模板广告单个样式id\t */\r\n    private static _customc_one_adunit = [];\r\n\r\n    /**广告缓存 */\r\n    private static _ads = {};\r\n\r\n    /** */\r\n    private static _waits = [];\r\n\r\n    private static sysInfo = null;\r\n\r\n    private cb: any;\r\n    static cb: Function;\r\n    /**\r\n     * 设置广告id\r\n     * @param rectid 矩阵样式id\r\n     * @param hid 横向样式id\r\n     * @param vid 竖向样式id\r\n     * @param oneid 单格子样式id\r\n     */\r\n    static setadunit(rectid, hid, vid, oneid) {\r\n        this._customc_rect_adunit = rectid;\r\n        this._customc_h_adunit = hid;\r\n        this._customc_v_adunit = vid;\r\n        this._customc_one_adunit = oneid;\r\n    }\r\n\r\n    /**\r\n     * 创建一个原生广告对象\r\n     * @param flag 创建来源标识（用标识来控制显示和隐藏）\r\n     * @param type 1矩阵；2横向；3竖向；4单格子\r\n     * @param pos 位置(对象可包含left、right、top、bottom、centerX、centerY字段)。分别表示距离左右上下和中心点的距离\r\n     * @param adSize 广告尺寸\r\n     * @param extraId 指定广告id参数\r\n     * @param failcb:当未拉取到广告（目前仅限报1004错误，如拉取其他错误需自行更改回调）之后，可执行回调。 \r\n     * @returns \r\n     */\r\n    static createCustomAd(flag, type: EType, pos: IPos, adSize: { width: number, height: number }, extraId?: any, failcb?: Function) {\r\n        if (!window.wx) return;\r\n        if (!this.sysInfo) {\r\n            this.sysInfo = wx.getSystemInfoSync();\r\n        }\r\n        let version = this.sysInfo.SDKVersion;\r\n        let ad = null;\r\n        let id = \"\";\r\n        let self = this;\r\n\r\n        if (failcb) {\r\n            this.cb = failcb;\r\n        }\r\n\r\n        if (type == 1) {\r\n            id = this._customc_rect_adunit[this.rand(0, this._customc_rect_adunit.length - 1)];\r\n        } else if (type == 2) {\r\n            id = this._customc_h_adunit[this.rand(0, this._customc_h_adunit.length - 1)];\r\n        } else if (type == 3) {\r\n            id = this._customc_v_adunit[this.rand(0, this._customc_v_adunit.length - 1)];\r\n        }\r\n        else if (type == 4) {\r\n            id = this._customc_one_adunit[this.rand(0, this._customc_one_adunit.length - 1)];\r\n        }\r\n        if (extraId && extraId !== \"\") {\r\n            if (typeof extraId == \"string\") {\r\n                id = extraId;\r\n            } else if (extraId instanceof Array) {\r\n                id = extraId[this.rand(0, extraId.length - 1)];\r\n            }\r\n        }\r\n\r\n        //id不存在\r\n        if (id == \"\") return;\r\n\r\n        tyqSDK.log(\"显示原生模板广告\", flag, this._ads, this._waits);\r\n        //缓存有\r\n        if (this._ads[flag]) {\r\n            ad = this._ads[flag];\r\n            tyqSDK.log(\"缓存有\");\r\n            if (!ad.isShow()) ad.show();\r\n        }\r\n        else if (this.compareVersion(version, '2.11.1') >= 0) {\r\n            tyqSDK.log(\"创建原生模板广告\" + flag, \"id:\" + id, \"pos:\", pos);\r\n            let p = self.getPos(adSize, pos);\r\n            ad = wx.createCustomAd({\r\n                adUnitId: id,\r\n                adIntervals: 30,\r\n                style: {\r\n                    top: p.top,\r\n                    left: p.left,\r\n                    width: adSize.width, // 用于设置组件宽度，只有部分模板才支持，如矩阵格子模板\r\n                    fixed: false // fixed 只适用于小程序环境\r\n                }\r\n            })\r\n\r\n            ad.onLoad(() => {\r\n                self._ads[flag] = ad;\r\n                let index = self._waits.indexOf(flag);\r\n                tyqSDK.log(\"原生模板广告加载完成：\" + flag, self._waits, index);\r\n                if (index == -1)\r\n                    ad.show();\r\n                else {\r\n                    self._waits = self._waits.filter(x => x != flag);\r\n                    // self._waits.splice(index, 1);\r\n                    ad.hide().then(() => {\r\n\r\n                    }).catch(() => {\r\n                        // self.hideCustomAd(flag);\r\n                        tyqSDK.log(\"第二次hide\");\r\n                        ad.hide().catch(() => {\r\n                            tyqSDK.log(\"第三次hide\");\r\n                        });\r\n                    });\r\n                }\r\n\r\n            });\r\n            ad.onError((res) => {\r\n                tyqSDK.log('原生模板广告加载失败:', res.errCode, ' ', res.errMsg);\r\n                if (parseInt(res.errCode) === 1004 && this.cb) {\r\n                    tyqSDK.log(\"拉取失败\");\r\n                    this.cb();\r\n                }\r\n            });\r\n            ad.onClose(() => {\r\n                tyqSDK.log(\"原生模板广告关闭\");\r\n            });\r\n        } else {\r\n            // 如果希望用户在最新版本的客户端上体验您的小程序，可以这样子提示\r\n            // wx.showModal({\r\n            //     title: '提示',\r\n            //     content: '当前微信版本过低，无法使用该功能，请升级到最新微信版本后重试。'\r\n            // })\r\n        }\r\n    }\r\n\r\n    public static rand(min, max) {\r\n        return min + Math.floor(Math.random() * (max - min + 1));\r\n    }\r\n    \r\n    /**\r\n     * 隐藏原生模板广告\r\n     * @param flag \r\n     */\r\n    public static hideCustomAd(flag) {\r\n        let ad = null;\r\n\r\n        tyqSDK.log(\"隐藏原生模板广告\", flag, this._ads, this._waits);\r\n        if (this._ads[flag]) {\r\n            ad = this._ads[flag];\r\n            if (ad.isShow())\r\n                ad.hide().then(() => {\r\n\r\n                }).catch(() => {\r\n                    // self.hideCustomAd(flag);\r\n                    tyqSDK.log(\"第二次hide\");\r\n                    ad.hide().catch(() => {\r\n                        tyqSDK.log(\"第三次hide\");\r\n                    });\r\n                });\r\n        } else {\r\n            if (this._waits.indexOf(flag) == -1) {\r\n                this._waits.push(flag);\r\n            }\r\n\r\n        }\r\n    }\r\n    public static destroyCustomAd(flag) {\r\n        if (this._ads[flag]) {\r\n            this._ads[flag].destroy();\r\n            this._ads[flag] = null;\r\n        }\r\n    }\r\n\r\n    private static compareVersion(v1, v2) {\r\n        v1 = v1.split('.')\r\n        v2 = v2.split('.')\r\n        const len = Math.max(v1.length, v2.length)\r\n\r\n        while (v1.length < len) {\r\n            v1.push('0')\r\n        }\r\n        while (v2.length < len) {\r\n            v2.push('0')\r\n        }\r\n\r\n        for (let i = 0; i < len; i++) {\r\n            const num1 = parseInt(v1[i])\r\n            const num2 = parseInt(v2[i])\r\n\r\n            if (num1 > num2) {\r\n                return 1\r\n            } else if (num1 < num2) {\r\n                return -1\r\n            }\r\n        }\r\n\r\n        return 0\r\n    }\r\n\r\n    /**\r\n     * 获取实际的位置\r\n     * @param adSize 广告尺寸\r\n     * @param pos 游戏中的相对位置\r\n     * @returns \r\n     */\r\n    private static getPos(adSize: any, pos: IPos) {\r\n        if (!this.sysInfo) {\r\n            this.sysInfo = wx.getSystemInfoSync();\r\n        }\r\n        let sysInfo = this.sysInfo;\r\n        let w = adSize.width;\r\n        let h = adSize.height;\r\n\r\n        let sc_w = sysInfo.windowWidth / cc.winSize.width;\r\n        let sc_h = sysInfo.windowHeight / cc.winSize.height;\r\n\r\n        let l = (sysInfo.windowWidth - w) / 2;\r\n        let t = (sysInfo.windowHeight - h) / 2;\r\n        if (pos && pos.left != undefined) l = pos.left * sc_w;\r\n        if (pos && pos.top != undefined) t = pos.top * sc_h;\r\n        if (pos && pos.right != undefined) l = sysInfo.windowWidth - w - pos.right * sc_w;\r\n        if (pos && pos.bottom != undefined) t = sysInfo.windowHeight - h - pos.bottom * sc_h;\r\n        if (pos && pos.centerX != undefined) l = (sysInfo.windowWidth - w) / 2 + pos.centerX * sc_w;\r\n        if (pos && pos.centerY != undefined) t = (sysInfo.windowHeight - h) / 2 + pos.centerY * sc_h;\r\n\r\n        return {\r\n            left: l,\r\n            top: t\r\n        }\r\n    }\r\n    public static hideAllAd() {\r\n        for (const key in this._ads) {\r\n            this.hideCustomAd(key);\r\n        }\r\n    }\r\n}"]}