{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/utils/CountTimeUtil.ts"],"names":["Component","Label","macro","_decorator","utilTools","ccclass","property","CountTimeUtil","_time","_callFun","onLoad","node","getComponent","string","getTimeStr","setTime","time","callFun","schedule","updateTime","REPEAT_FOREVER","start","unschedule"],"mappings":";;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,U,OAAAA,U;;AAIzBC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBH,U;;+BAGjBI,a,WADZF,OAAO,CAAC,eAAD,C,gBAAR,MACaE,aADb,SACmCP,SADnC,CAC6C;AAAA;AAAA;AAAA,eAEzCQ,KAFyC,GAEjC,CAFiC;AAAA,eAGzCC,QAHyC,GAG9B,IAH8B;AAAA;;AAKzCC,QAAAA,MAAM,GAAG;AACL,eAAKC,IAAL,CAAUC,YAAV,CAAuBX,KAAvB,EAA8BY,MAA9B,GAAuC;AAAA;AAAA,sCAAUC,UAAV,CAAqB,KAAKN,KAAL,GAAa,IAAlC,EAAwC,IAAxC,CAAvC;AACH;;AAEDO,QAAAA,OAAO,CAACC,IAAD,EAAOC,OAAO,GAAG,IAAjB,EAAuB;AAC1B,eAAKT,KAAL,GAAaQ,IAAb;AACA,eAAKP,QAAL,GAAgBQ,OAAhB;;AACA,cAAI,KAAKT,KAAL,GAAa,CAAjB,EAAoB;AAChB,iBAAKG,IAAL,CAAUC,YAAV,CAAuBX,KAAvB,EAA8BY,MAA9B,GAAuC;AAAA;AAAA,wCAAUC,UAAV,CAAqB,KAAKN,KAAL,GAAa,IAAlC,EAAwC,IAAxC,CAAvC;AACA,iBAAKU,QAAL,CAAc,KAAKC,UAAnB,EAA+B,CAA/B,EAAkCjB,KAAK,CAACkB,cAAxC;AACH,WAHD,MAGO;AACH,iBAAKT,IAAL,CAAUC,YAAV,CAAuBX,KAAvB,EAA8BY,MAA9B,GAAuC,EAAvC;AACH;AACJ;;AAEDQ,QAAAA,KAAK,GAAG,CACJ;AACH;;AAEDF,QAAAA,UAAU,GAAG;AACT,cAAI,KAAKX,KAAL,GAAa,CAAjB,EAAoB;AAChB,iBAAKA,KAAL;AACA,iBAAKG,IAAL,CAAUC,YAAV,CAAuBX,KAAvB,EAA8BY,MAA9B,GAAuC;AAAA;AAAA,wCAAUC,UAAV,CAAqB,KAAKN,KAAL,GAAa,IAAlC,EAAwC,IAAxC,CAAvC;AACH;;AACD,cAAI,KAAKA,KAAL,IAAc,CAAlB,EAAqB;AACjB,iBAAKc,UAAL,CAAgB,KAAKH,UAArB;AACA,iBAAKR,IAAL,CAAUC,YAAV,CAAuBX,KAAvB,EAA8BY,MAA9B,GAAuC,EAAvC;AACA,iBAAKJ,QAAL,IAAiB,KAAKA,QAAL,EAAjB,CAHiB,CAIjB;AACA;AACH;AACJ;;AApCwC,O","sourcesContent":["import { Component, Label, macro, _decorator } from \"cc\";\r\nimport { msgac } from \"../game/data/msgac\";\r\nimport { eventManager } from \"../game/manager/eventManager\";\r\nimport { UserData } from \"../game/model/UserData\";\r\nimport { utilTools } from \"./utilTools\";\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('CountTimeUtil')\r\nexport class CountTimeUtil extends Component {\r\n\r\n    _time = 0;\r\n    _callFun = null\r\n\r\n    onLoad() {\r\n        this.node.getComponent(Label).string = utilTools.getTimeStr(this._time * 1000, true)\r\n    }\r\n\r\n    setTime(time, callFun = null) {\r\n        this._time = time\r\n        this._callFun = callFun\r\n        if (this._time > 0) {\r\n            this.node.getComponent(Label).string = utilTools.getTimeStr(this._time * 1000, true)\r\n            this.schedule(this.updateTime, 1, macro.REPEAT_FOREVER)\r\n        } else {\r\n            this.node.getComponent(Label).string = \"\"\r\n        }\r\n    }\r\n\r\n    start() {\r\n        // this.schedule(this.updateTime, 1, macro.REPEAT_FOREVER)\r\n    }\r\n\r\n    updateTime() {\r\n        if (this._time > 0) {\r\n            this._time--\r\n            this.node.getComponent(Label).string = utilTools.getTimeStr(this._time * 1000, true)\r\n        }\r\n        if (this._time <= 0) {\r\n            this.unschedule(this.updateTime)\r\n            this.node.getComponent(Label).string = \"\"\r\n            this._callFun && this._callFun()\r\n            // UserData.getInstance().checkPowerTime()\r\n            // eventManager.send(msgac.commonResRefresh);\r\n        }\r\n    }\r\n}\r\n\r\n"]}