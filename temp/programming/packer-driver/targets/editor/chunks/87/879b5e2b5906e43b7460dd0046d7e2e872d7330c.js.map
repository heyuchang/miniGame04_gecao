{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/monsters/Monster4.ts"],"names":["Component","v3","Vec3","_decorator","utilTools","mapModel","physicsGroup","ccclass","property","Monster4","monster","moveStop","bulletId1","bulletId2","minDisPlayer","outVec3","init","startSkillLogic","time","scheduleOnce","ret","Math","random","useSkill1","useSkill2","hp","animationCtrl","playAnimationOnce","pos","getInfoPosition","direction","getBulletDirection","bulletSystem","addBullet","MONSTER_BULLET","num","radian","angleToRadian","direction2","rotateZ","ZERO","direction3"],"mappings":"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","sourcesContent":["import { Component, v3, Vec3, _decorator } from 'cc';\r\nimport { utilTools } from '../../../../utils/utilTools';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { physicsGroup } from '../../../other/physicsGroup';\r\nimport { Monster } from './Monster';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 狙击手\r\n@ccclass('Monster4')\r\nexport class Monster4 extends Component {\r\n\r\n    monster: Monster;\r\n    moveStop: boolean;\r\n\r\n    // 跟踪导弹\r\n    bulletId1: number = 1002;\r\n    // 一颗大子弹\r\n    bulletId2: number = 1003;\r\n\r\n    // 距离玩家最小距离\r\n    minDisPlayer: number = 300;\r\n\r\n    outVec3: Vec3 = v3(0, 0, 0);\r\n\r\n    init(monster: Monster) {\r\n        this.monster = monster;\r\n        this.moveStop = false;\r\n\r\n        this.startSkillLogic();\r\n    }\r\n\r\n    startSkillLogic() {\r\n        let time = 2;\r\n        this.scheduleOnce(() => {\r\n            let ret = Math.random();\r\n            if (ret < 0.4) {\r\n                this.useSkill1();\r\n            } else if (ret < 0.7) {\r\n                this.useSkill1(3);\r\n            } else {\r\n                this.useSkill2();\r\n            }\r\n        }, time);\r\n    }\r\n\r\n    useSkill2() {\r\n        if (this.monster.hp <= 0) {\r\n            return;\r\n        }\r\n        this.moveStop = true;\r\n        this.monster.animationCtrl.playAnimationOnce(\"attack\", () => {\r\n            this.startSkillLogic();\r\n            this.moveStop = false;\r\n        });\r\n        this.scheduleOnce(() => {\r\n            // 发射一颗大子弹\r\n            let pos = this.monster.getInfoPosition(0, true);\r\n            let direction = this.monster.getBulletDirection();\r\n            mapModel.bulletSystem.addBullet(this.bulletId2, physicsGroup.MONSTER_BULLET, pos, direction);\r\n        }, 0.5);\r\n    }\r\n\r\n    useSkill1(num: number = 1) {\r\n        if (this.monster.hp <= 0) {\r\n            return;\r\n        }\r\n        this.monster.animationCtrl.playAnimationOnce(\"attack\", () => {\r\n            this.startSkillLogic();\r\n        });\r\n        this.scheduleOnce(() => {\r\n            // 发射三颗跟踪子弹\r\n            let pos = this.monster.getInfoPosition(0, true);\r\n            let direction = this.monster.getBulletDirection();\r\n\r\n            mapModel.bulletSystem.addBullet(this.bulletId1, physicsGroup.MONSTER_BULLET, pos, direction);\r\n\r\n            if (num == 3) {\r\n                let radian = utilTools.angleToRadian(50);\r\n                let direction2 = Vec3.rotateZ(this.outVec3, direction, Vec3.ZERO, radian);\r\n                mapModel.bulletSystem.addBullet(this.bulletId1, physicsGroup.MONSTER_BULLET, pos, direction2);\r\n\r\n                let direction3 = Vec3.rotateZ(this.outVec3, direction, Vec3.ZERO, -radian);\r\n                mapModel.bulletSystem.addBullet(this.bulletId1, physicsGroup.MONSTER_BULLET, pos, direction3);\r\n            }\r\n\r\n        }, 0.5);\r\n    }\r\n\r\n}\r\n\r\n"]}