{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/tyqAdManager.ts"],"names":["TyqAdManager","native","sys","view","NATIVE","VIVO","msgac","eventManager","VivoManager","Wechat","EType","WXCustomAd","tyqSDK","tyqSDKConfig","Channel","instance","_instance","constructor","channel","DEFAULT","customAdSizeObj","rect","width","height","horizontal","vertical","grid","adShowType","bannerAdShowing","showBannerCount","shareTime","shareListenerSuccess","shareListenerFail","openID","strategy","videoCallBack","videoCallBackFail","shareopenID","_delayTime","platform","Platform","WECHAT_GAME","WECHAT","windowSize","getVisibleSize","bannerSize","ANDROID_233","OPPO_MINI_GAME","getEnterUrlQuery","wx","getEnterOptionsSync","options","query","shareGameSync","eventSendCustomEvent","showAppMessage","Date","getTime","console","log","shareAppMessage","getOpenID","login","success","res","code","URL","request","url","data","getChannel","initAdIds","showShareMenu","withShareTicket","menus","onHide","wxOnHide","bind","onShow","wxOnShow","bannerIds","getSwitchValue","paramsKeys","tyq_ad_banners","_bannerAdUnitId","split","interstitialIds","tyq_ad_interstitial","_interstitialAdUnitId","customRectIds","tyq_ad_custom_rect","_customc_rect_adunit","customVIds","tyq_ad_custom_v","_customc_v_adunit","customHIds","tyq_ad_custom_h","_customc_h_adunit","rewardedIds","tyq_ad_rewarded","_rewardedVideoAdUnitId","preLoadBanner","createRewardedVideoAd","ANDROID_4399","window","rewardedVideoAdCallBack","send","showNotice","rewardedVideoAdFailCallBack","mode","action","targetAction","pagePath","targetPagePath","actions","indexOf","adClickUpload","adShowTypes","bannerAndCustomAd","reportShareBehavior","showBannerAd","time","showBannerTurns","reflection","callStaticMethod","VIVO_MINI_GAME","hideBannerAd","isForce","isBannerAdShowing","showInterstitialAd","interstitialAd","showFullRewarded","showDelayFullVideo","showDelayInterstitialAd","showCustomRectCenterAd","failcb","createCustomAd","centerX","centerY","hideCustomRectCenterAd","hideCustomAd","showCustomVerticalLeftRightAd","left","right","hideCustomVerticalLeftRightAd","showCustomHorizontalTopAd","top","hideCustomHorizontalTopAd","showCustomAd","flag","type","pos","adSize","adId","hideCustomAllAd","hideAllAd","operation","currentShow","isOpenBeHavior","inviteUser","showRewardedAd","successCb","failCb","forceVideo","isShareBehavior","tyqAdManager","isCloseAd","showRewardVideoAd","rewardedAd","then","isSuccess","state"],"mappings":"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","sourcesContent":["import { native, sys, view } from \"cc\";\r\nimport { NATIVE, VIVO, WECHAT } from \"cc/env\";\r\nimport { msgac } from \"../game/data/msgac\";\r\nimport { eventManager } from \"../game/manager/eventManager\";\r\nimport { VivoManager } from \"./platform/Vivo\";\r\nimport { Wechat } from \"./platform/wechat/wechat\";\r\nimport { EType, IPos, WXCustomAd } from \"./platform/wechat/WXCustomAd\";\r\nimport { tyqSDK } from \"./tyqSDK\";\r\nimport { tyqSDKConfig } from \"./tyqSDKConfig\";\r\n\r\n/**渠道 */\r\nexport enum Channel {\r\n    /**默认 浏览器*/\r\n    DEFAULT = 0,\r\n    /**微信小游戏 */\r\n    WECHAT = 1,\r\n    ANDROID,\r\n    IOS,\r\n    ANDROID_233,\r\n    ANDROID_4399,\r\n    H5_4399,\r\n    VIVO_MINI_GAME,\r\n    OPPO_MINI_GAME,\r\n\r\n}\r\n\r\nclass TyqAdManager {\r\n\r\n    private static _instance: TyqAdManager;\r\n    public static get instance(): TyqAdManager {\r\n        if (!this._instance) {\r\n            this._instance = new TyqAdManager();\r\n        }\r\n        return this._instance;\r\n    }\r\n\r\n    private channel: Channel = Channel.DEFAULT;\r\n\r\n\r\n\r\n\r\n\r\n    // 默认原生广告各个类型的尺寸\r\n    public customAdSizeObj: any = {\r\n        // 矩阵 行数：5\r\n        rect: {\r\n            width: 360,\r\n            height: 506\r\n        },\r\n        // 横向 尺寸：80%  默认数：5\r\n        horizontal: {\r\n            width: 288,\r\n            height: 90\r\n        },\r\n        // 竖向 尺寸：90%  默认数：5\r\n        vertical: {\r\n            width: 62,\r\n            height: 388\r\n        },\r\n        // 单个格子 尺寸：90%\r\n        grid: {\r\n            width: 68,\r\n            height: 102\r\n        }\r\n    };\r\n\r\n    // 当前显示广告的类型\r\n    private adShowType: string;\r\n    // banner广告是否正在显示中\r\n    private bannerAdShowing: boolean = false;\r\n    // banner广告显示接口调用次数\r\n    private showBannerCount = 0;\r\n\r\n    private shareTime = 0\r\n    private shareListenerSuccess = null\r\n    private shareListenerFail = null\r\n\r\n    private openID = \"\"\r\n\r\n    private strategy = 1\r\n\r\n    public videoCallBack: Function = () => { };\r\n    public videoCallBackFail: Function = () => { };\r\n\r\n    private shareopenID = \"\"\r\n\r\n    constructor() {\r\n        if (sys.platform == sys.Platform.WECHAT_GAME) {\r\n            this.channel = Channel.WECHAT;\r\n\r\n            let windowSize = view.getVisibleSize();\r\n            if (windowSize.width / windowSize.height > 720 / 1440) {\r\n                Wechat.bannerSize = { width: 300, height: 120 }\r\n            }\r\n\r\n        } else {\r\n            this.channel = Channel.DEFAULT;\r\n        }\r\n        if (NATIVE) {\r\n            this.channel = Channel.ANDROID_233;\r\n        }\r\n        this.channel = Channel.OPPO_MINI_GAME\r\n    }\r\n\r\n    public getEnterUrlQuery() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            // 冷启动 wx.getLaunchOptionsSync()\r\n            // 冷启动和热启动 wx.getEnterOptionsSync()\r\n            if (wx.getEnterOptionsSync) {\r\n                let options = wx.getEnterOptionsSync();\r\n                //    console.log(\"options\", options)\r\n                if (options && options.query) {\r\n                    //  console.log(\"options.query\", options.query.toString())\r\n                    let openID = options.query.shareGameSync\r\n                    //    console.log(\"login openID = \", openID)\r\n                    if (openID) {\r\n                        // this.reportShareBehavior(6, 1, openID)\r\n                        this.shareopenID = openID\r\n                        tyqSDK.eventSendCustomEvent(\"参与激励托管分享成功进来的玩家\")\r\n                    }\r\n                    return options.query;\r\n                }\r\n            }\r\n        }\r\n        return null;\r\n    }\r\n\r\n    public showAppMessage() {\r\n        this.shareTime = new Date().getTime()\r\n        console.log(\"this.openID = \", this.openID)\r\n        Wechat.shareAppMessage(\"挑战未知敌人，化身特工\", \"\", \"shareGameSync=\" + this.openID)\r\n    }\r\n\r\n    public getOpenID() {\r\n        //只能在服务端请求\r\n        wx.login({\r\n            success: res => {\r\n                if (res.code) {\r\n                    let URL = 'https://api.weixin.qq.com/sns/jscode2session?appid=###&secret=********&js_code=' + res.code + '&grant_type=authorization_code'\r\n                    wx.request({\r\n                        url: URL,\r\n                        success: function (res) {\r\n                            console.log(res.data)//res.data中有openid\r\n                        }\r\n                    })\r\n                }\r\n            }\r\n        })\r\n    }\r\n\r\n    public getChannel() {\r\n        return this.channel;\r\n    }\r\n\r\n    public initAdIds() {\r\n\r\n        if (this.channel == Channel.WECHAT) {\r\n            // 显示当前页面的转发按钮\r\n            // \"shareAppMessage\"表示“发送给朋友”按钮，\"shareTimeline\"表示“分享到朋友圈”按钮\r\n            wx.showShareMenu({\r\n                withShareTicket: true,\r\n                menus: ['shareAppMessage', 'shareTimeline']\r\n            });\r\n\r\n            wx.onHide(this.wxOnHide.bind(this));\r\n            wx.onShow(this.wxOnShow.bind(this));\r\n\r\n            // banner广告参数\r\n            let bannerIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_banners);\r\n            if (bannerIds) {\r\n                Wechat._bannerAdUnitId = bannerIds.split(\";\");\r\n            } else {\r\n                tyqSDK.log(\"未配置banner广告参数\");\r\n            }\r\n\r\n            // 插屏广告参数\r\n            let interstitialIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_interstitial);\r\n            if (interstitialIds) {\r\n                Wechat._interstitialAdUnitId = interstitialIds.split(\";\");\r\n            } else {\r\n                tyqSDK.log(\"未配置banner广告参数\");\r\n            }\r\n\r\n            // 原生广告参数\r\n            let customRectIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_custom_rect);\r\n            if (customRectIds) {\r\n                WXCustomAd._customc_rect_adunit = customRectIds.split(\";\");\r\n                //  console.log(\" WXCustomAd._customc_rect_adunit = \",WXCustomAd._customc_rect_adunit)\r\n            } else {\r\n                tyqSDK.log(\"未配置原生矩阵广告参数\");\r\n            }\r\n            let customVIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_custom_v);\r\n            if (customVIds) {\r\n                WXCustomAd._customc_v_adunit = customVIds.split(\";\");\r\n            } else {\r\n                tyqSDK.log(\"未配置原生垂直广告参数\");\r\n            }\r\n            let customHIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_custom_h);\r\n            if (customHIds) {\r\n                WXCustomAd._customc_h_adunit = customHIds.split(\";\");\r\n            } else {\r\n                tyqSDK.log(\"未配置原生水平广告参数\");\r\n            }\r\n\r\n            // 激励视频广告参数\r\n            let rewardedIds = tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_ad_rewarded);\r\n            if (rewardedIds) {\r\n                Wechat._rewardedVideoAdUnitId = rewardedIds.split(\";\");\r\n            } else {\r\n                tyqSDK.log(\"未配置激励视频广告参数\");\r\n            }\r\n\r\n            // 预加载广告\r\n            // banner广告必须要预加载后才能使用\r\n            Wechat.preLoadBanner();\r\n\r\n            // 为了减少初始化卡顿时间，激励视频广告可以不预加载\r\n            Wechat.createRewardedVideoAd();\r\n\r\n            // 为了减少初始化卡顿时间，插屏广告可以不预加载\r\n            // Wechat.createInterstitialAd();\r\n        } else if (this.channel == Channel.ANDROID_233 || this.channel == Channel.ANDROID_4399) {\r\n            //  if (NATIVE) {\r\n            console.log(\" NATIVE android 平台 initAdIds \")\r\n            window.rewardedVideoAdCallBack = (res: any) => {\r\n                //EventHelper.DispatchEvent(\"showTips\", \"获得奖励\");\r\n                console.log(\"AD_DEMO rewardedVideoAdCallBack \", res)\r\n                eventManager.send(msgac.showNotice, \" 发放视频奖励 \");\r\n                if (this.videoCallBack) {\r\n                    this.videoCallBack()\r\n                }\r\n            }\r\n\r\n            window.rewardedVideoAdFailCallBack = (res: any) => {\r\n                //EventHelper.DispatchEvent(\"showTips\", \"获得奖励\");\r\n                console.log(\"AD_DEMO rewardedVideoAdCallBack \", res)\r\n                //    eventManager.send(msgac.showNotice, \" 视频奖励 失败\");\r\n                if (this.videoCallBackFail) {\r\n                    this.videoCallBackFail()\r\n                }\r\n            }\r\n            //  jsb.reflection.callStaticMethod(\"org/cocos2dx/javascript/AppActivity\", \"RewardVideoShow\", \"(Ljava/lang/String;)V\", \"展示广告\");\r\n            return\r\n            // }\r\n        }\r\n    }\r\n\r\n    public wxOnHide(res?) {\r\n        // tyqSDK.log(\"wx onHide:\", res, this.adShowType);\r\n        if (!res) {\r\n            return;\r\n        }\r\n\r\n        let mode = res.mode;\r\n        let action = res.targetAction;\r\n        let pagePath = res.targetPagePath;\r\n\r\n        // 8：跳转到小游戏内部页面WCCanvasPageViewController\r\n        // 9：跳转到其他微信小游戏\r\n        // 10：跳转到一个链接\r\n        let actions = [8, 9, 10];\r\n        if (actions.indexOf(action) == -1) {\r\n            // 不感兴趣的跳转，直接返回，比如：右上角的圆点或者home键最小化\r\n            return;\r\n        }\r\n\r\n        if (this.adShowType) {\r\n            // 已判断到的广告类型，直接使用\r\n            tyqSDK.adClickUpload(this.adShowType, mode, action, pagePath);\r\n            return;\r\n        }\r\n\r\n        // 要判断出是banner或者原生广告点击\r\n        if (action == 9) {\r\n            // 跳转其他微信小游戏\r\n            tyqSDK.adClickUpload(tyqSDKConfig.adShowTypes.bannerAndCustomAd, mode, action, pagePath);\r\n            return;\r\n        }\r\n        if (pagePath) {\r\n            // 跳转内部页或者广告链接\r\n            if (pagePath == \"WCCanvasPageViewController\"\r\n                || pagePath.indexOf(\"ad.weixin.qq.com\") != -1\r\n                || pagePath.indexOf(\"ad_biz_info\") != -1\r\n                || pagePath.indexOf(\"weixinadkey\") != -1\r\n            ) {\r\n                tyqSDK.adClickUpload(tyqSDKConfig.adShowTypes.bannerAndCustomAd, mode, action, pagePath);\r\n            }\r\n            return;\r\n        }\r\n\r\n    }\r\n\r\n    public wxOnShow(res?) {\r\n        console.log(\"wx onShow:\", res);\r\n        if (this.shareTime > 0 && (new Date().getTime()) - this.shareTime >= 2000) {\r\n            this.shareListenerSuccess && this.shareListenerSuccess()\r\n        } else {\r\n            this.reportShareBehavior(5, this.strategy, 1)\r\n            this.shareListenerFail && this.shareListenerFail()\r\n        }\r\n        this.shareListenerFail = null\r\n        this.shareListenerSuccess = null\r\n        this.shareTime = 0\r\n    }\r\n\r\n    /**\r\n     * 显示底部banner轮播广告\r\n     * @param time 轮播间隔时间，单位：毫秒，默认5秒 \r\n     */\r\n    public showBannerAd(time?: number) {\r\n        this.showBannerCount++;\r\n\r\n        if (this.channel == Channel.WECHAT) {\r\n            if (this.bannerAdShowing) {\r\n                return true;\r\n            }\r\n            if (!time) {\r\n                time = 5000;\r\n            }\r\n            Wechat.showBannerTurns(time);\r\n            this.bannerAdShowing = true;\r\n        } else if (this.channel == Channel.ANDROID_4399) {\r\n            native.reflection.callStaticMethod(\"com/cocos/game/SdkUtil4399\", \"showBanner\", \"(Ljava/lang/String;)Z\", \"展示banner广告\")\r\n        } else if (this.channel == Channel.VIVO_MINI_GAME) {\r\n            if (VIVO) {\r\n                VivoManager.showBannerAd()\r\n                return\r\n            }\r\n        }\r\n\r\n    }\r\n    /**\r\n     * 隐藏banner广告\r\n     */\r\n    public hideBannerAd(isForce?: boolean) {\r\n        this.showBannerCount--;\r\n        if (isForce) {\r\n            this.showBannerCount = 0;\r\n        }\r\n        if (this.showBannerCount > 0) {\r\n            return;\r\n        }\r\n        if (this.channel == Channel.WECHAT) {\r\n            Wechat.hideBannerAd();\r\n            this.bannerAdShowing = false;\r\n        } else if (this.channel == Channel.ANDROID_4399) {\r\n            native.reflection.callStaticMethod(\"com/cocos/game/SdkUtil4399\", \"hideBanner\", \"(Ljava/lang/String;)Z\", \"隐藏banner广告\")\r\n        } else if (this.channel == Channel.VIVO_MINI_GAME) {\r\n            if (VIVO) {\r\n                VivoManager.hideBannerAd()\r\n                return\r\n            }\r\n        }\r\n    }\r\n    /**\r\n     * banner广告是否正在显示中\r\n     */\r\n    public isBannerAdShowing(): boolean {\r\n        return this.bannerAdShowing;\r\n    }\r\n\r\n    /**\r\n     * 显示插屏广告\r\n     */\r\n    public showInterstitialAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            Wechat.showInterstitialAd(() => {\r\n                // 关闭或者发生错误\r\n                this.adShowType = \"\";\r\n            }, () => {\r\n                // 成功展示\r\n                this.adShowType = tyqSDKConfig.adShowTypes.interstitialAd;\r\n            });\r\n        } else if (this.channel == Channel.ANDROID_233) {\r\n            this.showFullRewarded()\r\n            // native.reflection.callStaticMethod(\"com/cocos/game/MetaAdApiUtil\", \"showInterstitialAd\", \"(Ljava/lang/String;)Z\", \"展示插屏广告\")\r\n        } else if (this.channel == Channel.ANDROID_4399) {\r\n            native.reflection.callStaticMethod(\"com/cocos/game/SdkUtil4399\", \"InterstitialShow\", \"(Ljava/lang/String;)Z\", \"展示插屏广告\")\r\n        }\r\n    }\r\n\r\n    private _delayTime = 0\r\n\r\n    public showDelayFullVideo() {\r\n        if (this.channel == Channel.ANDROID_233) {\r\n            let time = new Date().getTime()\r\n            // console.log(\"time - this._delayTime = \",time - this._delayTime)\r\n            if (time - this._delayTime >= 120000) {\r\n                this.showFullRewarded()\r\n                this._delayTime = time\r\n            }\r\n        }\r\n    }\r\n\r\n    public showDelayInterstitialAd() {\r\n        if (this.channel == Channel.ANDROID_4399) {\r\n            if (this._delayTime <= 0) {\r\n                this._delayTime = new Date().getTime()\r\n                return\r\n            }\r\n            let time = new Date().getTime()\r\n            if (time - this._delayTime >= 200000) {\r\n                this.showInterstitialAd()\r\n                this._delayTime = time\r\n            }\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示原生矩阵广告\r\n     */\r\n    public showCustomRectCenterAd(failcb = null) {\r\n        if (this.channel == Channel.WECHAT) {\r\n            //  console.log(\"showCustomRectCenterAd\")\r\n            WXCustomAd.createCustomAd(\"default_custom_ad_rect\", EType.rect, {\r\n                centerX: 0,\r\n                centerY: 0\r\n            }, this.customAdSizeObj.rect, null, failcb);\r\n        }\r\n    }\r\n    /**\r\n     * 隐藏原生矩阵广告\r\n     */\r\n    public hideCustomRectCenterAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.hideCustomAd(\"default_custom_ad_rect\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示原生垂直广告，显示在左右两边\r\n     */\r\n    public showCustomVerticalLeftRightAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.createCustomAd(\"default_custom_ad_v_left\", EType.vertical, {\r\n                left: 0\r\n            }, this.customAdSizeObj.vertical);\r\n            WXCustomAd.createCustomAd(\"default_custom_ad_v_right\", EType.vertical, {\r\n                right: 0\r\n            }, this.customAdSizeObj.vertical);\r\n        }\r\n    }\r\n    /**\r\n     * 隐藏原生垂直广告\r\n     */\r\n    public hideCustomVerticalLeftRightAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.hideCustomAd(\"default_custom_ad_v_left\");\r\n            WXCustomAd.hideCustomAd(\"default_custom_ad_v_right\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示原生水平广告，显示在顶部\r\n     */\r\n    public showCustomHorizontalTopAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.createCustomAd(\"default_custom_ad_h\", EType.horizontal, {\r\n                top: 0\r\n            }, this.customAdSizeObj.horizontal);\r\n        }\r\n    }\r\n    /**\r\n    * 隐藏原生水平广告\r\n    */\r\n    public hideCustomHorizontalTopAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.hideCustomAd(\"default_custom_ad_h\");\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 通用显示原生广告接口\r\n     * @param flag 标识 \r\n     * @param type 类型\r\n     * @param pos 位置信息\r\n     * @param adSize 尺寸\r\n     * @param adId 广告id\r\n     * @param failcb 失败回调\r\n     */\r\n    public showCustomAd(flag: string, type: EType, pos: IPos, adSize: { width: number, height: number }, adId?: any, failcb?: Function) {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.createCustomAd(flag, type, pos, adSize, adId, failcb);\r\n        }\r\n    }\r\n    /**\r\n     * 根据创建标识隐藏原生广告\r\n     * @param flag\r\n     */\r\n    public hideCustomAd(flag: string) {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.hideCustomAd(flag);\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 隐藏所有原生广告\r\n     */\r\n    public hideCustomAllAd() {\r\n        if (this.channel == Channel.WECHAT) {\r\n            WXCustomAd.hideAllAd();\r\n        }\r\n    }\r\n\r\n\r\n    public showFullRewarded() {\r\n        if (this.channel == Channel.ANDROID_233) {\r\n            // successCb && successCb()\r\n            console.log(\"showFullRewarded\")\r\n            native.reflection.callStaticMethod(\"com/cocos/game/MetaAdApiUtil\", \"ShowFullRewardVideoShow\", \"(Ljava/lang/String;)Z\", \"展示全屏视频广告\")\r\n            return\r\n        }\r\n    }\r\n\r\n    public reportShareBehavior(operation, strategy = 1, currentShow = null) {\r\n\r\n        if (tyqSDKConfig.isOpenBeHavior) {\r\n            if (this.shareopenID != \"\") {\r\n                Wechat.reportShareBehavior({ operation: 6, strategy: 1, inviteUser: this.shareopenID })\r\n                this.shareopenID = \"\"\r\n            }\r\n\r\n            Wechat.reportShareBehavior({ operation: operation, strategy: strategy, currentShow: currentShow })\r\n        }\r\n    }\r\n\r\n    /**\r\n     * 显示激励视频广告\r\n     */\r\n    public showRewardedAd(successCb?: Function, failCb?: Function, forceVideo = false) {\r\n        this.strategy = 1\r\n        if (tyqSDKConfig.isOpenBeHavior && this.channel == Channel.WECHAT) {\r\n            if (Wechat.isShareBehavior()) {\r\n                if (!forceVideo) {\r\n                    tyqAdManager.showAppMessage()\r\n                    this.shareListenerSuccess = successCb\r\n                    this.shareListenerFail = failCb\r\n                    Wechat.reportShareBehavior({ operation: 2, strategy: 1, currentShow: 1 })\r\n                    return\r\n                } else {\r\n                    this.strategy = 0\r\n                    Wechat.reportShareBehavior({ operation: 2, strategy: 0, currentShow: 0 })\r\n                }\r\n            } else {\r\n                Wechat.reportShareBehavior({ operation: 2, strategy: 1, currentShow: 0 })\r\n            }\r\n        }\r\n\r\n        if (tyqSDKConfig.isCloseAd) {\r\n            successCb && successCb()\r\n            return\r\n        }\r\n\r\n        if (this.channel == Channel.ANDROID_233) {\r\n            this.videoCallBack = successCb\r\n            this.videoCallBackFail = failCb\r\n            // console.log(\" NATIVE android 平台 \")\r\n            if (!native.reflection.callStaticMethod(\"com/cocos/game/MetaAdApiUtil\", \"RewardVideoShow\", \"(Ljava/lang/String;)Z\", \"展示广告\")) {\r\n                failCb && failCb();\r\n            }\r\n            return\r\n        }\r\n        if (this.channel == Channel.ANDROID_4399) {\r\n            this.videoCallBack = successCb\r\n            this.videoCallBackFail = failCb\r\n            console.log(\" NATIVE android 平台 com/cocos/game/SdkUtil4399\")\r\n            if (!native.reflection.callStaticMethod(\"com/cocos/game/SdkUtil4399\", \"RewardVideoShow\", \"(Ljava/lang/String;)Z\", \"展示广告\")) {\r\n                failCb && failCb();\r\n            }\r\n            return\r\n        }\r\n\r\n        if (this.channel == Channel.WECHAT) {\r\n            Wechat.showRewardVideoAd(() => {\r\n                this.adShowType = tyqSDKConfig.adShowTypes.rewardedAd;\r\n            }).then((isSuccess) => {\r\n                this.adShowType = \"\";\r\n                if (isSuccess) {\r\n                    if (successCb) {\r\n                        successCb();\r\n                    }\r\n                } else {\r\n                    this.reportShareBehavior(5, this.strategy, 0)\r\n                    if (failCb) {\r\n                        failCb();\r\n                    }\r\n                }\r\n            }, () => {\r\n                this.adShowType = \"\";\r\n                this.reportShareBehavior(5, this.strategy, 0)\r\n                if (failCb) {\r\n                    failCb();\r\n                }\r\n            });\r\n        }\r\n\r\n        if (this.channel == Channel.VIVO_MINI_GAME) {\r\n            VivoManager.showRewardVideoAd((state) => {\r\n                if (state == 1) {\r\n                    successCb && successCb()\r\n                } else {\r\n                    failCb && failCb(state)\r\n                }\r\n            })\r\n            return\r\n        }\r\n    }\r\n\r\n\r\n}\r\n\r\nexport const tyqAdManager = TyqAdManager.instance;\r\n"]}