{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/cocos/layer/TyqBaseLayer.ts"],"names":["TyqBaseLayer","Button","Component","find","Label","RichText","tyqSDK","tyqLayerManager","obj","cb","layerName","pathNodeObj","Map","onLoad","addButtonListener","node","addPathNode","path","set","chs","children","i","len","length","pNode","name","getNodeByPath","get","getComponent","on","preOnButtonClick","max","ch","btn","log","onButtonClick","openLayer","data","closeLayer","setString","info","label","string","rich"],"mappings":"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","sourcesContent":["\r\nimport { Button, Component, find, Label, Node, RichText } from 'cc';\r\nimport { tyqSDK } from '../../tyqSDK';\r\nimport { tyqLayerManager } from '../manager/tyqLayerManager';\r\n\r\nexport class TyqBaseLayer extends Component {\r\n\r\n    public obj: any = {};\r\n    public cb: Function;\r\n    public layerName: string = \"DefaultLayer\";\r\n\r\n    // {路径:节点对象}\r\n    public pathNodeObj: Map<string, Node> = new Map();\r\n\r\n    onLoad() {\r\n        this.addButtonListener(this.node);\r\n        this.addPathNode(this.node, \"\");\r\n    }\r\n\r\n    addPathNode(node: Node, path: string) {\r\n        if (node != this.node) {\r\n            this.pathNodeObj.set(path, node);\r\n        }\r\n        if (path) {\r\n            path += \"/\";\r\n        }\r\n        let chs = node.children;\r\n        for (let i = 0, len = chs.length; i < len; i++) {\r\n            let pNode = chs[i];\r\n            this.addPathNode(pNode, path + pNode.name);\r\n        }\r\n    }\r\n\r\n    getNodeByPath(path: string) {\r\n        let node = this.pathNodeObj.get(path);\r\n        if (node) {\r\n            return node;\r\n        }\r\n\r\n        node = find(path, this.node);\r\n        if (node) {\r\n            this.pathNodeObj.set(path, node);\r\n            return node;\r\n        }\r\n\r\n        return null;\r\n    }\r\n\r\n    addButtonListener(node: Node) {\r\n        if (node.getComponent(Button)) {\r\n            node.on(\"click\", this.preOnButtonClick, this);\r\n        }\r\n\r\n        let chs = node.children;\r\n        for (let i = 0, max = chs.length; i < max; i++) {\r\n            let ch = chs[i];\r\n            this.addButtonListener(ch);\r\n        }\r\n\r\n    };\r\n\r\n    preOnButtonClick(btn: any) {\r\n        let node = btn.node;\r\n        let name = node.name;\r\n        tyqSDK.log(this.layerName + \" onButtonClick \" + name);\r\n\r\n        this.onButtonClick(node, node.name);\r\n\r\n    }\r\n\r\n    onButtonClick(node: Node, name: String) {\r\n\r\n    }\r\n\r\n    openLayer(layerName: string, data?: any, cb?: Function) {\r\n        tyqLayerManager.openLayer(layerName, data, cb);\r\n    }\r\n\r\n    closeLayer() {\r\n        tyqLayerManager.closeLayer(this);\r\n    }\r\n\r\n    setString(node: Node, info: any) {\r\n        info = info + \"\";\r\n        let label = node.getComponent(Label);\r\n        if (label) {\r\n            label.string = info;\r\n            return;\r\n        }\r\n\r\n        let rich = node.getComponent(RichText);\r\n        if (rich) {\r\n            rich.string = info;\r\n            return;\r\n        }\r\n    }\r\n}\r\n\r\n"]}