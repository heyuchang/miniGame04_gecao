{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/DayTaskLayer.ts"],"names":["find","_decorator","tyqSDK","cocosUtil","utilTools","constants","msgac","designManager","eventManager","playerModel","UserData","BaseLayer","ccclass","property","DayTaskLayer","flagArr","taskListNode","onLoad","getNodeByPath","onEnable","addEventArr","overDay","onDisable","onDestroy","initUI","refreshTopLayer","tb","getTable","tableName","dayTask","arr","i","length","row","task","id","push","sortArr","task1","task2","row1","getRowById","row2","info1","getTaskInfoById","info2","v1","num","needNum","v2","getAward","scrollViewSetData","refreshTaskItem","bind","actNum","getInstance","dayAct","setString","setProgressBar","chs","children","itemUI","index","shineNode","iconNode","openNode","active","flag","getAwardFlag","dayTaskObj","awardFlagArr","indexOf","tweenBreath","info","forEach","awardItem","propId","award","propNum","setPropItem","btnText","btnGet","btnGo","doneNode","item","type","config","taskDoge","$freeDraw","getChildByName","overDayRet","processEvent","ac","data","onButtonClick","node","name","onClickBoxItem","awardArr","propItem","addPropNum","eventSendCustomEvent","openAwardGetLayer","openAwardInfoLayer","onClickBtnGo","obj","layerName","layers","DaySignLayer","taskGo","send","jumpLayer","closeLayer","onClickBtnGet","addPropArrByDesign","scrollViewRefreshList","refreshRedPoint","onClickAwardItem","openPropInfoLayer2"],"mappings":"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","sourcesContent":["import { find, Node, _decorator } from 'cc';\r\nimport { tyqSDK } from '../../../tyqSDK/tyqSDK';\r\nimport { cocosUtil } from '../../../utils/cocosUtil';\r\nimport { utilTools } from '../../../utils/utilTools';\r\nimport { constants } from '../../data/constants';\r\nimport { msgac } from '../../data/msgac';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { eventManager } from '../../manager/eventManager';\r\nimport { playerModel } from '../../model/playerModel';\r\nimport { UserData } from '../../model/UserData';\r\nimport { BaseLayer } from '../base/BaseLayer';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('DayTaskLayer')\r\nexport class DayTaskLayer extends BaseLayer {\r\n\r\n    flagArr = [25, 50, 75, 100];\r\n    taskListNode: Node;\r\n\r\n    // preLoadAssetConfigArr = [\r\n    //     { bundle: \"ui\", path: \"day_task/item_bg\", type: SpriteFrame }\r\n    // ];\r\n\r\n    onLoad() {\r\n        super.onLoad();\r\n\r\n        this.taskListNode = this.getNodeByPath(\"ui/listbg/list\");\r\n\r\n        // test\r\n        // UserData.getInstance().addPropNum(constants.propIds.dayAct, 90);\r\n        // delete playerModel.dayTaskObj;\r\n\r\n    }\r\n\r\n    onEnable() {\r\n        super.onEnable();\r\n\r\n        this.addEventArr([\r\n            msgac.overDay\r\n        ]);\r\n    }\r\n\r\n    onDisable() {\r\n        super.onDisable();\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    initUI() {\r\n        this.refreshTopLayer();\r\n\r\n        let tb = designManager.getTable(constants.tableName.dayTask);\r\n        let arr = [];\r\n        for (let i = 0; i < tb.length; i++) {\r\n            let row = tb[i];\r\n            let task: any = {};\r\n            task.id = row.id;\r\n            arr.push(task);\r\n        }\r\n\r\n        // 排序 已完成(未领取)-进度快-已领取\r\n        utilTools.sortArr(arr, (task1: any, task2: any) => {\r\n            let row1 = designManager.getRowById(constants.tableName.dayTask, task1.id);\r\n            let row2 = designManager.getRowById(constants.tableName.dayTask, task2.id);\r\n            let info1 = playerModel.getTaskInfoById(task1.id);\r\n            let info2 = playerModel.getTaskInfoById(task2.id);\r\n            let v1 = info1.num / row1.needNum;\r\n            let v2 = info2.num / row2.needNum;\r\n            if (info1.getAward) {\r\n                v1 = -1;\r\n            }\r\n            if (info2.getAward) {\r\n                v2 = -1;\r\n            }\r\n            if (v1 < v2) {\r\n                return true;\r\n            }\r\n            return false;\r\n        });\r\n\r\n        this.scrollViewSetData(this.taskListNode, arr, this.refreshTaskItem.bind(this), true, true);\r\n\r\n    }\r\n\r\n    refreshTopLayer() {\r\n        let actNum = UserData.getInstance().dayAct;\r\n        this.setString(this.getNodeByPath(\"ui/top/act/num\"), actNum);\r\n        this.setProgressBar(this.getNodeByPath(\"ui/top/progress\"), actNum / 100);\r\n\r\n        let chs = this.getNodeByPath(\"ui/top/progress/boxs\").children;\r\n        for (let i = 0; i < chs.length; i++) {\r\n            let itemUI = chs[i];\r\n            itemUI.index = i;\r\n            let num = this.flagArr[i];\r\n            this.setString(find(\"num\", itemUI), num);\r\n            let shineNode = find(\"shine\", itemUI);\r\n            let iconNode = find(\"icon\", itemUI);\r\n            let openNode = find(\"open\", itemUI);\r\n            shineNode.active = false;\r\n            iconNode.active = false;\r\n            openNode.active = false;\r\n            if (actNum >= num) {\r\n                let flag = this.getAwardFlag(i);\r\n                if (playerModel.dayTaskObj.awardFlagArr.indexOf(flag) == -1) {\r\n                    // 还没领取\r\n                    iconNode.active = true;\r\n                    shineNode.active = true;\r\n                    cocosUtil.tweenBreath(shineNode, 0.5, 1.2);\r\n                } else {\r\n                    // 已领取\r\n                    openNode.active = true;\r\n                }\r\n            } else {\r\n                shineNode.active = false;\r\n                iconNode.active = true;\r\n                openNode.active = false;\r\n            }\r\n        }\r\n    }\r\n\r\n    refreshTaskItem(itemUI: any, task: any) {\r\n        let row = designManager.getRowById(constants.tableName.dayTask, task.id);\r\n        this.setString(find(\"info\", itemUI), row.info);\r\n        find(\"awardLayer\", itemUI).children.forEach((awardItem: any, index: number) => {\r\n            let propId = row.award[index][0];\r\n            let propNum = row.award[index][1];\r\n            this.setPropItem(propId, find(\"icon\", awardItem), propNum, null, find(\"num/val\", awardItem));\r\n            awardItem.award = row.award[index];\r\n        });\r\n        let info = playerModel.getTaskInfoById(row.id);\r\n        let num = info.num;\r\n        if (row.id == 1 && num > 1) {\r\n            num = 1;\r\n        }\r\n        this.setString(find(\"progress/hint\", itemUI), num + \"/\" + row.needNum);\r\n        this.setProgressBar(find(\"progress\", itemUI), info.num / row.needNum);\r\n        this.setString(find(\"btnGo/text\", itemUI), row.btnText);\r\n\r\n        let btnGet = find(\"btnGet\", itemUI);\r\n        let btnGo = find(\"btnGo\", itemUI);\r\n        let doneNode = find(\"done\", itemUI);\r\n        btnGet.item = task;\r\n        btnGo.item = task;\r\n        btnGet.active = false;\r\n        btnGo.active = false;\r\n        doneNode.active = false;\r\n        if (info.num >= row.needNum) {\r\n            if (info.getAward) {\r\n                doneNode.active = true;\r\n            } else {\r\n                btnGet.active = true;\r\n            }\r\n        } else {\r\n            btnGo.active = true;\r\n        }\r\n\r\n        if (row.type == 3 && designManager.config.taskDoge > UserData.getInstance().$freeDraw) {\r\n            btnGo.getChildByName(\"hand\").active = true\r\n        } else {\r\n            btnGo.getChildByName(\"hand\").active = false\r\n        }\r\n    }\r\n\r\n    overDayRet() {\r\n        this.initUI();\r\n    }\r\n\r\n    getAwardFlag(index: number) {\r\n        return \"dayTaskAward\" + (index + 1);\r\n    }\r\n\r\n    processEvent(ac: any, data: any) {\r\n        switch (ac) {\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onButtonClick(node: Node, name: string) {\r\n        switch (name) {\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onClickBoxItem(node: any) {\r\n        let awardArr = [];\r\n        for (let i = 0; i < this.flagArr.length; i++) {\r\n            let flag = this.getAwardFlag(i);\r\n            let award = designManager.config[flag];\r\n            let num = this.flagArr[i];\r\n            let actNum = UserData.getInstance().dayAct;\r\n            if (actNum < num) {\r\n                // 还未达成\r\n                continue;\r\n            }\r\n            if (playerModel.dayTaskObj.awardFlagArr.indexOf(flag) != -1) {\r\n                // 已领取奖励\r\n                continue;\r\n            }\r\n            let propItem = UserData.getInstance().addPropNum(award[0], award[1]);\r\n            playerModel.dayTaskObj.awardFlagArr.push(flag);\r\n            awardArr.push(propItem);\r\n            tyqSDK.eventSendCustomEvent(\"每日任务-完成\" + this.flagArr[i])\r\n        }\r\n        if (awardArr.length > 0) {\r\n            this.openAwardGetLayer(awardArr);\r\n            this.refreshTopLayer();\r\n        } else {\r\n            let flag = this.getAwardFlag(node.index);\r\n            let award = designManager.config[flag];\r\n            this.openAwardInfoLayer([award]);\r\n        }\r\n    }\r\n\r\n    onClickBtnGo(node: any) {\r\n        let row = designManager.getRowById(constants.tableName.dayTask, node.item.id);\r\n        let obj: any = {};\r\n        switch (row.type) {\r\n            case 2:\r\n                obj.layerName = constants.layers.DaySignLayer;\r\n                break;\r\n            case 3:\r\n                obj.layerName = \"ShopLayer\";\r\n                obj.taskGo = true\r\n                break;\r\n            case 4:\r\n            case 5:\r\n            case 6:\r\n            case 7:\r\n            case 10:\r\n                obj.layerName = \"MainLayer\";\r\n                break;\r\n            case 8:\r\n                obj.layerName = \"PatrolLayer\";\r\n                break;\r\n            case 9:\r\n                obj.layerName = \"BlessLayer\";\r\n                break;\r\n            case 11:\r\n                obj.layerName = \"RewardItemLayer\";\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        eventManager.send(msgac.jumpLayer, obj);\r\n        this.closeLayer();\r\n    }\r\n\r\n    onClickBtnGet(node: any) {\r\n        let info = playerModel.getTaskInfoById(node.item.id);\r\n        let row = designManager.getRowById(constants.tableName.dayTask, node.item.id);\r\n        if (info.getAward) {\r\n            // 已领取\r\n            return;\r\n        }\r\n        if (info.num < row.needNum) {\r\n            // 还未完成\r\n            return;\r\n        }\r\n        let arr = UserData.getInstance().addPropArrByDesign(row.award);\r\n        this.openAwardGetLayer(arr);\r\n        info.getAward = 1;\r\n        this.refreshTopLayer();\r\n        this.scrollViewRefreshList(this.taskListNode);\r\n        eventManager.send(msgac.refreshRedPoint);\r\n        tyqSDK.eventSendCustomEvent(\"每日任务-参与领取奖励\")\r\n    }\r\n\r\n    onClickAwardItem(node: any) {\r\n        let award = node.award;\r\n        this.openPropInfoLayer2(award[0], award[1]);\r\n    }\r\n\r\n}\r\n\r\n"]}