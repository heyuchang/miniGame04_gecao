{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/skill/Skill2.ts"],"names":["Component","_decorator","cocosUtil","utilTools","mapModel","physicsGroup","ccclass","property","Skill2","skill","isShowing","timeCount","bulletArr","init","showDisks","arr","getCircleDirectionArr","row","num","forArr","direction","extraObj","endCb","bullet","isValid","node","recycleSelf","indexOf","push","bulletSystem","addBullet","bulletId","PLAYER_BULLET2","hideDisks","isAtOnce","forEach","bulletUtil","hide","updateLogic","dt","getAtkCd","scheduleOnce","getDuration","forceDestroy"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,U,OAAAA,U;;AACXC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;;;;;;;;OAGH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U,GAE9B;;wBAEaO,M,WADZF,OAAO,CAAC,QAAD,C,gBAAR,MACaE,MADb,SAC4BR,SAD5B,CACsC;AAAA;AAAA;AAAA,eAElCS,KAFkC;AAAA,eAIlCC,SAJkC,GAIb,KAJa;AAAA,eAKlCC,SALkC,GAKd,CALc;AAAA,eAOlCC,SAPkC;AAAA;;AASlCC,QAAAA,IAAI,CAACJ,KAAD,EAAe;AACf,eAAKA,KAAL,GAAaA,KAAb;AACA,eAAKG,SAAL,GAAiB,EAAjB;AAEA,eAAKF,SAAL,GAAiB,KAAjB;AACH;;AAEDI,QAAAA,SAAS,GAAG;AACR,cAAIC,GAAG,GAAG;AAAA;AAAA,sCAAUC,qBAAV,CAAgC,KAAKP,KAAL,CAAWQ,GAAX,CAAeC,GAA/C,EAAoD,GAApD,CAAV;AACA;AAAA;AAAA,sCAAUC,MAAV,CAAiBJ,GAAjB,EAAuBK,SAAD,IAAoB;AACtC,gBAAIC,QAAQ,GAAG;AACXD,cAAAA,SAAS,EAAEA,SADA;AAEXE,cAAAA,KAAK,EAAGC,MAAD,IAAoB;AACvB,oBAAI,CAAC;AAAA;AAAA,4CAAUC,OAAV,CAAkB,KAAKC,IAAvB,CAAL,EAAmC;AAC/BF,kBAAAA,MAAM,CAACG,WAAP;AACA;AACH;;AACD,oBAAI,KAAKd,SAAL,CAAee,OAAf,CAAuBJ,MAAvB,KAAkC,CAAC,CAAvC,EAA0C;AACtC,uBAAKX,SAAL,CAAegB,IAAf,CAAoBL,MAApB;AACH;AACJ;AAVU,aAAf;AAYA;AAAA;AAAA,sCAASM,YAAT,CAAsBC,SAAtB,CAAgC,KAAKrB,KAAL,CAAWQ,GAAX,CAAec,QAA/C,EAAyD;AAAA;AAAA,8CAAaC,cAAtE,EAAsF,IAAtF,EAA4F,IAA5F,EAAkGX,QAAlG;AACH,WAdD;AAeH;;AAEDY,QAAAA,SAAS,CAACC,QAAD,EAA4B;AAAA,cAA3BA,QAA2B;AAA3BA,YAAAA,QAA2B,GAAP,KAAO;AAAA;;AACjC,eAAKtB,SAAL,CAAeuB,OAAf,CAAwBZ,MAAD,IAAoB;AACvC,gBAAI;AAAA;AAAA,wCAAUC,OAAV,CAAkBD,MAAlB,CAAJ,EAA+B;AAC3BA,cAAAA,MAAM,CAACa,UAAP,CAAkBC,IAAlB,CAAuBH,QAAvB;AACH;AACJ,WAJD;AAKH;;AAEDI,QAAAA,WAAW,CAACC,EAAD,EAAa;AACpB,cAAI,KAAK7B,SAAT,EAAoB;AAChB;AACH;;AAED,eAAKC,SAAL,IAAkB4B,EAAlB;;AACA,cAAI,KAAK5B,SAAL,GAAiB,KAAKF,KAAL,CAAW+B,QAAX,EAArB,EAA4C;AACxC;AACH;;AAED,eAAK7B,SAAL,GAAiB,CAAjB;AACA,eAAKD,SAAL,GAAiB,IAAjB;AACA,eAAK+B,YAAL,CAAkB,MAAM;AACpB,iBAAK/B,SAAL,GAAiB,KAAjB;AACA,iBAAKuB,SAAL;AACH,WAHD,EAGG,KAAKxB,KAAL,CAAWiC,WAAX,EAHH;AAKA,eAAK5B,SAAL;AACH;;AAED6B,QAAAA,YAAY,GAAG;AACX,eAAKV,SAAL,CAAe,IAAf;AACH;;AAjEiC,O","sourcesContent":["import { Component, _decorator } from 'cc';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nimport { utilTools } from '../../../../utils/utilTools';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { physicsGroup } from '../../../other/physicsGroup';\r\nimport { Bullet } from '../bullet/Bullet';\r\nimport { Skill } from './Skill';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 转盘\r\n@ccclass('Skill2')\r\nexport class Skill2 extends Component {\r\n\r\n    skill: Skill;\r\n\r\n    isShowing: boolean = false;\r\n    timeCount: number = 0;\r\n\r\n    bulletArr: Bullet[];\r\n\r\n    init(skill: Skill) {\r\n        this.skill = skill;\r\n        this.bulletArr = [];\r\n\r\n        this.isShowing = false;\r\n    }\r\n\r\n    showDisks() {\r\n        let arr = cocosUtil.getCircleDirectionArr(this.skill.row.num, 160);\r\n        utilTools.forArr(arr, (direction: any) => {\r\n            let extraObj = {\r\n                direction: direction,\r\n                endCb: (bullet: Bullet) => {\r\n                    if (!cocosUtil.isValid(this.node)) {\r\n                        bullet.recycleSelf();\r\n                        return;\r\n                    }\r\n                    if (this.bulletArr.indexOf(bullet) == -1) {\r\n                        this.bulletArr.push(bullet);\r\n                    }\r\n                }\r\n            };\r\n            mapModel.bulletSystem.addBullet(this.skill.row.bulletId, physicsGroup.PLAYER_BULLET2, null, null, extraObj);\r\n        });\r\n    }\r\n\r\n    hideDisks(isAtOnce: boolean = false) {\r\n        this.bulletArr.forEach((bullet: Bullet) => {\r\n            if (cocosUtil.isValid(bullet)) {\r\n                bullet.bulletUtil.hide(isAtOnce);\r\n            }\r\n        });\r\n    }\r\n\r\n    updateLogic(dt: number) {\r\n        if (this.isShowing) {\r\n            return;\r\n        }\r\n\r\n        this.timeCount += dt;\r\n        if (this.timeCount < this.skill.getAtkCd()) {\r\n            return;\r\n        }\r\n\r\n        this.timeCount = 0;\r\n        this.isShowing = true;\r\n        this.scheduleOnce(() => {\r\n            this.isShowing = false;\r\n            this.hideDisks();\r\n        }, this.skill.getDuration());\r\n\r\n        this.showDisks();\r\n    }\r\n\r\n    forceDestroy() {\r\n        this.hideDisks(true);\r\n    }\r\n\r\n}\r\n\r\n"]}