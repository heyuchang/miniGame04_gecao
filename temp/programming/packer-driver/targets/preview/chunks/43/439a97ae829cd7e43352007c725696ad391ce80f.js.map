{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/LevelLayer.ts"],"names":["instantiate","Label","Node","PageView","Sprite","_decorator","myLog","constants","audioManager","designManager","UserData","BaseUILayer","ccclass","property","LevelLayer","type","tooltip","_curPageId","_curOpenLevel","onLoad","mapData","getRowsByType","tableName","map","mapTypes","main","i","getInstance","openLevel","forEach","element","index","item","mapItem","pageContent","addChild","icon","getChildByName","iconIndex","id","setSpriteFrame2","bundles","wwqVec","getComponent","color","colors","white","parseColor","active","yin","start","curMap","getCurMap","mapPage","scrollToPage","setPage","getTable","mapName","mapInfo","string","console","log","selectBtn","scrowPage","event","_curPageIdx","onEnable","onDisable","onDestroy","chooseMap","setCurMap","openLayer","layers","HomeLayer","closeLayer","playEffect","backHome"],"mappings":"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","sourcesContent":["import { instantiate, Label, Node, PageView, Sprite, _decorator } from 'cc';\r\nimport { myLog } from '../../../common/myLog';\r\nimport { constants } from '../../data/constants';\r\nimport { audioManager } from '../../manager/audioManager';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { UserData } from '../../model/UserData';\r\nimport { BaseUILayer } from './BaseUILayer';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('LevelLayer')\r\nexport class LevelLayer extends BaseUILayer {\r\n    @property({ type: Node, tooltip: \"地图名字\" }) mapName: Node = null;\r\n    @property({ type: Node, tooltip: \"地图节点\" }) mapItem: Node = null;\r\n    @property({ type: Node, tooltip: \"pageView\" }) pageContent: Node = null;\r\n    @property({ type: Node, tooltip: \"选择按钮\" }) selectBtn: Node = null;\r\n\r\n    @property({ type: Label, tooltip: \"地图详情\" }) mapInfo: Label = null;\r\n    @property({ type: PageView, tooltip: \"地图\" }) mapPage: PageView = null;\r\n\r\n\r\n    _curPageId = 0\r\n    _curOpenLevel = 1\r\n\r\n    onLoad() {\r\n        let mapData = designManager.getRowsByType(constants.tableName.map, constants.mapTypes.main)\r\n        myLog.i(\"----- LevelLayer\", mapData)\r\n        this._curOpenLevel = UserData.getInstance().openLevel\r\n        mapData.forEach((element, index) => {\r\n            let item = instantiate(this.mapItem)\r\n            this.pageContent.addChild(item)\r\n            let icon = item.getChildByName(\"icon\")\r\n            let iconIndex = (mapData[index].id - 1) % 2 + 1;\r\n            this.setSpriteFrame2(icon, \"homeLayer/ui_map\" + iconIndex, null, constants.bundles.wwqVec)\r\n            if (mapData[index].id <= this._curOpenLevel) {\r\n                icon.getComponent(Sprite).color = constants.colors.white.parseColor()\r\n                item.getChildByName(\"lock\").active = false\r\n            } else {\r\n                icon.getComponent(Sprite).color = constants.colors.yin.parseColor()\r\n                item.getChildByName(\"lock\").active = true\r\n            }\r\n        });\r\n    }\r\n\r\n    start() {\r\n        let curMap = UserData.getInstance().getCurMap() - 1\r\n        // this.setPage(curMap)\r\n        this.mapPage.scrollToPage(curMap)\r\n        this.setPage(curMap)\r\n    }\r\n\r\n    setPage(index) {\r\n        let mapData = designManager.getTable(constants.tableName.map)\r\n        this.setSpriteFrame2(this.mapName, \"homeLayer/map_name\" + (mapData[index].id), null, constants.bundles.wwqVec)\r\n\r\n        this.mapInfo.string = mapData[index].mapInfo\r\n\r\n        console.log(\"mapData[index].id=\", mapData[index].id)\r\n        this._curPageId = mapData[index].id\r\n        this.selectBtn.active = mapData[index].id <= this._curOpenLevel\r\n\r\n    }\r\n\r\n    scrowPage(event) {\r\n        myLog.i(\"event \", event)\r\n        this.setPage(event._curPageIdx)\r\n    }\r\n\r\n    onEnable() {\r\n    }\r\n\r\n    onDisable() {\r\n    }\r\n\r\n    onDestroy() {\r\n    }\r\n\r\n    chooseMap() {\r\n        UserData.getInstance().setCurMap(this._curPageId)\r\n        this.openLayer(constants.layers.HomeLayer);\r\n        this.closeLayer()\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n    }\r\n\r\n    backHome() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        myLog.i(\"backHome\")\r\n        this.openLayer(constants.layers.HomeLayer);\r\n        this.closeLayer()\r\n    }\r\n\r\n}\r\n\r\n"]}