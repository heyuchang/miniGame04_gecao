{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/DaySignLayer.ts"],"names":["find","Tween","_decorator","sdkManager","Channel","tyqAdManager","tyqSDK","cocosUtil","constants","localText","msgac","designManager","eventManager","playerModel","UserData","BaseLayer","ccclass","property","DaySignLayer","itemUIArr","awardDay","onLoad","itemLayer","getNodeByPath","propItem","i","instantiate","parent","itemLayer2","pos","getPosition","y","position","children","forEach","itemUI","push","getChannel","OPPO_MINI_GAME","daySignObj","notBox","onEnable","onDisable","onDestroy","initUI","now","Date","day","Math","floor","getTime","startTime","times","length","row","getRowById","tableName","daySign","setPropItem","award","setString","dayIndex","format","getNode","patchNode","targetNode","active","hasGet","awardDayArr","indexOf","stopAllByTarget","tweenBlink","ci","setProgressBar","refreshFinalAwardLayer","refreshBoxLayer","lockNode","finalAward","processEvent","ac","data","onButtonClick","node","name","signWithDay","double","awardArr","getInstance","addPropArrByDesign","openAwardGetLayer","send","refreshRedPoint","onClickBtnGetAward","createNotice","daySignOutdate","daySignHasGet","addDayTaskNum","eventSendCustomEvent","openAd","st","onClickBtnPatch","targetDay","daySignNoLeave","onClickBtnBox","onClickExtraAward","daySignFinalAwardHint","addPropByDesign","config","daySignFinalAward"],"mappings":"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","sourcesContent":["import { find, Node, Tween, _decorator } from 'cc';\r\nimport { sdkManager } from '../../../sdk/sdkManager';\r\nimport { Channel, tyqAdManager } from '../../../tyqSDK/tyqAdManager';\r\nimport { tyqSDK } from '../../../tyqSDK/tyqSDK';\r\nimport { cocosUtil } from '../../../utils/cocosUtil';\r\nimport { constants } from '../../data/constants';\r\nimport { localText } from '../../data/localText';\r\nimport { msgac } from '../../data/msgac';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { eventManager } from '../../manager/eventManager';\r\nimport { playerModel } from '../../model/playerModel';\r\nimport { UserData } from '../../model/UserData';\r\nimport { BaseLayer } from '../base/BaseLayer';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('DaySignLayer')\r\nexport class DaySignLayer extends BaseLayer {\r\n\r\n    itemUIArr: any = [];\r\n    awardDay: number = 0;\r\n\r\n    onLoad() {\r\n        super.onLoad();\r\n\r\n        let itemLayer = this.getNodeByPath(\"ui/itemLayer\");\r\n        let propItem = find(\"propItem\", itemLayer);\r\n        for (let i = 0; i < 2; i++) {\r\n            cocosUtil.instantiate(propItem).parent = itemLayer;\r\n        }\r\n        let itemLayer2 = cocosUtil.instantiate(itemLayer);\r\n        itemLayer2.parent = itemLayer.parent;\r\n        let pos = itemLayer2.getPosition();\r\n        pos.y -= 150;\r\n        itemLayer2.position = pos;\r\n        cocosUtil.instantiate(propItem).parent = itemLayer;\r\n\r\n        itemLayer.children.forEach((itemUI: Node) => {\r\n            this.itemUIArr.push(itemUI);\r\n        });\r\n        itemLayer2.children.forEach((itemUI: Node) => {\r\n            this.itemUIArr.push(itemUI);\r\n        });\r\n\r\n        // test\r\n        // let startTime = new Date(new Date().getTime() - constants.times.day * 6);\r\n        // startTime.setHours(0);\r\n        // startTime.setMinutes(0);\r\n        // startTime.setSeconds(0);\r\n        // startTime.setMilliseconds(0);\r\n        // playerModel.daySignObj.startTime = startTime;\r\n        // delete playerModel.daySignObj;\r\n\r\n        if(tyqAdManager.getChannel() == Channel.OPPO_MINI_GAME){\r\n            playerModel.daySignObj.notBox = 1\r\n        }\r\n\r\n    }\r\n\r\n    onEnable() {\r\n        super.onEnable();\r\n    }\r\n\r\n    onDisable() {\r\n        super.onDisable();\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    initUI() {\r\n        let now = new Date();\r\n        let day = Math.floor((now.getTime() - playerModel.daySignObj.startTime) / constants.times.day);\r\n        this.awardDay = day;\r\n        for (let i = 0; i < this.itemUIArr.length; i++) {\r\n            let itemUI = this.itemUIArr[i];\r\n            let row = designManager.getRowById(constants.tableName.daySign, i + 1);\r\n            this.setPropItem(row.award[0], find(\"icon\", itemUI), row.award[1], find(\"bg\", itemUI), find(\"num/val\", itemUI));\r\n            this.setString(find(\"day\", itemUI), localText.dayIndex.format(i + 1));\r\n\r\n            let getNode = find(\"get\", itemUI);\r\n            let patchNode = find(\"patch\", itemUI);\r\n            let targetNode = find(\"target\", itemUI);\r\n            getNode.active = false;\r\n            patchNode.active = false;\r\n            targetNode.active = false;\r\n            let hasGet = false;\r\n            if (playerModel.daySignObj.awardDayArr.indexOf(i) != -1) {\r\n                hasGet = true;\r\n            }\r\n            if (hasGet) {\r\n                getNode.active = true;\r\n            } else if (i < day) {\r\n                patchNode.active = true;\r\n            } else if (i == day) {\r\n                targetNode.active = true;\r\n                Tween.stopAllByTarget(targetNode);\r\n                cocosUtil.tweenBlink(targetNode, 0.3);\r\n            }\r\n        }\r\n\r\n        // 已签到次数\r\n        this.setString(this.getNodeByPath(\"ui/bottom/info/has/info/text\"), playerModel.daySignObj.awardDayArr.length + localText.ci);\r\n        // 未签到次数\r\n        this.setString(this.getNodeByPath(\"ui/bottom/info/no/info/text\"), 7 - playerModel.daySignObj.awardDayArr.length + localText.ci);\r\n\r\n        this.setProgressBar(this.getNodeByPath(\"ui/bottom/bar\"), playerModel.daySignObj.awardDayArr.length / 7);\r\n\r\n        this.refreshFinalAwardLayer();\r\n        this.refreshBoxLayer();\r\n    }\r\n\r\n    refreshFinalAwardLayer() {\r\n        let getNode = this.getNodeByPath(\"ui/bottom/extraAward/get\");\r\n        let lockNode = this.getNodeByPath(\"ui/bottom/extraAward/lock\");\r\n        getNode.active = false;\r\n        lockNode.active = false;\r\n        if (playerModel.daySignObj.finalAward) {\r\n            getNode.active = true;\r\n        } else if (playerModel.daySignObj.awardDayArr.length < 7) {\r\n            lockNode.active = true;\r\n        }\r\n    }\r\n\r\n    refreshBoxLayer() {\r\n        if (playerModel.daySignObj.notBox) {\r\n            this.getNodeByPath(\"ui/hintLayer/btnBox/gou\").active = false;\r\n        } else {\r\n            this.getNodeByPath(\"ui/hintLayer/btnBox/gou\").active = true;\r\n        }\r\n    }\r\n\r\n    processEvent(ac: any, data: any) {\r\n        switch (ac) {\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    onButtonClick(node: Node, name: string) {\r\n        switch (name) {\r\n            default:\r\n                break;\r\n        }\r\n    }\r\n\r\n    signWithDay(day: number, double: boolean = false) {\r\n        let row = designManager.getRowById(constants.tableName.daySign, day + 1);\r\n        if (!row) {\r\n            return;\r\n        }\r\n\r\n        let awardArr = [row.award];\r\n        if (double) {\r\n            awardArr.push(row.award);\r\n        }\r\n        awardArr = UserData.getInstance().addPropArrByDesign(awardArr);\r\n        this.openAwardGetLayer(awardArr);\r\n        playerModel.daySignObj.awardDayArr.push(day);\r\n        this.initUI();\r\n        eventManager.send(msgac.refreshRedPoint);\r\n    }\r\n\r\n    onClickBtnGetAward() {\r\n        let row = designManager.getRowById(constants.tableName.daySign, this.awardDay + 1);\r\n        if (!row) {\r\n            this.createNotice(localText.daySignOutdate);\r\n            return;\r\n        }\r\n        if (playerModel.daySignObj.awardDayArr.indexOf(this.awardDay) != -1) {\r\n            // 已领取奖励了\r\n            this.createNotice(localText.daySignHasGet);\r\n            return;\r\n        }\r\n\r\n        playerModel.addDayTaskNum(2);\r\n\r\n        tyqSDK.eventSendCustomEvent(\"签到玩家\")\r\n\r\n        if (playerModel.daySignObj.notBox) {\r\n            this.signWithDay(this.awardDay);\r\n        } else {\r\n            sdkManager.openAd(\"签到双倍奖励\", (st: number) => {\r\n                if (st == 1) {\r\n                    this.signWithDay(this.awardDay, true);\r\n                }\r\n            });\r\n        }\r\n\r\n\r\n    }\r\n\r\n    onClickBtnPatch() {\r\n        let targetDay = -1;\r\n        for (let i = 0; i < 7; i++) {\r\n            if (playerModel.daySignObj.awardDayArr.indexOf(i) == -1) {\r\n                targetDay = i;\r\n                break;\r\n            }\r\n        }\r\n        if (targetDay == -1 || targetDay >= this.awardDay) {\r\n            this.createNotice(localText.daySignNoLeave);\r\n            return;\r\n        }\r\n\r\n        sdkManager.openAd(\"快速补签\", (st: number) => {\r\n            if (st == 1) {\r\n                this.signWithDay(targetDay);\r\n            }\r\n        });\r\n\r\n    }\r\n\r\n    onClickBtnBox() {\r\n        if (playerModel.daySignObj.notBox) {\r\n            playerModel.daySignObj.notBox = 0;\r\n        } else {\r\n            playerModel.daySignObj.notBox = 1;\r\n        }\r\n        this.refreshBoxLayer();\r\n    }\r\n\r\n    onClickExtraAward() {\r\n        if (playerModel.daySignObj.awardDayArr.length < 7) {\r\n            this.createNotice(localText.daySignFinalAwardHint);\r\n            return;\r\n        }\r\n        if (playerModel.daySignObj.finalAward) {\r\n            // 已领取\r\n            this.createNotice(localText.hasGet);\r\n            return;\r\n        }\r\n\r\n        playerModel.daySignObj.finalAward = 1;\r\n        let propItem = UserData.getInstance().addPropByDesign(designManager.config.daySignFinalAward);\r\n        this.openAwardGetLayer([propItem]);\r\n\r\n        this.refreshFinalAwardLayer();\r\n\r\n    }\r\n\r\n}\r\n\r\n"]}