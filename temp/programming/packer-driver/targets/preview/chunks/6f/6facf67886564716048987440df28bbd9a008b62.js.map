{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/network/wmsocket.ts"],"names":["director","_decorator","NATIVE","tyqSDK","GLoginState","GNetCmd","ServerCtr","ccclass","property","WmSocket","getInstance","_instance","constructor","eventHandlers","lastHeartbeatTime","isWsConnect","ws","wxws","msgBuff","isFirst","addListener","on","onReconnect","onClose","StickPack","respStickPack","data","sendStickPack","getGuid","d","Date","getTime","replace","c","r","Math","random","floor","toString","getTotalLen","arr","len","i","length","uuid","sendSP","JSON","stringify","connect","console","log","isConnected","close","ws_connect","WebSocket","getUrl","wsUrl","e","error","onopen","event","GetInstance","wxLoginBegin","onmessage","onMessage","onerror","loginState","loginWithoutAccount","onclose","resp","respJson","parse","emit","cmd","jsonData","send","netdata","ontTimeLimit","str","strArr","n","l","a","slice","push"],"mappings":"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","sourcesContent":["import { director, _decorator } from 'cc';\r\nimport { NATIVE } from 'cc/env';\r\nimport { tyqSDK } from '../tyqSDK';\r\nimport { GLoginState, GNetCmd } from './conf';\r\nimport ServerCtr from './ServerCtr';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('WmSocket')\r\nexport class WmSocket {\r\n\teventHandlers: any = [];\r\n\r\n\tpublic lastHeartbeatTime: number = 0;\r\n\tpublic isWsConnect: boolean = false;\r\n\tws: WebSocket = null!;\r\n\twxws: any = null;\r\n\r\n\tmsgBuff: any = {}; //key为stickId, val为stick数组\r\n\t// Stick_Id = \"stick_id\"\r\n\t// Stick_Len = \"stick_len\"\r\n\t// Stick_No = \"stick_no\" //服务端不处理，只判断字符总长度，前端自己用是否发送结束\r\n\t// Stick_Body = \"stick_val\"\r\n\t/**\r\n\t * 单例\r\n\t */\r\n\tprivate static _instance: WmSocket;\r\n\tpublic static getInstance(): WmSocket {\r\n\t\tif (!this._instance) {\r\n\t\t\tthis._instance = new WmSocket();\r\n\t\t}\r\n\t\treturn this._instance;\r\n\t}\r\n\r\n\tprivate isFirst = true;\r\n\r\n\tconstructor() {\r\n\t\tthis.addListener();\r\n\t}\r\n\r\n\taddListener() {\r\n\t\tdirector.on(\"ws_reconnect\", this.onReconnect, this);\r\n\t\tdirector.on(\"ws_close\", this.onClose, this);\r\n\t\tdirector.on(GNetCmd.StickPack, this.respStickPack, this)\r\n\t}\r\n\r\n\trespStickPack(data: any) {\r\n\t\t// cc.log(\"粘包接受情况--\", data)\r\n\t\tif (data[\"isEnd\"] == false) {\r\n\t\t\tthis.sendStickPack(data[\"stick_id\"], data[\"idx\"] + 1)\r\n\t\t} else {\r\n\t\t\tdelete this.msgBuff[data[\"stick_id\"]] //清空本地缓存\r\n\t\t}\r\n\t}\r\n\r\n\tgetGuid() {\r\n\t\tlet d = new Date().getTime();\r\n\t\treturn 'xxxxxxxx-xxxx-4xxx-yxxx-xxxxxxxxxxxx'.replace(/[xy]/g, function (c) {\r\n\t\t\tlet r = (d + Math.random() * 16) % 16 | 0;\r\n\t\t\td = Math.floor(d / 16);\r\n\t\t\treturn (c == 'x' ? r : (r & 0x3 | 0x8)).toString(16);\r\n\t\t});\r\n\t}\r\n\r\n\tgetTotalLen(arr: any[]) {\r\n\t\tlet len = 0;\r\n\t\tfor (let i = 0; i < arr.length; i++) {\r\n\t\t\tlen += arr[i].length;\r\n\t\t}\r\n\t\treturn len;\r\n\t}\r\n\r\n\tsendStickPack(uuid: string, i: number) {\r\n\t\tlet data = {\r\n\t\t\t\"cmd\": GNetCmd.StickPack,\r\n\t\t\t\"stick_id\": uuid,\r\n\t\t\t\"stick_len\": this.getTotalLen(this.msgBuff[uuid]),\r\n\t\t\t\"stick_val\": this.msgBuff[uuid][i],\r\n\t\t\t\"isEnd\": i == this.msgBuff[uuid].length - 1,\r\n\t\t\t\"isStart\": i == 0,\r\n\t\t\t\"idx\": i\r\n\t\t}\r\n\t\t// cc.log(\"分段存储\", data)\r\n\t\tWmSocket.getInstance().sendSP(JSON.stringify(data));\r\n\t}\r\n\r\n\tonReconnect() {\r\n\t\t// 重连..\r\n\t\tif (this.isFirst) {\r\n\t\t\tthis.isFirst = false;\r\n\t\t\tthis.connect();\r\n\t\t\tconsole.log(\"发起第一次连-------\")\r\n\t\t} else {\r\n\t\t\tif (!this.isConnected()) {\r\n\t\t\t\tthis.connect();\r\n\t\t\t\tconsole.log(\"发起重连-------\")\r\n\t\t\t}\r\n\t\t}\r\n\t}\r\n\r\n\tonClose() {\r\n\t\t// 断开连接..\r\n\t\tif (!this.isConnected()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tif (!WmSocket.getInstance().isWsConnect) {\r\n\t\t\tthis.ws.close();\r\n\t\t} else {\r\n\t\t\tthis.wxws.close();\r\n\t\t}\r\n\t}\r\n\r\n\tconnect() {\r\n\t\tthis.ws_connect();\r\n\t}\r\n\r\n\tws_connect() {\r\n\t\tconsole.log(\"ws_connect...........................\")\r\n\t\ttry {\r\n\t\t\t// let cerUrl = cc.url.raw('resources/ssl/fishing.cer');\r\n\t\t\t// if (cc.loader.md5Pipe) {\r\n\t\t\t// \tcerUrl = cc.loader.md5Pipe.transformURL(cerUrl);\r\n\t\t\t// }\r\n\t\t\t// this._socket = new WebSocket(this._url, [], cerUrl);\r\n\r\n\t\t\t// let pemUrl = cc.url.raw(\"resources/ssl/5556166_obeliskgames.cn.cer\");\r\n\t\t\t// cc.log(pemUrl)\r\n\t\t\t// pemUrl = cc.loader.md5Pipe.transformURL(pemUrl)\r\n\t\t\t// cc.log(pemUrl)\r\n\t\t\t// this.ws = new WebSocket(gl.ws_url,  pemUrl);\r\n\r\n\t\t\tif (NATIVE) {\r\n\t\t\t\t// let pemUrl = ;\r\n\t\t\t\t// pemUrl = loader.md5Pipe.transformURL(pemUrl)\r\n\r\n\t\t\t\t// let cerUrl = url.raw(\"resources/ssl/Digicert-OV-DV-root.cer\");\r\n\t\t\t\t// if (loader.md5Pipe) {\r\n\t\t\t\t// \tcerUrl = loader.md5Pipe.transformURL(cerUrl);\r\n\t\t\t\t// }\r\n\t\t\t\t// this.ws = new WebSocket(gl.ws_url, null, cerUrl);\r\n\r\n\t\t\t\tthis.ws = new WebSocket(tyqSDK.getUrl().wsUrl); // GNetConf.mrtgd_WsUrl\r\n\r\n\t\t\t\t// assetManager.getBundle('resources').load(\"ssl/www.obeliskgames.cn.cer\", Asset, (err,res)=>{\r\n\t\t\t\t// \t// let pemUrl = url.raw(\"resources/5556166_obeliskgames.cn.cer\");\r\n\t\t\t\t// \t// pemUrl = loader.md5Pipe.transformURL(pemUrl)\r\n\t\t\t\t// \tthis.ws = new WebSocket(gl.ws_url,  res.nativeUrl);\r\n\t\t\t\t// });\r\n\t\t\t} else {\r\n\t\t\t\tthis.ws = new WebSocket(tyqSDK.getUrl().wsUrl);\r\n\t\t\t}\r\n\r\n\r\n\t\t} catch (e) {\r\n\t\t\tconsole.error(\"网络连接异常 --- exception---------------- \", e);\r\n\t\t}\r\n\r\n\t\tthis.ws.onopen = (event) => {\r\n\t\t\tthis.isWsConnect = true;\r\n\t\t\tconsole.log(\"Send Text WS was opened.\");\r\n\t\t\tServerCtr.GetInstance().wxLoginBegin();\r\n\t\t\t// console.log(\"onopen this.ws.readyState:\",this.ws.readyState);\r\n\t\t\t// Notifications.emit(\"ws_connect\",{type:'connect'});\r\n\t\t};\r\n\t\tthis.ws.onmessage = (event) => {\r\n\t\t\t// console.log(\"response text msg: \" + event.data, event.data.toString());\r\n\t\t\t// console.log(\"onmessage this.ws.readyState:\",this.ws.readyState);\r\n\t\t\tthis.onMessage(event.data);\r\n\t\t};\r\n\t\tthis.ws.onerror = (event) => {\r\n\t\t\tconsole.error(\"Send Text fired an error\", event);\r\n\t\t\tServerCtr.GetInstance().loginState = GLoginState.loginWithoutAccount;\r\n\t\t\t// console.log(\"onerror this.ws.readyState:\",this.ws.readyState);\r\n\t\t\t// Notifications.emit(\"ws_connect\",{type:'disconnect'});\r\n\t\t};\r\n\t\tthis.ws.onclose = (event) => {\r\n\t\t\tthis.isWsConnect = false;\r\n\t\t\tconsole.log(\"WebSocket instance closed.\");\r\n\t\t\tServerCtr.GetInstance().loginState = GLoginState.loginWithoutAccount;\r\n\t\t\t// console.log(\"onclose this.ws.readyState:\",this.ws.readyState);\r\n\t\t\t// Notifications.emit(\"ws_connect\",{type:'disconnect'});\r\n\t\t};\r\n\t}\r\n\r\n\r\n\tonMessage(resp: string) {\r\n\t\tlet respJson = JSON.parse(resp)\r\n\t\t// log(\"onMessage resp base64解开后JSON对象:\", respJson)\r\n\t\t// console.log(\"onMessage resp:\", respJson.cmd, respJson)\r\n\t\tdirector.emit(respJson.cmd + \"\", respJson)\r\n\t}\r\n\r\n\tisConnected() {\r\n\t\treturn this.isWsConnect;\r\n\t}\r\n\tsendSP(jsonData: string) {\r\n\t\tif (!this.isConnected()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\tthis.ws.send(jsonData)//NetMgr.getInstance ().jsencrypt()\r\n\t}\r\n\r\n\tsend(netdata: any) {\r\n\t\t// log(\"###isConnected :\",this.isConnected())\r\n\t\tif (!this.isConnected()) {\r\n\t\t\treturn;\r\n\t\t}\r\n\t\t//以下是粘包处理\r\n\t\tlet jsonData = JSON.stringify(netdata.data);\r\n\t\tlet ontTimeLimit = 109586 / 5  //这里差不错20k 109586/5，必须小于80k\r\n\t\t// log(\"-------粘包-------\", jsonData.length, ontTimeLimit, jsonData.length/ontTimeLimit+1)\r\n\t\tif (jsonData.length > ontTimeLimit) {\r\n\t\t\tlet str = jsonData\r\n\t\t\tlet strArr = [];\r\n\t\t\tlet n = jsonData.length / ontTimeLimit + 1;\r\n\t\t\tfor (let i = 0, l = str.length; i < n; i++) {\r\n\t\t\t\tlet a = str.slice(ontTimeLimit * i, ontTimeLimit * (i + 1));\r\n\t\t\t\t// let a = str.substr(i*ontTimeLimit,ontTimeLimit)\r\n\t\t\t\t// log(\"分段存储1111\", a)\r\n\t\t\t\tstrArr.push(a);\r\n\t\t\t}\r\n\t\t\tlet uuid = this.getGuid()\r\n\t\t\tthis.msgBuff[uuid] = strArr\r\n\t\t\tthis.sendStickPack(uuid, 0);\r\n\t\t\treturn\r\n\t\t}\r\n\t\t// let data = JSON.stringify(netdata.data)\r\n\t\t// log(\"### client send data base64处理:\", data)\r\n\t\tthis.ws.send(jsonData) //NetMgr.getInstance ().jsencrypt()\r\n\r\n\t}\r\n\r\n}\r\n\r\n"]}