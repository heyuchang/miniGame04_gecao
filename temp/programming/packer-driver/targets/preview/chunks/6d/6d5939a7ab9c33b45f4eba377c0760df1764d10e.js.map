{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/base/NodePoolUtil.ts"],"names":["Component","Prefab","_decorator","myLog","cocosUtil","utilTools","ccclass","property","NodePoolUtil","itemNode","freeNodeArr","itemNodeArr","onLoad","init","instantiate","getNode","node","shift","e","parent","active","use","recycleNode","indexOf","push","recycleAllNode","forArr","children","forEachUseNode","cb","index"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAiBC,MAAAA,M,OAAAA,M;AAAQC,MAAAA,U,OAAAA,U;;AACzBC,MAAAA,K,iBAAAA,K;;AACAC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;;;OACH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBL,U;;8BAGjBM,Y,WADZF,OAAO,CAAC,cAAD,C,gBAAR,MACaE,YADb,SACkCR,SADlC,CAC4C;AAAA;AAAA;AAAA,eAExCS,QAFwC;AAAA,eAIxCC,WAJwC,GAIrB,EAJqB;AAAA,eAKxCC,WALwC,GAKrB,EALqB;AAAA;;AAOxCC,QAAAA,MAAM,GAAG,CAER;;AAEDC,QAAAA,IAAI,CAACJ,QAAD,EAA0B;AAC1B,cAAIA,QAAQ,YAAYR,MAAxB,EAAgC;AAC5BQ,YAAAA,QAAQ,GAAG;AAAA;AAAA,wCAAUK,WAAV,CAAsBL,QAAtB,CAAX;AACH;;AACD,eAAKA,QAAL,GAAgBA,QAAhB;AACH;;AAEDM,QAAAA,OAAO,GAAG;AACN,cAAIC,IAAI,GAAG,KAAKN,WAAL,CAAiBO,KAAjB,EAAX;;AACA,cAAI,CAACD,IAAL,EAAW;AACP,gBAAI,CAAC,KAAKP,QAAV,EAAoB;AAChB;AAAA;AAAA,kCAAMS,CAAN,CAAQ,KAAKF,IAAb;AACH;;AACDA,YAAAA,IAAI,GAAG;AAAA;AAAA,wCAAUF,WAAV,CAAsB,KAAKL,QAA3B,CAAP;AACAO,YAAAA,IAAI,CAACG,MAAL,GAAc,KAAKH,IAAnB;AACH;;AACD,cAAI,CAACA,IAAI,CAACI,MAAV,EAAkB;AACdJ,YAAAA,IAAI,CAACI,MAAL,GAAc,IAAd;AACH;;AACDJ,UAAAA,IAAI,CAACK,GAAL,GAAW,IAAX;AAEA,iBAAOL,IAAP;AACH;;AAEDM,QAAAA,WAAW,CAACN,IAAD,EAAa;AACpB,cAAI,CAAC,KAAKP,QAAV,EAAoB;AAChB,iBAAKA,QAAL,GAAgBO,IAAhB;AACH;;AACDA,UAAAA,IAAI,CAACI,MAAL,GAAc,KAAd;;AACA,cAAI,KAAKV,WAAL,CAAiBa,OAAjB,CAAyBP,IAAzB,KAAkC,CAAC,CAAvC,EAA0C;AACtC,iBAAKN,WAAL,CAAiBc,IAAjB,CAAsBR,IAAtB;AACH,WAPmB,CAQpB;;;AACAA,UAAAA,IAAI,CAACK,GAAL,GAAW,KAAX;AACH;;AAEDI,QAAAA,cAAc,GAAG;AACb;AAAA;AAAA,sCAAUC,MAAV,CAAiB,KAAKV,IAAL,CAAUW,QAA3B,EAAsCX,IAAD,IAAgB;AACjD,iBAAKM,WAAL,CAAiBN,IAAjB;AACH,WAFD;AAGH;;AAEDY,QAAAA,cAAc,CAACC,EAAD,EAAe;AACzB;AAAA;AAAA,sCAAUH,MAAV,CAAiB,KAAKV,IAAL,CAAUW,QAA3B,EAAqC,CAACX,IAAD,EAAYc,KAAZ,KAA8B;AAC/D,gBAAI,CAACd,IAAI,CAACK,GAAV,EAAe;AACX;AACH;;AACDQ,YAAAA,EAAE,CAACb,IAAD,EAAOc,KAAP,CAAF;AACH,WALD;AAMH;;AA5DuC,O","sourcesContent":["import { Component, Node, Prefab, _decorator } from 'cc';\r\nimport { myLog } from '../../../common/myLog';\r\nimport { cocosUtil } from '../../../utils/cocosUtil';\r\nimport { utilTools } from '../../../utils/utilTools';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('NodePoolUtil')\r\nexport class NodePoolUtil extends Component {\r\n\r\n    itemNode: any;\r\n\r\n    freeNodeArr: any = [];\r\n    itemNodeArr: any = [];\r\n\r\n    onLoad() {\r\n\r\n    }\r\n\r\n    init(itemNode: Node | Prefab) {\r\n        if (itemNode instanceof Prefab) {\r\n            itemNode = cocosUtil.instantiate(itemNode);\r\n        }\r\n        this.itemNode = itemNode;\r\n    }\r\n\r\n    getNode() {\r\n        let node = this.freeNodeArr.shift();\r\n        if (!node) {\r\n            if (!this.itemNode) {\r\n                myLog.e(this.node);\r\n            }\r\n            node = cocosUtil.instantiate(this.itemNode);\r\n            node.parent = this.node;\r\n        }\r\n        if (!node.active) {\r\n            node.active = true;\r\n        }\r\n        node.use = true;\r\n\r\n        return node;\r\n    }\r\n\r\n    recycleNode(node: Node) {\r\n        if (!this.itemNode) {\r\n            this.itemNode = node;\r\n        }\r\n        node.active = false;\r\n        if (this.freeNodeArr.indexOf(node) == -1) {\r\n            this.freeNodeArr.push(node);\r\n        }\r\n        // @ts-ignore\r\n        node.use = false;\r\n    }\r\n\r\n    recycleAllNode() {\r\n        utilTools.forArr(this.node.children, (node: Node) => {\r\n            this.recycleNode(node);\r\n        });\r\n    }\r\n\r\n    forEachUseNode(cb: Function) {\r\n        utilTools.forArr(this.node.children, (node: any, index: number) => {\r\n            if (!node.use) {\r\n                return;\r\n            }\r\n            cb(node, index);\r\n        });\r\n    }\r\n\r\n}\r\n\r\n"]}