{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/item/bullet/Bullet1102.ts"],"names":["Component","macro","Vec2","_decorator","cocosUtil","mapModel","physicsGroup","HintNames","ccclass","property","bullet1102","bullet","outScreenNotRecycle","targetPos","hint","init","extraObj","scheduleOnce","isFollow","rotateSpeed","Math","PI","random","hintSystem","addHint","targetPos2","convertToWorldSpaceWithPos","node","isValid","activeInHierarchy","recycleSelf","schedule","dt","speed","distance","getPosition","arriveTargetPos","REPEAT_FOREVER","bulletSystem","addBullet","id","PLAYER_BULLET","convertToWorldSpace"],"mappings":";;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AAASA,MAAAA,S,OAAAA,S;AAAWC,MAAAA,K,OAAAA,K;AAAOC,MAAAA,I,OAAAA,I;AAAYC,MAAAA,U,OAAAA,U;;AAC9BC,MAAAA,S,iBAAAA,S;;AACAC,MAAAA,Q,iBAAAA,Q;;AACAC,MAAAA,Y,iBAAAA,Y;;AACAC,MAAAA,S,iBAAAA,S;;;;;;;;;OAEH;AAAEC,QAAAA,OAAF;AAAWC,QAAAA;AAAX,O,GAAwBN,U,GAE9B;;4BAEaO,U,WADZF,OAAO,CAAC,YAAD,C,gBAAR,MACaE,UADb,SACgCV,SADhC,CAC0C;AAAA;AAAA;AAAA,eAEtCW,MAFsC;AAAA,eAItCC,mBAJsC,GAIP,IAJO;AAAA,eAMtCC,SANsC;AAAA,eAOtCC,IAPsC;AAAA;;AAStCC,QAAAA,IAAI,CAACJ,MAAD,EAAiB;AACjB,eAAKA,MAAL,GAAcA,MAAd;AACA,eAAKE,SAAL,GAAiB,KAAKF,MAAL,CAAYK,QAA7B;AACA,eAAKF,IAAL,GAAY,IAAZ;AAEA,eAAKG,YAAL,CAAkB,MAAM;AACpB,iBAAKN,MAAL,CAAYO,QAAZ,GAAuB,IAAvB;AACA,iBAAKP,MAAL,CAAYQ,WAAZ,GAA0BC,IAAI,CAACC,EAAL,GAAU,CAApC;AACH,WAHD,EAGG,OAAOD,IAAI,CAACE,MAAL,KAAgB,IAH1B;AAKA;AAAA;AAAA,oCAASC,UAAT,CAAoBC,OAApB,CAA4B;AAAA;AAAA,sCAAUC,UAAtC,EAAkD;AAAA;AAAA,sCAAUC,0BAAV,CAAqC,KAAKC,IAA1C,EAAgD,KAAKd,SAArD,CAAlD,EAAmH,CAAnH,EAAuHC,IAAD,IAAe;AACjI,gBAAI,CAAC;AAAA;AAAA,wCAAUc,OAAV,CAAkB,IAAlB,CAAD,IAA4B,CAAC,KAAKD,IAAL,CAAUE,iBAA3C,EAA8D;AAC1Df,cAAAA,IAAI,CAACgB,WAAL;AACA;AACH;;AACD,iBAAKhB,IAAL,GAAYA,IAAZ;AACH,WAND;AAQA,eAAKiB,QAAL,CAAeC,EAAD,IAAgB;AAC1B,gBAAIC,KAAK,GAAG,KAAKtB,MAAL,CAAYsB,KAAxB;AACAA,YAAAA,KAAK,IAAI,EAAT;;AACA,gBAAIA,KAAK,GAAG,GAAZ,EAAiB;AACbA,cAAAA,KAAK,GAAG,GAAR;AACH;;AACD,iBAAKtB,MAAL,CAAYsB,KAAZ,GAAoBA,KAApB;;AACA,gBAAI/B,IAAI,CAACgC,QAAL,CAAc,KAAKrB,SAAnB,EAA8B,KAAKc,IAAL,CAAUQ,WAAV,EAA9B,KAA0D,GAA9D,EAAmE;AAC/D,mBAAKC,eAAL;AACH;AACJ,WAVD,EAUG,GAVH,EAUQnC,KAAK,CAACoC,cAVd;AAWH;;AAEDD,QAAAA,eAAe,GAAG;AACd,eAAKzB,MAAL,CAAYmB,WAAZ;;AACA,cAAI;AAAA;AAAA,sCAAUF,OAAV,CAAkB,KAAKd,IAAvB,CAAJ,EAAkC;AAC9B,iBAAKA,IAAL,CAAUA,IAAV,CAAegB,WAAf;AACH,WAJa,CAKd;;;AACA;AAAA;AAAA,oCAASQ,YAAT,CAAsBC,SAAtB,CAAgC,KAAK5B,MAAL,CAAY6B,EAAZ,GAAiB,CAAjD,EAAoD;AAAA;AAAA,4CAAaC,aAAjE,EAAgF;AAAA;AAAA,sCAAUC,mBAAV,CAA8B,KAAKf,IAAnC,CAAhF;AACH;;AA/CqC,O","sourcesContent":["import { Component, macro, Vec2, Vec3, _decorator } from 'cc';\r\nimport { cocosUtil } from '../../../../utils/cocosUtil';\r\nimport { mapModel } from '../../../model/mapModel';\r\nimport { physicsGroup } from '../../../other/physicsGroup';\r\nimport { HintNames } from '../hint/Hint';\r\nimport { Bullet } from './Bullet';\r\nconst { ccclass, property } = _decorator;\r\n\r\n// 技能-轰炸机-子弹\r\n@ccclass('bullet1102')\r\nexport class bullet1102 extends Component {\r\n\r\n    bullet: Bullet;\r\n    // 不可以自动销毁\r\n    outScreenNotRecycle: boolean = true;\r\n\r\n    targetPos: Vec3;\r\n    hint: any;\r\n\r\n    init(bullet: Bullet) {\r\n        this.bullet = bullet;\r\n        this.targetPos = this.bullet.extraObj;\r\n        this.hint = null;\r\n\r\n        this.scheduleOnce(() => {\r\n            this.bullet.isFollow = true;\r\n            this.bullet.rotateSpeed = Math.PI * 6;\r\n        }, 0.02 + Math.random() * 0.02);\r\n\r\n        mapModel.hintSystem.addHint(HintNames.targetPos2, cocosUtil.convertToWorldSpaceWithPos(this.node, this.targetPos), 0, (hint: any) => {\r\n            if (!cocosUtil.isValid(this) || !this.node.activeInHierarchy) {\r\n                hint.recycleSelf();\r\n                return;\r\n            }\r\n            this.hint = hint;\r\n        });\r\n\r\n        this.schedule((dt: number) => {\r\n            let speed = this.bullet.speed;\r\n            speed -= 20;\r\n            if (speed < 200) {\r\n                speed = 200;\r\n            }\r\n            this.bullet.speed = speed;\r\n            if (Vec2.distance(this.targetPos, this.node.getPosition()) <= 100) {\r\n                this.arriveTargetPos();\r\n            }\r\n        }, 0.1, macro.REPEAT_FOREVER);\r\n    }\r\n\r\n    arriveTargetPos() {\r\n        this.bullet.recycleSelf();\r\n        if (cocosUtil.isValid(this.hint)) {\r\n            this.hint.hint.recycleSelf();\r\n        }\r\n        // 爆炸\r\n        mapModel.bulletSystem.addBullet(this.bullet.id + 1, physicsGroup.PLAYER_BULLET, cocosUtil.convertToWorldSpace(this.node));\r\n    }\r\n\r\n}\r\n\r\n"]}