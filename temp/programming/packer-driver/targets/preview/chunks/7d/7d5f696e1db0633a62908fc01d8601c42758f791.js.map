{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/PatrolFastLayer.ts"],"names":["instantiate","Node","Prefab","_decorator","sdkManager","constants","audioManager","designManager","playerModel","UserData","PropItemPrefab","BaseUILayer","ccclass","property","PatrolFastLayer","type","_rewardArr","onLoad","start","rewardArr","getInstance","getPatrolRewardByTime","config","towerPressTime","index","length","element","item","propIten","getComponent","setView","Id","Num","Type_UnWear","setScale","addPropLayer","addChild","Type_UnKnow","onGetRewardTili","playEffect","power","quickEarn","toast","usePower","getRewardProp","addDayTaskNum","openLayer","layers","RewardLayer","propArr","closeLayer","onGetRewardVideo","openAd","state"],"mappings":"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","sourcesContent":["import { instantiate, Node, Prefab, _decorator } from 'cc';\r\nimport { sdkManager } from '../../../sdk/sdkManager';\r\nimport { constants } from '../../data/constants';\r\nimport { audioManager } from '../../manager/audioManager';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { playerModel } from '../../model/playerModel';\r\nimport { UserData } from '../../model/UserData';\r\nimport { PropItemPrefab } from '../item/PropItemPrefab';\r\nimport { BaseUILayer } from './BaseUILayer';\r\n\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PatrolFastLayer')\r\nexport class PatrolFastLayer extends BaseUILayer {\r\n\r\n\r\n    // @property({ type: Node }) musicToggle: Node = null;\r\n\r\n    @property({ type: Prefab }) propIten: Prefab = null;\r\n    @property({ type: Node }) addPropLayer: Node = null;\r\n\r\n\r\n    _rewardArr = []\r\n\r\n    onLoad() {\r\n        super.onLoad()\r\n    }\r\n\r\n\r\n    start() {\r\n        let rewardArr = UserData.getInstance().getPatrolRewardByTime(designManager.config.towerPressTime * 60)\r\n        this._rewardArr = rewardArr\r\n        for (let index = 0; index < rewardArr.length && index < 2; index++) {\r\n            let element = rewardArr[index];\r\n            let item = instantiate(this.propIten)\r\n            item.getComponent(PropItemPrefab).setView(element.Id, element.Num, PropItemPrefab.Type_UnWear)\r\n            item.getComponent(PropItemPrefab).setScale(100)\r\n            this.addPropLayer.addChild(item)\r\n        }\r\n        let item = instantiate(this.propIten)\r\n        item.getComponent(PropItemPrefab).setView(0, 0, PropItemPrefab.Type_UnKnow)\r\n        item.getComponent(PropItemPrefab).setScale(100)\r\n        this.addPropLayer.addChild(item)\r\n    }\r\n\r\n    onGetRewardTili() {\r\n        //  UserData.getInstance().getCurPatrolData()\r\n        //  this.playCoinFlyAnim(10, v3(0,0,0), v3(0,600,0),null,0)\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        if (UserData.getInstance().power < designManager.config.quickEarn) {\r\n            this.toast(\"体力不足\")\r\n            return\r\n        }\r\n\r\n        UserData.getInstance().usePower(0 - designManager.config.quickEarn)\r\n        UserData.getInstance().getRewardProp(this._rewardArr)\r\n\r\n        playerModel.addDayTaskNum(7, designManager.config.quickEarn);\r\n        playerModel.addDayTaskNum(8);\r\n\r\n        this.openLayer(constants.layers.RewardLayer, { propArr: this._rewardArr })\r\n        this.closeLayer()\r\n    }\r\n\r\n    onGetRewardVideo() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        sdkManager.openAd(\"快速巡逻\", (state: number) => {\r\n            if (state == 1) {\r\n                UserData.getInstance().getRewardProp(this._rewardArr)\r\n                this.closeLayer()\r\n                this.openLayer(constants.layers.RewardLayer, { propArr: this._rewardArr })\r\n                playerModel.addDayTaskNum(8);\r\n            }\r\n        })\r\n        // cc.find('Canvas').addChild(coin);\r\n        //   this.playCoinFlyAnim(10, v3(0,0,0), v3(0,600,0),null,0)\r\n    }\r\n\r\n    closeLayer() {\r\n        audioManager.playEffect(\"btnClick\")\r\n\r\n        super.closeLayer()\r\n    }\r\n\r\n}\r\n\r\n"]}