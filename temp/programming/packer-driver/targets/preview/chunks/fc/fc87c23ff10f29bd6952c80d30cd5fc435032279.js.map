{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/game/compoment/layer/PauseLayer.ts"],"names":["find","_decorator","Channel","tyqAdManager","tyqSDK","tyqSDKConfig","constants","msgac","audioManager","designManager","mapModel","UserData","serverMsg","BaseLayer","ItemLayer","ccclass","property","PauseLayer","weaponItemLayer","skill1ItemLayer","skill2ItemLayer","audioIconOpen","audioIconClose","onLoad","getNodeByPath","addComponent","onEnable","getSwitchValue","paramsKeys","tyq_more_game_level","getInstance","openLevel","getChannel","WECHAT","openLayer","layers","MoreGameLayer","showDelayFullVideo","addEventArr","mapLeave","onDisable","removeEventArr","onDestroy","initUI","refreshWeaponLayer","refreshSkill1Layer","refreshSkill2Layer","refreshAudioLayer","musicVolume","active","setNumItemLayer","node","design","skillNum","itemUI","num","refreshItem","tableName","skill2","skill","weaponNum","weapon","name","info","weaponSystem","weaponArr","skillSystem","skillArr","skill2Arr","iconNode","starLayer","row","getRowById","id","setSpriteFrame","icon","lv","icon2","maxLv","mapLeaveRet","data","closeLayer","layerCb","onClickBtnGoOn","onClickBtnHome","send","BackHomeLayer","onClickBtnAudio","setMusicVolume","setEffectVolume"],"mappings":"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","sourcesContent":["import { find, Node, _decorator } from 'cc';\r\nimport { Channel, tyqAdManager } from '../../../tyqSDK/tyqAdManager';\r\nimport { tyqSDK } from '../../../tyqSDK/tyqSDK';\r\nimport { tyqSDKConfig } from '../../../tyqSDK/tyqSDKConfig';\r\nimport { constants } from '../../data/constants';\r\nimport { msgac } from '../../data/msgac';\r\nimport { audioManager } from '../../manager/audioManager';\r\nimport { designManager } from '../../manager/designManager';\r\nimport { mapModel } from '../../model/mapModel';\r\nimport { UserData } from '../../model/UserData';\r\nimport { serverMsg } from '../../other/serverMsg';\r\nimport { BaseLayer } from '../base/BaseLayer';\r\nimport { ItemLayer } from '../base/ItemLayer';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('PauseLayer')\r\nexport class PauseLayer extends BaseLayer {\r\n\r\n    weaponItemLayer: ItemLayer;\r\n    skill1ItemLayer: ItemLayer;\r\n    skill2ItemLayer: ItemLayer;\r\n\r\n    audioIconOpen: Node;\r\n    audioIconClose: Node;\r\n\r\n    onLoad() {\r\n        super.onLoad();\r\n\r\n        this.weaponItemLayer = this.getNodeByPath(\"ui/weaponLayer/bg/itemLayer\").addComponent(ItemLayer);\r\n        this.skill1ItemLayer = this.getNodeByPath(\"ui/skill1Layer/itemLayer\").addComponent(ItemLayer);\r\n        this.skill2ItemLayer = this.getNodeByPath(\"ui/skill2Layer/itemLayer\").addComponent(ItemLayer);\r\n\r\n        this.audioIconOpen = this.getNodeByPath(\"btnAudio/open\");\r\n        this.audioIconClose = this.getNodeByPath(\"btnAudio/close\");\r\n\r\n    }\r\n\r\n    onEnable() {\r\n        super.onEnable();\r\n        if (tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_more_game_level) > 0 && tyqSDK.getSwitchValue(tyqSDKConfig.paramsKeys.tyq_more_game_level) > UserData.getInstance().openLevel) {\r\n            if (tyqAdManager.getChannel() == Channel.WECHAT) {\r\n                this.openLayer(constants.layers.MoreGameLayer)\r\n            }\r\n        }\r\n        tyqAdManager.showDelayFullVideo()\r\n        this.addEventArr([\r\n            msgac.mapLeave\r\n        ]);\r\n    }\r\n\r\n    onDisable() {\r\n        super.onDisable();\r\n\r\n        this.removeEventArr([\r\n            msgac.mapLeave\r\n        ]);\r\n    }\r\n\r\n    onDestroy() {\r\n        super.onDestroy();\r\n    }\r\n\r\n    initUI() {\r\n        this.refreshWeaponLayer();\r\n        this.refreshSkill1Layer();\r\n        this.refreshSkill2Layer();\r\n\r\n        this.refreshAudioLayer();\r\n    }\r\n\r\n    refreshAudioLayer() {\r\n        if (audioManager.musicVolume > 0) {\r\n            this.audioIconOpen.active = true;\r\n            this.audioIconClose.active = false;\r\n        } else {\r\n            this.audioIconOpen.active = false;\r\n            this.audioIconClose.active = true;\r\n        }\r\n    }\r\n\r\n    refreshSkill2Layer() {\r\n        this.setNumItemLayer(this.skill2ItemLayer.node, constants.design.skillNum, (itemUI: Node, num: number) => {\r\n            this.refreshItem(itemUI, num, constants.tableName.skill2);\r\n        });\r\n    }\r\n\r\n    refreshSkill1Layer() {\r\n        this.setNumItemLayer(this.skill1ItemLayer.node, constants.design.skillNum, (itemUI: Node, num: number) => {\r\n            this.refreshItem(itemUI, num, constants.tableName.skill);\r\n        });\r\n    }\r\n\r\n    refreshWeaponLayer() {\r\n        this.setNumItemLayer(this.weaponItemLayer.node, constants.design.weaponNum, (itemUI: Node, num: number) => {\r\n            this.refreshItem(itemUI, num, constants.tableName.weapon);\r\n        });\r\n    }\r\n\r\n    refreshItem(itemUI: Node, num: number, name: string) {\r\n        let info = null;\r\n        switch (name) {\r\n            case constants.tableName.weapon:\r\n                info = mapModel.weaponSystem.weaponArr[num - 1];\r\n                break;\r\n            case constants.tableName.skill:\r\n                info = mapModel.skillSystem.skillArr[num - 1];\r\n                break;\r\n            case constants.tableName.skill2:\r\n                info = mapModel.skillSystem.skill2Arr[num - 1];\r\n                break;\r\n            default:\r\n                break;\r\n        }\r\n        let iconNode = find(\"icon\", itemUI);\r\n        let starLayer = find(\"starLayer\", itemUI);\r\n        if (!info) {\r\n            iconNode.active = false;\r\n            starLayer.active = false;\r\n            return;\r\n        }\r\n\r\n        iconNode.active = true;\r\n        starLayer.active = true;\r\n        let row = designManager.getRowById(name, info.id);\r\n        this.setSpriteFrame(iconNode, row.icon);\r\n        this.setNumItemLayer(starLayer, row.lv, (node: Node) => {\r\n            let icon = find(\"icon\", node);\r\n            let icon2 = find(\"icon2\", node);\r\n            if (row.lv >= constants.design.maxLv) {\r\n                icon.active = false;\r\n                icon2.active = true;\r\n            } else {\r\n                icon.active = true;\r\n                icon2.active = false;\r\n            }\r\n        });\r\n    }\r\n\r\n    mapLeaveRet(data: any) {\r\n        this.closeLayer();\r\n    }\r\n\r\n    closeLayer() {\r\n        super.closeLayer();\r\n        if (this.layerCb) {\r\n            this.layerCb();\r\n        }\r\n    }\r\n\r\n    onClickBtnGoOn(node: Node) {\r\n        this.closeLayer();\r\n    }\r\n\r\n    onClickBtnHome() {\r\n        serverMsg.send(msgac.mapLeave);\r\n        return;\r\n        this.openLayer(constants.layers.BackHomeLayer);\r\n    }\r\n\r\n    onClickBtnAudio() {\r\n        if (audioManager.musicVolume > 0) {\r\n            audioManager.setMusicVolume(0);\r\n            audioManager.setEffectVolume(0);\r\n        } else {\r\n            audioManager.setMusicVolume(1);\r\n            audioManager.setEffectVolume(1);\r\n        }\r\n        this.refreshAudioLayer();\r\n    }\r\n\r\n}\r\n\r\n"]}