{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/tyqSDK/network/gameStorage.ts"],"names":["_decorator","Component","GNetConst","GameMemoryStorage","ccclass","property","GameStorage","Key","key","GameKey","GetRawKey","replace","getStorage","getInt","def","n","getItem","Number","setInt","num","setItem","setIntMemory","getBoolean","setBoolean","is","v","setBooleanMemory","getString","getStringDisk","localStorage","getIntDisk","setStringDisk","val","setStringMemory","setString","getObject","json","JSON","parse","error","setObject","obj","stringify","sendObject","setObjectMemory","removeItem","clear","list","i","length","indexOf","push","keys","clearByKey","gameKey","getStringArrayByKey","str","list2","values","getObjectArrayByKey","value","getAll","isFirst","jsonData","oldKey","newKey","spliceDatas","Object","prototype","hasOwnProperty","call","datas","xtbl","data","id","star","debris","equip","index","level","partner","score","skill_skr","skill_skr_attr","skill_star","skill_star_attr","setAll","SaveHead"],"mappings":"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","sourcesContent":["\r\nimport { _decorator, Component, Node , sys} from 'cc';\r\nimport { GNetConst } from './conf';\r\nimport GameMemoryStorage from './GameMemoryStorage';\r\nconst { ccclass, property } = _decorator;\r\n\r\n@ccclass('GameStorage')\r\nexport class GameStorage extends Component {\r\n\r\n    static GameKey = GNetConst.SaveHead;\r\n\r\n    public static Key(key:string){\r\n        return this.GameKey + '_' + key;\r\n    }\r\n\r\n    public static GetRawKey(key:string){\r\n        return key.replace(GameStorage.GameKey+\"_\",\"\")\r\n    }\r\n\r\n    static getStorage(){\r\n        return GameMemoryStorage\r\n        // return Const.isActiveMemoryTmp?GameMemoryStorageTmp: GameMemoryStorage\r\n    }\r\n\r\n    static getInt(key:string, def:number = 0){\r\n        let n = this.getStorage().getItem(this.Key(key));\r\n        if (n !== null && n !== \"\") {\r\n            return Number(n);\r\n        }\r\n        return def;\r\n    }\r\n\r\n    static setInt(key:string, num:number){\r\n        key = this.Key(key);\r\n        this.getStorage().setItem(key, num+\"\");\r\n    }\r\n    static setIntMemory(key:string,num:number){\r\n        key = this.Key(key);\r\n        this.getStorage().setItem(key, num+\"\");\r\n    }\r\n\r\n    static getBoolean(key:string, def:boolean = false){\r\n        let n = this.getStorage().getItem(this.Key(key));\r\n        if (n !== null&&n !== \"\") {\r\n            return Number(n) == 1?true:false;\r\n        }\r\n        return def;\r\n    }\r\n\r\n    static setBoolean(key:string,is:boolean){\r\n        key = this.Key(key);\r\n        let v = is?1:0;\r\n        this.getStorage().setItem(key,v+\"\");\r\n    }\r\n    static setBooleanMemory(key:string,is:boolean){\r\n        key = this.Key(key);\r\n        let v = is?1:0;\r\n        this.getStorage().setItem(key,v+\"\");\r\n    }\r\n\r\n    static getString(key:string,def:string = ''){\r\n        let n = this.getStorage().getItem(this.Key(key));\r\n        if (n !== null&& n !== \"\") {\r\n            return n;\r\n        }\r\n        return def;\r\n    }\r\n    //登录部分信息才用\r\n    static getStringDisk(key:string,def:string = ''){\r\n        let n = localStorage.getItem(this.Key(key));\r\n        if (n !== null&& n !== \"\") {\r\n            return n;\r\n        }\r\n        return def;\r\n    }\r\n    static getIntDisk(key:string,def:string = ''){\r\n        let n = localStorage.getItem(this.Key(key));\r\n        if (n !== null&& n !== \"\") {\r\n            return Number(n);\r\n        }\r\n        return def;\r\n    }\r\n    static setStringDisk(key:string,val:string){\r\n        localStorage.setItem(this.Key(key), val);\r\n    }\r\n\r\n    static setStringMemory(key:string,val:string){\r\n        key = this.Key(key);\r\n        this.getStorage().setItem(key,val);\r\n        localStorage.setItem(key, val);\r\n    }\r\n\r\n    static setString(key:string,num:string){\r\n        key = this.Key(key);\r\n        this.getStorage().setItem(key,num);\r\n        if (key == GameStorage.GameKey+'login_account') {\r\n            return;\r\n        }\r\n    }\r\n\r\n\r\n    static getObject(key:string,def:any = null){\r\n        let n = this.getStorage().getItem(this.Key(key));\r\n        if (n !== null&& n !== \"\") {\r\n            try {\r\n                let json = JSON.parse(n);\r\n                return json || def;\r\n            } catch (error) {\r\n                return def;\r\n            }\r\n            \r\n        }\r\n        return def;\r\n    }\r\n\r\n    static setObject(key:string,obj:any){\r\n        key = this.Key(key);\r\n        let v = JSON.stringify(obj);\r\n        this.getStorage().setItem(key,v);\r\n    }\r\n    static sendObject(key:string, obj:any){\r\n        key = this.Key(key);\r\n        let v = JSON.stringify(obj);\r\n    }\r\n\r\n    static setObjectMemory(key:string,obj:any){\r\n        key = this.Key(key);\r\n        let v = JSON.stringify(obj);\r\n        this.getStorage().setItem(key,v);\r\n    }\r\n\r\n    static removeItem(key:string){\r\n        key = this.Key(key);\r\n        this.getStorage().removeItem(key);\r\n    }\r\n\r\n    static clear(){\r\n        // console.log('清除数据:',localStorage.length)\r\n\r\n        let list:string[] = [];\r\n\r\n        for (let i = 0; i <  localStorage.length; i++) {\r\n            let key:string =  localStorage.key(i)!; //获取本地存储的Key\r\n            if (key.indexOf(this.GameKey) >=0 && key.indexOf('login') == -1 && key.indexOf('zzdl') == -1) {\r\n                // cc.log(\"清理前检查key\", key, key.indexOf(this.GameKey) )\r\n                list.push(key);\r\n            }\r\n        }\r\n\r\n        let keys = this.getStorage().keys();\r\n        for (let i = 0; i <  keys.length; i++) {\r\n            let key:string =  keys[i]; //获取本地存储的Key\r\n            if (key.indexOf('login') == -1 && key.indexOf('zzdl') == -1) {\r\n                // console.log(\"清除key:\",key)\r\n                list.push(key);\r\n            }\r\n        }\r\n\r\n        for (let i = 0; i < list.length; i++) {\r\n            const key = list[i];\r\n            this.getStorage().removeItem(key);\r\n            // this.removeItem(key);\r\n        }\r\n        //清空本地无用的缓存\r\n\r\n        // localStorage.clear();\r\n    }\r\n\r\n    //老用户不用改为内存\r\n    static clearByKey(gameKey:string){\r\n        let list:string[] = [];\r\n        for (let i = 0; i <  localStorage.length; i++) {\r\n            let key:string =  localStorage.key(i)!; //获取本地存储的Key\r\n            if (key.indexOf(gameKey) != -1) {\r\n                list.push(key);\r\n            }\r\n        }\r\n        for (let i = 0; i < list.length; i++) {\r\n            const key = list[i];\r\n            this.getStorage().removeItem(key);\r\n        }\r\n    }\r\n\r\n    static getStringArrayByKey(str:string){\r\n        // console.log(\"获取列表:\",str)\r\n        let list:any[] = [];\r\n        let list2:any[] = [];\r\n        let keys = this.getStorage().keys();\r\n        for (let i = 0; i <  keys.length; i++) {\r\n            const key:string =  keys[i]; //获取本地存储的Key\r\n            //console.log(\"key:\",key);\r\n            if (key.indexOf(str) != -1) {\r\n                let n = this.getStorage().getItem(key);\r\n                // console.log(\"=====n:\",n)\r\n                list.push(n);\r\n                list2.push(key)\r\n            }\r\n        }\r\n        return {keys: list2, values: list};\r\n    }\r\n\r\n    static getObjectArrayByKey(str:string){\r\n       // console.log(\"获取列表:\",str)\r\n        let list:any[] = [];\r\n        let keys = this.getStorage().keys();\r\n        for (let i = 0; i <  keys.length; i++) {\r\n            const key:string =  keys[i]; //获取本地存储的Key\r\n            //console.log(\"key:\",key);\r\n            if (key.indexOf(str) != -1) {\r\n                let n = this.getStorage().getItem(key);\r\n                //console.log(\"n:\",n)\r\n                let value = null;\r\n                if (n !== null&& n !== \"\") {\r\n                    try {\r\n                        let json = JSON.parse(n);\r\n                        value = json || null;\r\n                    } catch (error) {\r\n                        value = null;\r\n                    }\r\n                }\r\n                if (value) {\r\n                    list.push(value);\r\n                }\r\n                \r\n            }\r\n            \r\n        }\r\n        return list;\r\n    }\r\n\r\n    //老用户兼容使用，不改动，以及GM也使用这个接口上传数据到云端\r\n    static getAll(isFirst:boolean = false){\r\n        let jsonData:any = {}\r\n        for (let i = 0; i <  localStorage.length; i++) {\r\n            const key:string =  localStorage.key(i)!; //获取本地存储的Key\r\n            if (key.indexOf('login') != -1) {\r\n                continue;\r\n            }\r\n            if (isFirst) {\r\n                let oldKey = key;\r\n                let newKey = key.replace('zzdl',GameStorage.GameKey);\r\n                jsonData[newKey] = localStorage.getItem(oldKey)\r\n            }\r\n            else{\r\n                if (key.indexOf('zzdl') != -1) {\r\n                    continue;\r\n                }\r\n                jsonData[key]=localStorage.getItem(key)\r\n            }\r\n            \r\n            // console.log(key);\r\n            // console.log(localStorage.getItem(key));//所有value\r\n            // console.log(\"---------------------------------\");\r\n        }\r\n\r\n        if (isFirst) {\r\n            let spliceDatas:any = {};\r\n            for (const key in jsonData) {\r\n                if (Object.prototype.hasOwnProperty.call(jsonData, key)) {\r\n                    const value = jsonData[key];\r\n                    // 大数据拆分.\r\n                    // 1.装备\r\n                    // 2.玄天宝录\r\n                    // console.log(\"老用户数据处理key:\",key,value);\r\n                    switch (key) {\r\n                        case GameStorage.GameKey+'_sect_xtbls':\r\n                            {\r\n                                let datas = JSON.parse(value);\r\n                                // console.log(\"xtbl datas:\",datas.length,datas);\r\n                                for (let i = 0; i < datas.length; i++) {\r\n                                    const xtbl = datas[i];\r\n                                    let data = {\r\n                                        id:xtbl.id,\r\n                                        star:xtbl.star,\r\n                                        debris:xtbl.debris\r\n                                    }\r\n                                    // GameStorage.setObject('SectXtbl_'+xtbl.id,data);\r\n                                    spliceDatas[GameStorage.GameKey + '_SectXtbl_'+xtbl.id] = JSON.stringify(data);\r\n                                }\r\n                            }\r\n                            break;\r\n                        case GameStorage.GameKey+'_pack_equips':\r\n                            {\r\n                                let datas = JSON.parse(value);\r\n                                // console.log(\"equip datas:\",datas.length,datas);\r\n                                for (let i = 0; i < datas.length; i++) {\r\n                                    const equip = datas[i];\r\n                                    let data = {\r\n                                        id:equip.id,\r\n                                        index:equip.index,\r\n                                        level:equip.level,\r\n                                        star:equip.star,\r\n                                        partner:equip.partner,\r\n                                        score:equip.score,\r\n                                        skill_skr:equip.skill_skr,\r\n                                        skill_skr_attr:equip.skill_skr_attr,\r\n                                        skill_star:equip.skill_star,\r\n                                        skill_star_attr:equip.skill_star_attr,\r\n                                    };\r\n                                    // GameStorage.setObject('pack_equip_'+equip.index,data);\r\n                                    spliceDatas[GameStorage.GameKey + 'pack_equip_' + equip.index] = JSON.stringify(data);\r\n                                }\r\n                            }\r\n                            break;    \r\n                        default:\r\n                            {\r\n                                localStorage.setItem(key,value);\r\n                            }\r\n                            break;\r\n                    }\r\n                    \r\n                }\r\n            }\r\n            delete jsonData['zzdl_sect_xtbls'];\r\n            delete jsonData['zzdl_pack_equips'];\r\n\r\n            // console.log(\"spliceDatas:\",spliceDatas);\r\n\r\n            for (const key in spliceDatas) {\r\n                const data = spliceDatas[key];\r\n                jsonData[key] = data;\r\n            }\r\n        }\r\n\r\n        return jsonData\r\n    }\r\n\r\n    static async setAll(jsonData:any){\r\n        // console.log(\"11111覆盖数据\")\r\n        // await this.clear();\r\n        // console.log(\"覆盖前清除所有数据........\",jsonData)\r\n        \r\n        for(let key in jsonData){\r\n            this.getStorage().setItem(key, jsonData[key])\r\n        }\r\n    }\r\n\r\n}\r\n\r\n"]}