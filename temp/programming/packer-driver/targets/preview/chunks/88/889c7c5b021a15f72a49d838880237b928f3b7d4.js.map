{"version":3,"sources":["file:///G:/cocos/%E6%9C%AB%E6%97%A5%E7%89%B9%E5%B7%A5%E9%98%9F/assets/scripts/utils/utilTools.ts"],"names":["String","prototype","format","str","i","arguments","replace","utilTools","getRandomSign","Math","random","radianToAngle","radian","PI","angleToRadian","angle","forArr","arr","cb","len","length","info","undefined","ret","waterfall","taskArr","callback","Array","isArray","taskIndex","result","loadNextTask","task","err","valToPercent","val","fixNum","floor","toFixed","getTimeStr","d","isM","hours","mins","seconds","getTimeStrChinese","isSce","isHour","timeStrToDate","obj","item","keyArr","Object","keys","key","endStr","substring","toLocaleLowerCase","Date","e","console","log","message","sortArr","compareFunc","j","item1","item2","isProb","randomArr","isOrign","JSON","parse","stringify","tmpArr","index","push","splice","getFloatValue","min","max","isInt","dv","overDay","date","now","getDate","getTime","getRowsByWeightAndNum","num","canRepeat","copyObj","row","getRowByWeight","indexOf","totalWeight","weight","left","tmpRow","getRandomItemByArr","isRemove"],"mappings":"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","sourcesContent":["\r\n/**\r\n * 拓展String.format方法\r\n * 需要在cc.d.ts中添加以下声明代码，使用过程中才会有提示，并且不会报错\r\ndeclare interface String {\r\n    format(...agrs: any[]): string;\r\n    parseColor();\r\n}\r\n */\r\nString.prototype.format = function () {\r\n    let str = this;\r\n    for (let i in arguments) {\r\n        str = str.replace(/\\%\\w/, arguments[i]);\r\n    }\r\n    return str;\r\n}\r\n// // 错误提示去不掉，暂时不用了\r\n// Object.defineProperty(Array.prototype, \"sortArr\", {\r\n//     value: function (compareFunc: Function) {\r\n//         let arr = this;\r\n//         if (arr.length <= 1) {\r\n//             return;\r\n//         }\r\n//         for (let i = 0; i < arr.length - 1; i++) {\r\n//             for (let j = i + 1; j < arr.length; j++) {\r\n//                 let item1 = arr[i];\r\n//                 let item2 = arr[j];\r\n//                 if (compareFunc(item1, item2)) {\r\n//                     arr[i] = item2;\r\n//                     arr[j] = item1;\r\n//                 }\r\n//             }\r\n//         }\r\n//     }\r\n// });\r\n\r\nexport const utilTools = {\r\n\r\n    getRandomSign() {\r\n        return Math.random() > 0.5 ? 1 : -1;\r\n    },\r\n\r\n    // 角度值与弧度制之间的转换\r\n    radianToAngle(radian: number) {\r\n        return radian / Math.PI * 180;\r\n    },\r\n    angleToRadian(angle: number) {\r\n        return angle / 180 * Math.PI;\r\n    },\r\n\r\n    // 性能最好的数组遍历方式\r\n    forArr(arr: any, cb: Function) {\r\n        let len = arr.length;\r\n        if (len <= 0) {\r\n            return;\r\n        }\r\n        for (let i = 0; i < len; i++) {\r\n            let info = arr[i];\r\n            if (info == undefined) {\r\n                continue;\r\n            }\r\n            let ret = cb(info, i);\r\n            if (ret) {\r\n                break;\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 模仿async.waterfall写得，按顺序执行各个方法\r\n     * @param taskArr 要顺序执行的方法数组\r\n     * @param callback 执行结果回调\r\n     */\r\n    waterfall(taskArr: any, callback?: any) {\r\n        if (!callback) {\r\n            callback = function () { };\r\n        }\r\n        if (!Array.isArray(taskArr) || taskArr.length <= 0) {\r\n            callback(\"taskArr is null\");\r\n            return;\r\n        }\r\n        let taskIndex = 0;\r\n        let result = {};\r\n        let loadNextTask = function () {\r\n            let task = taskArr[taskIndex];\r\n            if (task) {\r\n                task(result, function (err) {\r\n                    if (err) {\r\n                        callback(err, null);\r\n                        return;\r\n                    }\r\n                    taskIndex++;\r\n                    loadNextTask();\r\n                });\r\n                return;\r\n            }\r\n            callback(null, result);\r\n        };\r\n        loadNextTask();\r\n    },\r\n\r\n    // 数字转化为百分比显示\r\n    valToPercent(val: number, fixNum?: number) {\r\n        // 保证舍去不显示的那部分\r\n        val = Math.floor(val * 10000);\r\n        val = val / 10000;\r\n\r\n        if (fixNum == undefined) {\r\n            fixNum = 2;\r\n        }\r\n        let ret = (val * 100).toFixed(fixNum) + \"%\";\r\n\r\n        return ret;\r\n    },\r\n\r\n    /**\r\n     * 获取如下格式的时间\r\n     * 05:00:56\r\n     * @param d 单位：豪秒\r\n     * @param isM 是否强制只显示到分\r\n     * @returns {string}\r\n     */\r\n    getTimeStr(d: number, isM?: boolean) {\r\n        var ret = \"\";\r\n        if (d < 0) {\r\n            d = 0;\r\n        }\r\n\r\n        d = d / 1000;\r\n        var hours = Math.floor(d / 3600);\r\n        var mins = Math.floor((d - hours * 3600) / 60);\r\n        var seconds = Math.floor(d - hours * 3600 - mins * 60);\r\n\r\n        if (isM) {\r\n            mins = mins + hours * 60;\r\n        } else {\r\n            if (hours >= 10) {\r\n                ret = ret + hours + \":\";\r\n            } else {\r\n                ret = ret + \"0\" + hours + \":\";\r\n            }\r\n        }\r\n\r\n        if (mins >= 10) {\r\n            ret = ret + mins + \":\";\r\n        } else {\r\n            ret = ret + \"0\" + mins + \":\";\r\n        }\r\n        if (seconds >= 10) {\r\n            ret = ret + seconds;\r\n        } else {\r\n            ret = ret + \"0\" + seconds;\r\n        }\r\n\r\n        return ret;\r\n    },\r\n\r\n    /**\r\n       * 获取如下格式的时间\r\n       * 05:00:56\r\n       * @param d 单位：豪秒\r\n       * @param isM 是否强制只显示到分\r\n       * @returns {string}\r\n       */\r\n    getTimeStrChinese(d: number, isSce = true, isM = true, isHour = true) {\r\n        var ret = \"\";\r\n        if (d < 0) {\r\n            d = 0;\r\n        }\r\n\r\n        d = d / 1000;\r\n        var hours = Math.floor(d / 3600);\r\n        var mins = Math.floor((d - hours * 3600) / 60);\r\n        var seconds = Math.floor(d - hours * 3600 - mins * 60);\r\n\r\n\r\n        if (hours > 0) {\r\n            ret = ret + hours + \"时\";\r\n        }\r\n\r\n        if (mins >= 10) {\r\n            ret = ret + mins + \"分\";\r\n        } else {\r\n            ret = ret + \"0\" + mins + \"分\";\r\n        }\r\n        if (isSce) {\r\n            if (seconds >= 10) {\r\n                ret = ret + seconds + \"秒\";\r\n            } else {\r\n                ret = ret + \"0\" + seconds + \"秒\";\r\n            }\r\n        }\r\n\r\n        return ret;\r\n    },\r\n\r\n    /**\r\n     * 将对象obj中以time(不区分大小写)为结尾的key字符串值，转换为js时间对象Date\r\n     * @param obj\r\n     */\r\n    timeStrToDate(obj: any) {\r\n        if (typeof (obj) != \"object\" || obj == null) {\r\n            return obj;\r\n        }\r\n\r\n        if (Array.isArray(obj)) {\r\n            for (let i in obj) {\r\n                let item = obj[i];\r\n                if (item && typeof (item) == \"object\") {\r\n                    utilTools.timeStrToDate(item);\r\n                }\r\n            }\r\n        } else {\r\n            let keyArr = Object.keys(obj);\r\n            for (let i in keyArr) {\r\n                let key = keyArr[i] + \"\";\r\n                let val = obj[key];\r\n                if (val && typeof (val) == \"object\") {\r\n                    utilTools.timeStrToDate(val);\r\n                    continue;\r\n                }\r\n\r\n                try {\r\n                    let endStr = \"\";\r\n                    if (key.length >= 4) {\r\n                        endStr = key.substring(key.length - 4, key.length);\r\n                        if (endStr.toLocaleLowerCase() == \"time\" && val && typeof (val) == \"string\") {\r\n                            obj[key] = new Date(val);\r\n                        }\r\n                    }\r\n                } catch (e) {\r\n                    console.log(\"utilTools.timeStrToDate error:\" + e.message, e, obj);\r\n                }\r\n\r\n            }\r\n        }\r\n\r\n        return obj;\r\n    },\r\n\r\n    /**\r\n     * 数组排序\r\n     * @param arr \r\n     * @param compareFunc \r\n     */\r\n    sortArr(arr: any, compareFunc: Function) {\r\n        if (!arr || arr.length <= 1) {\r\n            return arr;\r\n        }\r\n        for (let i = 0; i < arr.length - 1; i++) {\r\n            for (let j = i + 1; j < arr.length; j++) {\r\n                let item1 = arr[i];\r\n                let item2 = arr[j];\r\n                if (compareFunc(item1, item2)) {\r\n                    arr[i] = item2;\r\n                    arr[j] = item1;\r\n                }\r\n            }\r\n        }\r\n    },\r\n\r\n    /**\r\n     * 概率是否满足\r\n     * @param val 概率值 0到1\r\n     */\r\n    isProb(val: number) {\r\n        if (!val) {\r\n            val = 0;\r\n        }\r\n        if (Math.random() < val) {\r\n            return true;\r\n        }\r\n        return false;\r\n    },\r\n\r\n    /**\r\n     * 打乱数组元素，默认不改变原有的数组，返回新的打乱后的数组\r\n     * @param arr \r\n     * @param isOrign true:原数组会被修改\r\n     */\r\n    randomArr(arr: any, isOrign: boolean = false): any {\r\n        if (!isOrign) {\r\n            arr = JSON.parse(JSON.stringify(arr));\r\n        }\r\n        let tmpArr = [];\r\n        while (arr.length > 0) {\r\n            let index = Math.floor(Math.random() * arr.length);\r\n            tmpArr.push(arr[index]);\r\n            arr.splice(index, 1);\r\n        }\r\n        return tmpArr;\r\n    },\r\n\r\n    /**\r\n     * 返回给定范围内的随机数值,整数包括左右边界\r\n     * @param min 最小值\r\n     * @param max 最大值\r\n     * @param isInt 是否整数化\r\n     * @returns {number}\r\n     */\r\n    getFloatValue(min: number, max: number, isInt?: boolean) {\r\n        let dv = max - min;\r\n        if (dv == 0) {\r\n            return min;\r\n        }\r\n        if (dv < 0) {\r\n            return 0;\r\n        }\r\n        if (isInt) {\r\n            let val = min + Math.floor(Math.random() * (dv + 1));\r\n            return val;\r\n        }\r\n\r\n        let val = min + Math.random() * dv;\r\n        return val;\r\n    },\r\n\r\n    // 跨天判断\r\n    overDay(date: any, now?: any) {\r\n        if (!date) {\r\n            return true;\r\n        }\r\n\r\n        if (!now) {\r\n            now = new Date();\r\n        }\r\n        let overDay = false;\r\n        if (date.getDate() == now.getDate()) {\r\n            if (now.getTime() - date.getTime() >= 24 * 60 * 60 * 1000) {\r\n                overDay = true;\r\n            }\r\n        } else {\r\n            overDay = true;\r\n        }\r\n\r\n        return overDay;\r\n    },\r\n\r\n    /**\r\n     * 根据权重从数组中返回指定的个数元素\r\n     * @param arr 数组\r\n     * @param num 返回个数\r\n     * @param canRepeat 是否可以重复取，默认不可以\r\n     * @returns {Array} 返回结果数组\r\n     */\r\n    getRowsByWeightAndNum(arr: any, num: number, canRepeat?: boolean) {\r\n        if (!num) {\r\n            num = 1;\r\n        }\r\n        var ret = [];\r\n        arr = utilTools.copyObj(arr);\r\n        for (var i = 0; i < num; i++) {\r\n            if (arr.length <= 0) {\r\n                break;\r\n            }\r\n            var row = this.getRowByWeight(arr);\r\n            ret.push(row);\r\n            if (!canRepeat) {\r\n                var index = arr.indexOf(row);\r\n                arr.splice(index, 1);\r\n            }\r\n        }\r\n        return ret;\r\n    },\r\n\r\n    /**\r\n     * 根据权重从数组中返回一个元素\r\n     * @param arr\r\n     * @param totalWeight\r\n     */\r\n    getRowByWeight(arr: any, totalWeight?: number) {\r\n        if (!totalWeight) {\r\n            totalWeight = 0;\r\n            for (var i in arr) {\r\n                var weight = arr[i].weight;\r\n                if (!weight) {\r\n                    weight = 0;\r\n                }\r\n                totalWeight += weight;\r\n            }\r\n        }\r\n        var random = Math.random() * totalWeight;\r\n        var left = 0;\r\n        var row = null;\r\n        for (var i in arr) {\r\n            var tmpRow = arr[i];\r\n            var weight = tmpRow.weight;\r\n            if (!weight) {\r\n                weight = 0;\r\n            }\r\n            if (random >= left && random < left + weight) {\r\n                row = tmpRow;\r\n                break;\r\n            }\r\n            left += weight;\r\n        }\r\n\r\n        return row;\r\n    },\r\n\r\n    /**\r\n     * 从给定的数组中，随机取出一个元素\r\n     * @param arr 数组\r\n     * @param isRemove 是否将该元素从数组中移除\r\n     * @return {null|*} 返回随机到的元素\r\n     */\r\n    getRandomItemByArr(arr: any, isRemove: boolean = false) {\r\n        if (!arr || arr.length <= 0) {\r\n            return null;\r\n        }\r\n        let index = Math.floor(Math.random() * arr.length);\r\n        let item = arr[index];\r\n        if (isRemove) {\r\n            arr.splice(index, 1);\r\n        }\r\n\r\n        return item;\r\n    },\r\n\r\n    /**\r\n     * 深度拷贝对象\r\n     * @param obj 要拷贝的对象内容\r\n     */\r\n    copyObj(obj: object) {\r\n        return JSON.parse(JSON.stringify(obj));\r\n    },\r\n\r\n}\r\n\r\n"]}